var IS_IE=false;var IS_FF=false;var IS_OPERA=false;var IS_CHROME=false;var IS_SAFARI=false;var IS_WEBKIT=false;var IS_IE6=false;var IS_IE7=false;var IS_IE8=false;var IS_IE9=false;var IS_IE10=false;var IS_IOS=false;var IS_IPHONE=false;var IS_IPAD=false;var IS_IE8_CORE=false;var IS_IE9_CORE=false;var IS_IE10_ABOVE=false;var IS_STANDARD=false;var BROWSER_VERSION=0;var ua=navigator.userAgent.toLowerCase(),s,o={};if (s=ua.match(/opera.([\d.]+)/)){IS_OPERA=true;}else if (s=ua.match(/chrome\/([\d.]+)/)){IS_CHROME=true;IS_STANDARD=true;}else if (s=ua.match(/version\/([\d.]+).*safari/)){IS_SAFARI=true;IS_STANDARD=true;}else if (s=ua.match(/gecko/)){IS_FF=true;IS_STANDARD=true;}else if (s=ua.match(/msie ([\d.]+)/)){IS_IE=true;}else if (s=ua.match(/firefox\/([\d.]+)/)){IS_FF=true;IS_STANDARD=true;}if (ua.match(/webkit\/([\d.]+)/)){IS_WEBKIT=true;}if (ua.match(/ipad/i)){IS_IOS=true;IS_IPAD=true;IS_STANDARD=true;}if (ua.match(/iphone/i)){IS_IOS=true;IS_IPHONE=true;}if (s&&s[1]){BROWSER_VERSION=parseFloat( s[1] );}else{BROWSER_VERSION=0;}if (IS_IE){var intVersion=parseInt(BROWSER_VERSION);var mode=document.documentMode;if(mode==null){if (intVersion==6){IS_IE6=true;}else if (intVersion==7){IS_IE7=true;}}else{if(mode==7){IS_IE7=true;}else if (mode==8){IS_IE8=true;}else if (mode==9){IS_IE9=true;IS_STANDARD=true;}else if (mode==10){IS_IE10=true;IS_STANDARD=true;IS_IE10_ABOVE=true;}else{IS_STANDARD=true;}if (intVersion==8){IS_IE8_CORE=true;}else if (intVersion==9){IS_IE9_CORE=true;}else{}}}var ATTRFLOAT=IS_IE ? "styleFloat":"cssFloat";
var Logger=new Object;Logger.getConsole=function(){if (IS_FF){if (window.console){return window.console;}else{return null;}}else{return null;}};Logger.log=function(param1,param2){if (Logger.getConsole()){if (param1&&param2) Logger.getConsole().log(param1,param2);else if (param1) Logger.getConsole().log(param1);}};Logger.info=function(param1,param2){if (Logger.getConsole()){if (param1&&param2) Logger.getConsole().info(param1,param2);else if (param1) Logger.getConsole().info(param1);}};Logger.warn=function(param1,param2){if (Logger.getConsole()){if (param1&&param2) Logger.getConsole().warn(param1,param2);else if (param1) Logger.getConsole().warn(param1);}};Logger.debug=function(param1,param2){if (Logger.getConsole()){if (param1&&param2) Logger.getConsole().debug(param1,param2);else if (param1) Logger.getConsole().debug(param1);}};Logger.error=function(param1,param2){if (Logger.getConsole()){if (param1&&param2) Logger.getConsole().error(param1,param2);else if (param1) Logger.getConsole().error(param1);}};log=function(param1,param2){Logger.log(param1,param2);};info=function(param1,param2){Logger.info(param1,param2);};warn=function(param1,param2){Logger.warn(param1,param2);};debug=function(param1,param2){Logger.debug(param1,param2);};error=function(param1,param2){Logger.error(param1,param2);};
 var EventUtil=new Object;EventUtil.currentEvent=null;EventUtil.addEventHandler=function(oTarget,sEventType,fnHandler){if (oTarget.addEventListener){oTarget.addEventListener(sEventType,fnHandler,true);}else if (oTarget.attachEvent){oTarget.attachEvent("on"+sEventType,fnHandler);}else{oTarget["on"+sEventType]=fnHandler;}};EventUtil.removeEventHandler=function(oTarget,sEventType,fnHandler){if (oTarget.removeEventListener){oTarget.removeEventListener(sEventType,fnHandler,true);}else if (oTarget.detachEvent){oTarget.detachEvent("on"+sEventType,fnHandler);}else{oTarget["on"+sEventType]=null;}};EventUtil.formatEvent=function(oEvent){if (IS_IE){oEvent.eventPhase=2;oEvent.isChar=(oEvent.charCode>0);oEvent.pageX=oEvent.clientX+document.body.scrollLeft;oEvent.pageY=oEvent.clientY+document.body.scrollTop;if (oEvent.type=="mouseout"){oEvent.relatedTarget=oEvent.toElement;}else if (oEvent.type=="mouseover"){oEvent.relatedTarget=oEvent.fromElement;}oEvent.preventDefault=function(){this.returnValue=false;};oEvent.stopPropagation=function(){this.cancelBubble=true;};oEvent.target=oEvent.srcElement;oEvent.time=(new Date()).getTime();}return oEvent;};EventUtil.getEvent=function(){var currentEvent;if (window.event){currentEvent=this.formatEvent(window.event);}else{for (var i=0;i<EventUtil.getEvent.caller.arguments.length;i++){if (typeof(EventUtil.getEvent.caller.arguments[i].type) !="unknown"&&EventUtil.getEvent.caller.arguments[i].type !=null){currentEvent=EventUtil.getEvent.caller.arguments[i];break;}}}if(currentEvent !=null&&currentEvent.type.startWith("key")){currentEvent.key=currentEvent.keyCode ? currentEvent.keyCode:currentEvent.charCode ? currentEvent.charCode:currentEvent.which ? currentEvent.which:void 0;currentEvent.lfwKey=currentEvent.keyCode ? currentEvent.keyCode:currentEvent.charCode ? currentEvent.charCode:currentEvent.which ? currentEvent.which:void 0;}EventUtil.currentEvent=currentEvent;return currentEvent;};function stopEvent(e){if(typeof(e) !="undefined"){if (e.stopPropagation) e.stopPropagation();else{e.cancelBubble=true;}}};function stopDefault(e){if(typeof(e) !="undefined"){if (e.preventDefault) e.preventDefault();else{e.returnValue=false;}}};function stopAll(e){stopEvent(e);stopDefault(e);};function getTarget(e){return e.target || e.srcElement;};
function ListenerUtil(){if (arguments.length==0) return;this.eventMap=new HashMap;};ListenerUtil.prototype.addListener=function(oListener){var eventMap=this.eventMap;if (eventMap.containsKey(oListener.name)){var arrEvent=eventMap.get(oListener.name);arrEvent.push(oListener);eventMap.put(oListener.name,arrEvent);}else{eventMap.put(oListener.name,[oListener]);}};ListenerUtil.prototype.createListener=function(json){var listenerjson=json.listenter;var listener=new Listener(json.name);listener.source_id=listenerjson.source_id;listener.widget_id=listenerjson.widget_id;listener.source_type=listenerjson.source_type;if (listenerjson.parent_source_id) listener.parent_source_id=listenerjson.parent_source_id;var paramsJson=json.params;var params="";if (paramsJson !=null&&paramsJson.length>0) params=paramsJson.join(",");if (json.onServer==true){listener.func=function(params){if (json.extendsParams&&json.extendsParams.dataset_field_id){if ("onBeforeDataChange"==json.name){this.beforeDataChangeAcceptFields=json.extendsParams.dataset_field_id.split(",") ;}else if ("onAfterDataChange"==json.name){this.afterDataChangeAcceptFields=json.extendsParams.dataset_field_id.split(",");}}var async=json.async;if (json.name=="onClosed") async=false;if(window.editMode) return;var proxy=new ServerProxy(listener,json.name,async);if(typeof beforeCallServer !='undefined') beforeCallServer(proxy,json.name,json.name,listenerjson.source_id );this.addProxyParam(json.name,proxy,params);var proxyParams=json.proxyParams;for (var i=0;i<proxyParams.length;i++){var param=proxyParams[i].split("=");proxy.addParam(param[0],param[1]);}proxy.addParam("source_id",listenerjson.source_id);proxy.addParam("m_n",json.methodName);proxy.addParam("source_type",listenerjson.source_type);proxy.addParam("event_name",json.name);if (json.nmc !=true){proxy.setNmc(false);}if (json.name=="onDataLoad"){if(params.userObj !=null) proxy.setReturnArgs(params.userObj);}ServerProxy.wrapProxy(proxy);};}else{var script=" listener.func = function("+params+"){\n";script+=json.script;script+="};\n";eval(script);}if (json.submitRule){var submitRule=new SubmitRule();if (json.submitRule.params){for (var i=0;i<json.submitRule.params.length;i++){var param=json.submitRule.params[i].split("=");submitRule.addParam(param[0],param[1]);}}this.createJsSubmitRule(json.submitRule,submitRule);if (json.submitRule.parentSubmitRule){var parentRule=new SubmitRule();this.createJsSubmitRule(json.submitRule.parentSubmitRule.submitRule,parentRule);submitRule.setParentSubmitRule(parentRule);}listener.submitRule=submitRule;}this.addListener(listener);};ListenerUtil.prototype.addProxyParam=function(eventName){return "";};ListenerUtil.prototype.createJsSubmitRule=function(submitRuleJson,submitRule){if (submitRuleJson){if (submitRuleJson.widgetRules){for (var i=0;i<submitRuleJson.widgetRules.length;i++){this.createJsWidgetRule(submitRuleJson.widgetRules[i],submitRule);}}}};ListenerUtil.prototype.createJsWidgetRule=function (widgetRuleJson,submitRule){var widgetRule=new WidgetRule(widgetRuleJson.id);if (widgetRuleJson.dsRules){for (var i=0;i<widgetRuleJson.dsRules.length;i++){var dsRuleJson=widgetRuleJson.dsRules[i].split("=");var dsRule=new DatasetRule(dsRuleJson[0],dsRuleJson[1]);widgetRule.addDsRule(dsRuleJson[0],dsRule);}}if (widgetRuleJson.treeRules){for (var i=0;i<widgetRuleJson.treeRules.length;i++){var treeRuleJson=widgetRuleJson.treeRules[i].split("=");var treeRule=new TreeRule(treeRuleJson[0],treeRuleJson[1]);widgetRule.addTreeRule(treeRuleJson[0],treeRule);}}var widgetId=widgetRuleJson.id;submitRule.addWidgetRule(widgetId,widgetRule);};ListenerUtil.prototype.removeListener=function(listenerType,oListener){var eventMap=this.eventMap;if (eventMap.containsKey(listenerType)){var arrEvent=eval(eventMap.get(listenerType));arrEvent.removeEle(oListener);eventMap.put(listenerType,arrEvent);}};ListenerUtil.prototype.addListeners=function(arrListeners){for (var i=0,n=arrListeners.length;i<n;i++){this.addListener(arrListeners[i]);}};ListenerUtil.prototype.removeListeners=function(listenerType,arrListeners){for (var i=0,n=arrListeners.length;i<n;i++){this.removeListener(listenerType,arrListeners[i]);}};ListenerUtil.prototype.removeAllListeners=function(listenerType){var eventMap=this.eventMap;if (eventMap.get(listenerType)){eventMap.put(listenerType,[]);}};ListenerUtil.prototype.clearListenerMap=function(){var keys=this.eventMap.keySet();for(var i=0;i<keys.length;i++){var events=this.eventMap.remove(keys[i]);if(events !=null){for(var j=0;j<events.length;j++){var ev=events[j];for(var attr in ev){ev[attr]=null;}ev=null;}}events=null;}};ListenerUtil.prototype.doEventFunc=function(eventName,eventObj){var map=this.eventMap;var executed=false;try{ServerProxy.suspend=true;var arrListener=map.get(eventName);if (arrListener !=null){for (var i=0;i<arrListener.length;i++){var func=arrListener[i].func;if ((func instanceof Function) || (typeof func=='function')){if (this.beforeCallEvent(eventName,eventObj)==true){var result=func.call(this,eventObj);executed=true;if(eventObj !=null&&eventObj.stopEvent) return result;if (result !=null) return result;}}}}}catch(e){}finally{if(executed==true) ServerProxy.cleanProxy();if (eventObj) eventObj.obj=null;}};ListenerUtil.prototype.beforeCallEvent=function(eventName,eventObj){return true;};var Listener=function(name,bIgnoreError){this.name=name;this.ignoreError=getBoolean(bIgnoreError,false);};
﻿var DataType=new Object;DataType.STRING="String";DataType.INTEGER="Integer";DataType.INT="int";DataType.DOUBLE="Double";DataType.dOUBLE="double";DataType.UFDOUBLE="UFDouble";DataType.FLOAT="Float";DataType.fLOAT="float";DataType.BYTE="Byte";DataType.bYTE="byte";DataType.BOOLEAN="Boolean";DataType.bOOLEAN="boolean";DataType.UFBOOLEAN="UFBoolean";DataType.DATE="Date";DataType.BIGDECIMAL="BigDecimal";DataType.LONG="Long";DataType.lONG="long";DataType.CHAR="char";DataType.CHARACTER="Character";DataType.UFDATETIME="UFDateTime";DataType.UFDATE="UFDate";DataType.UFTIME="UFTime";DataType.UFLITERALDATE="UFLiteralDate";DataType.UFDATEBEGIN="UFDate_begin";DataType.UFDATEEND="UFDate_end";DataType.UFNUMBERFORMAT="UFNumberFormat";DataType.Decimal="Decimal";DataType.Entity="Entity";var EditorType=new Object;EditorType.CHECKBOX="CheckBox";EditorType.STRINGTEXT="StringText";EditorType.INTEGERTEXT="IntegerText";EditorType.DECIMALTEXT="DecimalText";EditorType.SELFDEFELE="SelfDef";EditorType.RADIOGROUP="RadioGroup";EditorType.CHECKBOXGROUP="CheckboxGroup";EditorType.REFERENCE="Reference";EditorType.COMBOBOX="ComboBox";EditorType.LANGUAGECOMBOBOX="LanguageComboBox";EditorType.LIST="List";EditorType.PWDTEXT="PwdText";EditorType.DATETEXT="DateText";EditorType.DATETIMETEXT="DateTimeText";EditorType.MONTHTEXT="MonthText";EditorType.YEARTEXT="YearText";EditorType.YEARMONTHTEXT="YearMonthText";EditorType.EMAILTEXT="EmailText";EditorType.PHONETEXT="PhoneText";EditorType.LINKTEXT="LinkText";EditorType.MONEYTEXT="MoneyText";EditorType.PRECENTTEXT="PrecentText";EditorType.TIMETEXT="TimeText";EditorType.SHORTDATETEXT="ShortDateText";EditorType.LITERALDATE="UFLiteralDate";EditorType.TEXTAREA="TextArea";EditorType.RICHEDITOR="RichEditor";EditorType.IMAGECOMP="ImageComp";EditorType.FILECOMP="FileComp";EditorType.SIGNCOMP="SignComp";var NotifyType=new Object;NotifyType.VALUE="value";NotifyType.VISIBLE="visible";NotifyType.ENABLE="enable";NotifyType.READONLY="readOnly";NotifyType.EDITABLE="editable";NotifyType.MAXVALUE="maxValue";NotifyType.MINVALUE="minValue";NotifyType.TEXT="text";NotifyType.TEXTALIGN="textAlign";NotifyType.WIDTH="width";NotifyType.CHANGEIMG="changeImg";NotifyType.CHECKED="checked";NotifyType.COMBODATAID="comboDataId";NotifyType.PRECISION="precision";NotifyType.INDEX="index";NotifyType.SHOWVALUE="showValue";NotifyType.STATE="state";NotifyType.SELECTED="selected";NotifyType.FOCUS="focus";NotifyType.ROWS="rows";NotifyType.COLS="cols";NotifyType.CHANGELINE="changeLine";NotifyType.SELECTONLY="selectOnly";String.prototype.trim=function(){return this.replace(/^\s*(\b.*\b|)\s*$/,"$1");};String.prototype.replaceStr=function(strFind,strRemp){var tab=this.split(strFind);return new String(tab.join(strRemp));};String.prototype.lengthb=function(){var str=this.replace(/[^\x00-\xff]/g,"**");return str.length;};String.prototype.replaceAll=function(AFindText,ARepText){raRegExp=new RegExp(AFindText,"g");return this.replace(raRegExp,ARepText);};String.prototype.substrCH=function(nLen){var i=0;var j=0;while (i<nLen&&j<this.length){var charCode=this.charCodeAt(j);if (charCode>256&&i==nLen-1){break;}else if (charCode>256){i=i+2;}else{i=i+1;}j=j+1;};return this.substr(0,j);};String.prototype.startWith=function(strChild){return this.indexOf(strChild)==0;};String.prototype.endWith=function(strChild){var index=this.indexOf(strChild);if (index==-1) return;else return index==this.length-strChild.length;};Date.prototype.getAAAAMMJJ=function(){var jour=this.getDate();if (jour<10) (jour="0"+jour);var mois=this.getMonth()+1;if (mois<10) (mois="0"+mois);var annee=this.getYear();return annee+""+mois+""+jour;};Date.prototype.getFomatDate=function(){var year=this.getFullYear();var month=this.getMonth()+1;if (month<10) month="0"+month;var day=this.getDate();if (day<10) day="0"+day;return year+"-"+month+"-"+day;};Date.prototype.getFomatDateTime=function(){var year=this.getFullYear();var month=this.getMonth()+1;if (month<10) month="0"+month;var day=this.getDate();if (day<10) day="0"+day;var hours=this.getHours();if (hours<10) hours="0"+hours;var minutes=this.getMinutes();if (minutes<10) minutes="0"+minutes;var seconds=this.getSeconds();if (seconds<10) seconds="0"+seconds;return year+"-"+month+"-"+day+" "+hours+":"+minutes+":"+seconds;};Array.prototype.indexOf=function(obj){for ( var i=0;i<this.length;i++){if (this[i]==obj) return i;}return-1;};Array.prototype.remove=function(index){if (index<0 || index>this.length){alert("index out of bound");return;}this.splice(index,1);};Array.prototype.removeEle=function(ele){for ( var i=0,count=this.length;i<count;i++){if (this[i]==ele){this.splice(i,1);return;}}};Math.UUID=function(){return ((new Date()).getTime()+"").substr(9);};String.UUID=function(){return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'? r:(r&0x3|0x8);return v.toString(16);});};Array.prototype.insert=function(index,ele){if (index<0 || index>this.length){alert("index out of bound");return;}this.splice(index,0,ele);};Array.prototype.values=function(indices){if (indices==null) return null;var varr=new Array();for ( var i=0;i<indices.length;i++){varr.push(this[indices[i]]);}return varr;};Array.prototype.clear=function(){this.splice(0,this.length);};function truncFloat(floatValue,precision){if (precision){if (!floatValue) floatValue="0";if (floatValue.toString().indexOf(".")==-1&&precision>0){floatValue+=".";for ( var i=0;i<precision;i++){floatValue+="0";}}else if (floatValue.toString().indexOf(".") !=-1){if (precision<=0) floatValue=floatValue.toString().substring(0,floatValue.toString().indexOf(".")+1);else{floatValue=floatValue.toString();if (floatValue.length<floatValue.indexOf(".")+precision+1){for ( var i=0,n=floatValue.indexOf(".")+precision+1-floatValue.length;i<n;i++){floatValue+="0";}}else floatValue=floatValue.substring(0,floatValue .indexOf(".")+precision+1);}}}return floatValue;};if (IS_IE&&!IS_STANDARD){window.$ge=document.getElementById;window.$ce=document.createElement;}else{function $ge(id){return document.getElementById(id);}function $ce(obj){return document.createElement(obj);}}
function getBoolean(value,defaultValue){if (value=='false') return false;else if (value=='true') return true;else if (value !=false&&value !=true) return defaultValue;else return value;};function getString(value,defaultValue){if (value==null || value=="") return defaultValue;return value;};function getInteger(value,defaultValue){if (isNaN(parseInt(value))) return defaultValue;return parseInt(value);};function getFloat(value,defaultValue){if (isNaN(parseFloat(value))) return defaultValue;return parseFloat(value);};function isNull(value,canBlank){if (value==null) return true;if (value==""&&!canBlank) return true;return false;};function isNotNull(value,canBlank){return !isNull(value,canBlank);};function convertPerToDecimal(per){if (per.indexOf("%")==-1) return;var decimal=per.substring(0,per.length-1);decimal=parseInt(decimal)/100;return decimal;};function isPercent(value){return value==null ? false:(""+value).indexOf("%") !=-1;};function per2decimal(value){var dec=value.replace("%","");dec=parseInt(dec)*0.01;return dec;};function isDigital(str){var re=/^((-?)([1-9]+[0-9]*|0{1}))(\.\d+)?$/;return re.test(str);};function isAlpha(str){var patrn=/^[A-Za-z]+$/;if (!patrn.exec(str)) return false;return true;};function isNumberOnly(str){var patrn=/^[0-9]+$/;if (!patrn.exec(str)) return false;return true;};function isNumber(str){str=str+"";if (str=="0") return true;var patrn=/(^-[1-9]\d*$)|^([1-9]\d*$)/;if (patrn.exec(str)==null) return false;else{if (parseInt(str)>=-9007199254740992&&parseInt(str)<=9007199254740992) return true;else return false;}};function isChinese(s){var patrn=/^[\u0391-\uFFE5]+$/;if (!patrn.exec(s)) return false;return true;};function isValidIdentifier(str){str=str.trim();var flag=true;var first=str.charAt(0);if (!(isAlpha(first) || first=="_"|| first=="$")) return false;for ( var i=1;i<str.length;i++){let=str.charAt(i);if (!(isAlpha(let) || isDigital(let) || let=="_")){flag=false;break;}}return flag;};function isEmail(s){var patrn=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if (!patrn.exec(s)) return false;return true;};function isPhone(s){var patrn=/^(?:0[0-9]{2,3}[-\\s]{1}|\\(0[0-9]{2,4}\\))[0-9]{6,8}$|^[1-9]{1}[0-9]{5,7}$|^[1-9]{1}[0-9]{10}$/;if (!patrn.exec(s)) return false;return true;}function convertXml(str){if (str !=null){str=str+"";var reg1=new RegExp("&","g");str=str.replace(reg1,"&amp;");var reg2=new RegExp("<","g");str=str.replace(reg2,"&lt;");var reg3=new RegExp(">","g");str=str.replace(reg3,"&gt;");var reg4=new RegExp("'","g");str=str.replace(reg4,"&apos;");var reg5=new RegExp("\"", "g");		str = str.replace(reg5, "&quot;");	}	return str;};function insertAtCursor(myField, myValue) {	if (myField.selectionStart || myField.selectionStart == "0") {		var startPos = myField.selectionStart;		var endPos = myField.selectionEnd;		return myField.value.substring(0, startPos) + myValue				+ myField.value.substring(endPos, myField.value.length)	} else if (document.selection) {		if (document.selection.type == 'Text') {			document.selection.clear();		}		var _sel = document.selection.createRange();		_sel.text = myValue;		return myField.value;	} else { 		return myField.value;	}	};function trim(vStr)   {       return vStr.replace(/(^\s+)|(\s+$)/g,""); };
function HashMap(){this.length=0;this.prefix="js_hashmap_pre_";this.trueObj=new Object;this.keyObj=new Object;};HashMap.prototype.put=function(key,value){if (this.keyObj[key] !=null) this.trueObj[key]=value;else{this.trueObj[key]=value;this.keyObj[key]=1;this.length++;}};HashMap.prototype.get=function(key){return this.trueObj[key];};HashMap.prototype.keySet=function(){var arrKeySet=new Array();var index=0;for ( var strKey in this.keyObj){arrKeySet[index++]=strKey;}return arrKeySet;};HashMap.prototype.values=function(){var arrValues=new Array();var index=0;for ( var strKey in this.keyObj){arrValues[index++]=this.trueObj[strKey];}return arrValues;};HashMap.prototype.size=function(){return this.length;};HashMap.prototype.remove=function(key){if (this.keyObj[key] !=null){var obj=this.trueObj[key];delete this.keyObj[key];delete this.trueObj[key];this.length--;return obj;}return null;};HashMap.prototype.clear=function(){this.keyObj=new Object;this.trueObj=new Object;this.length=0;};HashMap.prototype.isEmpty=function(){return this.length==0;};HashMap.prototype.containsKey=function(key){return this.keyObj[key] !=null;};HashMap.prototype.containsValue=function(value){for ( var strKey in this.trueObj){if (this.trueObj[strKey]==value) return true;}return false;};HashMap.prototype.putAll=function(map){if (map==null) return;if (map.constructor !=HashMap) return;var arrKey=map.keySet();var arrValue=map.values();for ( var i in arrKey){this.put(arrKey[i],arrValue[i]);}};HashMap.prototype.toString=function(){var str="";for ( var strKey in this.keyObj){str+=strKey+" : "+this.trueObj[strKey]+"\r\n";}return str;};
function Singleton(create){if (window.sys_singleMap==null) window.sys_singleMap=new HashMap();var instance=window.sys_singleMap.get(this.componentType);if (instance !=null) return instance;else{create=getBoolean(create,true);if (!create) return null;window.sys_singleMap.put(this.componentType,this);return null;}};
var classWidthCache=new HashMap();function getTextWidth(text,className){var cacheKey="NULL";if(className){cacheKey=className;}var lengthb=0;if(text){lengthb=text.lengthb();}var charwidth=classWidthCache.get(cacheKey);if(!charwidth){var tmpDiv=$ce("DIV");tmpDiv.innerHTML='U';tmpDiv.style.position='absolute';tmpDiv.className=className;tmpDiv.style.top="0px";tmpDiv.style.left="0px";tmpDiv.style.width='auto';tmpDiv.style.visibility='hidden';tmpDiv.style.whiteSpace='nowrap';document.body.appendChild(tmpDiv);charwidth=tmpDiv.offsetWidth;tmpDiv.innerHTML="";document.body.removeChild(tmpDiv);classWidthCache.put(cacheKey,charwidth);}return charwidth*lengthb;};function getTextWidthBySize(text,fontSize){var lengthb=0;if(text){lengthb=text.lengthb();}var tmpDiv=$ce("DIV");tmpDiv.innerHTML='U';tmpDiv.style.position='absolute';tmpDiv.style.fontSize=fontSize+"px";tmpDiv.style.top="0px";tmpDiv.style.left="0px";tmpDiv.style.width='auto';tmpDiv.style.visibility='hidden';tmpDiv.style.whiteSpace='nowrap';document.body.appendChild(tmpDiv);charwidth=tmpDiv.offsetWidth;tmpDiv.innerHTML="";document.body.removeChild(tmpDiv);return charwidth*lengthb;};function getTextHeight(text,className){var tmpDiv=$ce("div");tmpDiv.innerHTML=text;tmpDiv.style.position="absolute";tmpDiv.className=className;tmpDiv.style.top="0px";tmpDiv.style.left="0px";tmpDiv.style.height="auto";tmpDiv.style.visibility="hidden";tmpDiv.style.whiteSpace="nowrap";document.body.appendChild(tmpDiv);var height=tmpDiv.offsetHeight;document.body.removeChild(tmpDiv);return height;};function getCssHeight(className){var tmpDiv=$ce("div");tmpDiv.className=className;tmpDiv.style.position="absolute";document.body.appendChild(tmpDiv);var height=tmpDiv.offsetHeight;document.body.removeChild(tmpDiv);return height;};function isDivScroll(div){if (div.scrollWidth>div.clientWidth) return true;else return false;};function isDivVScroll(div){if (div.scrollHeight>div.clientHeight) return true;else return false;};function compFirstScrollTop(oHtml){offsetTop=document.documentElement.scrollTop;if(IS_IE9){var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();try{offsetTop=topWin.document.body.scrollTop;}catch(e){Logger.error(e);}}return offsetTop;};function compFirstScrollClientHeight(oHtml){var offsetTop=0;while (oHtml){offsetTop=oHtml.scrollTop;if(offsetTop !=0){var clientHeight=oHtml.clientHeight;return clientHeight==null ? 0:clientHeight;}oHtml=oHtml.parentNode;}return 0;};function compOffsetTop(oHtml,targetParent){var offsetTop=0;while (oHtml&&oHtml !=targetParent){if(oHtml.offsetTop>0){offsetTop+=oHtml.offsetTop;}oHtml=oHtml.offsetParent;}return offsetTop;};function compScrollTop(oHtml,targetParent){var scrollTop=0;while (oHtml&&oHtml !=targetParent){if (oHtml.parentNode&&oHtml.parentNode.scrollTop&&oHtml.parentNode.nodeName !='HTML') scrollTop+=oHtml.parentNode.scrollTop;oHtml=oHtml.parentNode;}return scrollTop;};function compOffsetLeft(oHtml,targetParent){var offsetLeft=0;while (oHtml&&oHtml !=targetParent){offsetLeft+=oHtml.offsetLeft;if (oHtml.offsetParent) offsetLeft-=oHtml.offsetParent.scrollLeft;oHtml=oHtml.offsetParent;}return offsetLeft;};function positionElementInView(eleDiv){if (parseInt(eleDiv.style.top)+eleDiv.offsetHeight>document.body.clientHeight){var top=document.body.clientHeight-eleDiv.offsetHeight;if(top<0){eleDiv.style.top="0px";eleDiv.style.height=document.body.clientHeight+"px";}else eleDiv.style.top=top+"px";}};function positionElementToScreenCenter(element,sctop,clinetHeight){var height=element.offsetHeight;var width=element.offsetWidth;if(element.children){for(var i=0;i<element.children.length;i++){if(element.children[i].offsetWidth>width){width=element.children[i].offsetWidth;}}}var screenHeight=document.body.clientHeight;var screenWidth=document.body.clientWidth;var topWin=getLfwTop() || window;var topScreenHeight=topWin.document.body.clientHeight;var topScreenWidth=topWin.document.body.clientWidth;if(screenHeight>topScreenHeight){screenHeight=topScreenHeight;}if(screenWidth>topScreenWidth){screenWidth=topScreenWidth;}if(element.parentNode){screenWidth=element.parentNode.offsetWidth<screenWidth ? element.parentNode.offsetWidth:screenWidth;}var styleTop=screenHeight-height;if(styleTop<0) styleTop=60;if (sctop !=null) element.style.top=parseInt(styleTop/2)+parseInt(sctop)+"px";else element.style.top=styleTop/2+"px";var left=screenWidth-width;if(left<0) left=0;element.style.left=left/2+"px";};function positionElementToScreenCenterChangeSize(element,sctop){var height=element.offsetHeight;var width=element.offsetWidth;var screenHeight=document.body.clientHeight;var screenWidth=document.body.clientWidth;if(element.parentNode){screenWidth=element.parentNode.offsetWidth<screenWidth ? element.parentNode.offsetWidth:screenWidth;}var rate=1;var centerX=screenWidth/2;var centerY=screenHeight/2;if(IS_IPAD){rate=width/screenWidth;if(height/screenHeight>rate){rate=height/screenHeight;}if(rate<1){rate=1;}centerY=centerY-20;}element.style.top=centerY+"px";element.style.left=centerX+"px";element.style.width=0+"px";element.style.height=0+"px";element.style.overflow="hidden";_changeSize(1.0,20,element,centerX,centerY,0,0,width/rate,height/rate);};function _changeSize(step,speed,element,centerX,centerY,currWidth,currHeight,width,height){var newWidth=currWidth+(width*step);if (newWidth>width) newWidth=width;var newHeight=currHeight+(height*step);if (newHeight>height) newHeight=height;var newLeft=centerX-(newWidth/2);var newTop=centerY-(newHeight/2);element.style.width=newWidth+"px";element.style.height=newHeight+"px";element.style.left=newLeft+"px";element.style.top=newTop+"px";if (newWidth<width || newHeight<height){element.ftTimeOutFunc=setTimeout(function(){_changeSize(step,speed,element,centerX,centerY,newWidth,newHeight,width,height);},speed);}else{element.style.overflow="";}};function positionElementToCenter(element,reltop,clientHeight){var parentWidth=0;var parentHeight=0;if (element.parentNode.tagName.toUpperCase()=="BODY"){parentWidth=document.body.clientWidth;parentHeight=document.body.clientHeight;}else{parentWidth=element.parentNode.offsetWidth<1200 ? element.parentNode.offsetWidth:1200;parentHeight=element.parentNode.offsetHeight;}if (clientHeight !=null&&clientHeight>0){parentHeight=clientHeight;}var eleWidth=element.style.width;var eleHeight=element.style.height;var index=eleWidth.indexOf("%");if (index !=-1){left=(parentWidth*(1-translatePercentToFloat(eleWidth)))/2;left=parseInt(left);}else if (parentWidth<=parseInt(eleWidth)) left=0;else{left=(parentWidth-parseInt(eleWidth))/2;left=parseInt(left);}index=eleHeight.indexOf("%");if (index !=-1){topb=(parentHeight*(1-translatePercentToFloat(eleHeight)))/2;topb=parseInt(topb);}else if (parentHeight<=parseInt(eleHeight)) topb=0;else{topb=(parentHeight-parseInt(eleHeight))/2;topb=parseInt(topb);}element.style.position="absolute";if(reltop !=null&&reltop !=0) topb+=reltop;element.style.top=topb+"px";element.style.left=left+"px";};function positionneSelonEvent(eltApos,e){var droite=document.body.clientWidth-e.clientX;var bas=document.body.clientHeight-e.clientY;var scrollLeft=document.body.scrollLeft;var scrolltop=document.body.scrollTop;var canResetX=false;var canResetY=false;if(document.body.clientWidth/2<e.clientX){canResetX=true;}if(document.body.clientHeight/2<e.clientY){canResetY=true;}if (droite<eltApos.offsetWidth){var realWidth=scrollLeft+e.clientX-eltApos.offsetWidth;if(realWidth<0) realWidth=0;eltApos.style.left=realWidth+"px";}else{eltApos.style.left=scrollLeft+e.clientX+"px";}if (bas<eltApos.offsetHeight&&canResetY){var realTop=scrolltop+e.clientY-eltApos.offsetHeight;if(realTop<0) realTop=0;eltApos.style.top=realTop+"px";}else{eltApos.style.top=scrolltop+e.clientY+"px";}};function positionneSelonPosFournie(node,top,left,obj){var visibleWidth=document.body.clientWidth-left;var bas=document.body.clientHeight-top;var scrollLeft=document.body.scrollLeft;var scrolltop=document.body.scrollTop;var canResetX=false;var canResetY=false;if(document.body.clientWidth/2<left){canResetX=true;}if(document.body.clientHeight/2<top){canResetY=true;}if (visibleWidth<node.offsetWidth){var leftSpace=0;if(obj.parentMenu.componentType=="MENUBAR"){leftSpace=scrollLeft+left-(node.offsetWidth-visibleWidth);}else{leftSpace=scrollLeft+left-node.offsetWidth;while(obj.parentMenu&&obj.parentMenu.componentType !='MENUBAR'){var parentNode=obj.parentMenu.Div_gen;leftSpace-=parentNode.offsetWidth;obj=obj.parentMenu;}}node.style.left=leftSpace+"px";}else node.style.left=scrollLeft+left+"px";if (bas<node.offsetHeight&&canResetY){var realTop=scrolltop+top-node.offsetHeight;if (realTop<0) realTop=0;node.style.top=realTop+"px";}else{node.style.top=scrolltop+top+"px";}};function getStyleAttribute(node,type){if (IS_IE){var style=node.currentStyle;return style[type];}else{var style=document.defaultView.getComputedStyle(node,null);if (style) return style.getPropertyValue(type);return null;}};function translatePercentToFloat(percent){var index=percent.indexOf("%");if (index==-1){log("Measures.js(translatePercentToFloat), The string: "+percent+" is not in percent format!");return 1;}try{return parseInt(percent.substring(0,index))/100;}catch (exception){log("Measures.js(translatePercentToFloat),"+exception.name+":"+exception.message);return 1;}};var STANDARD_ZINDEX=10000;function getZIndex(){if (pageUI){if (!pageUI.STANDARD_ZINDEX) pageUI.STANDARD_ZINDEX=10000;return++pageUI.STANDARD_ZINDEX;}else{return++STANDARD_ZINDEX;}};function getTopZIndex(zindex){var z_index=parseInt(zindex,10);if(isNaN(z_index)){z_index=getZIndex();}else{if(z_index<STANDARD_ZINDEX){z_index=getZIndex();}}return z_index;}function convertWidth(width){if(width==null || width=="") return width;width=width+"";if(width.indexOf('%') !=-1) return width;if(width.indexOf('px') !=-1) return width;return width+"px";}function convertHeight(height){if(height==null || height=="") return height;height=height+"";if(height.indexOf('%') !=-1) return height;if(height.indexOf('px') !=-1) return height;return height+"px";}
window.objects=new Object;BaseComponent.SCROLLWIDTH=18;BaseComponent.prototype=new ListenerUtil;BaseComponent.ELEMENT_ERROR="error";BaseComponent.ELEMENT_WARNING="warning";BaseComponent.ELEMENT_NORMAL="normal";BaseComponent.ELEMENT_SUCCESS="success";function BaseComponent(name,left,top,width,height){if (arguments.length==0) return;ListenerUtil.call(this,true);this.id=name;this.left=getInteger(left,0);this.top=getInteger(top,0);this.width=getString(convertWidth(width),'100%');this.height=getString(convertHeight(height),'100%');this.visible=true;window.objects[this.id]=this;this.allChildObjects=new Array();this.hotKey=null;ListenerUtil.call(this,true);this.ctxChanged=false;};BaseComponent.prototype.placeIn=function(parent){var objHtml=this.getObjHtml();objHtml.owner=this;var oThis=this;objHtml.oncontextmenu=function(e){e=EventUtil.getEvent();oThis.onBeforeShowMenu(e);oThis.oncontextmenu(e);clearEventSimply(e);};if (parent.add){parent.add(objHtml);}else{parent.appendChild(objHtml);}this.parentHtml=objHtml.parentNode;this.manageSelf();this.ctxChanged=false;};BaseComponent.prototype.getObjHtml=function(){return this.Div_gen;};BaseComponent.prototype.oncontextmenu=function(e){e=EventUtil.getEvent();if(this.contextMenu){this.contextMenu.triggerObj=this;this.contextMenu.show(e);stopEvent(e);}clearEventSimply(e);};BaseComponent.prototype.add=function(ObjHtml){if (ObjHtml.owner){this.allChildObjects.push(ObjHtml.owner);ObjHtml.owner.parentOwner=this;}this.getObjHtml().appendChild(ObjHtml);};BaseComponent.prototype.manageSelf=function(){};BaseComponent.prototype.setPosition=function(left,top){this.left=getInteger(left,0);this.top=getInteger(top,0);this.getObjHtml().style.left=this.left+"px";this.getObjHtml().style.top=this.top+"px";};BaseComponent.prototype.setSize=function(width,height){this.width=getString(width,"100%");this.height=getString(height,"100%");if(width !=-1) this.getObjHtml().style.width=this.width;if(height !=-1) this.getObjHtml().style.height=this.height;};BaseComponent.prototype.setBounds=function(left,top,width,height){this.left=getInteger(left,0);this.top=getInteger(top,0);this.width=getString(convertWidth(width),"100%");this.height=getString(convertHeight(height),"100%");this.getObjHtml().style.left=this.left+"px";this.getObjHtml().style.top=this.top+"px";this.getObjHtml().style.width=this.width;this.getObjHtml().style.height=this.height;};BaseComponent.prototype.getCompWidth=function(){return this.width;};BaseComponent.prototype.getCompHeight=function(){return this.height;};BaseComponent.prototype.setZIndex=function(zIndex){this.getObjHtml().style.zIndex=zIndex;};BaseComponent.prototype.getContentHeight=function(){return this.getObjHtml().offsetHeight;};BaseComponent.prototype.getContentWidth=function(){return this.getObjHtml().offsetWidth;};BaseComponent.prototype.destroySelf=function(){this.destroy();};BaseComponent.prototype.destroy=function(){if (this.allChildObjects !=null){this.allChildObjects=null;}var objHtml=this.getObjHtml();if (objHtml){clearHtmlNodeProperties(objHtml);if(objHtml.parentNode){objHtml.parentNode.removeChild(objHtml);}objHtml=null;}this.parentHtml=null;this.parentOwner=null;delete window.objects[this.id];window.objects[this.id]=null;for (var i=0;i<window.clickHolders.length;i++){if (window.clickHolders[i]==this){window.clickHolders.splice(i,1);break;}}this.clearListenerMap();if(this.destroyFurther) this.destroyFurther();clearNodeProperties(this);};BaseComponent.prototype.hide=function(){var obj=this.getObjHtml();if(obj !=null) obj.style.display="none";this.visible=false;this.ctxChanged=true;};BaseComponent.prototype.show=function(){var obj=this.getObjHtml();if(obj !=null) obj.style.display="block";this.visible=true;this.ctxChanged=true;};BaseComponent.prototype.hideV=function(){var obj=this.getObjHtml();if(obj !=null) obj.style.visibility="hidden";this.visible=false;this.ctxChanged=true;};BaseComponent.prototype.showV=function(){var obj=this.getObjHtml();obj.style.visibility="";this.visible=true;this.ctxChanged=true;};BaseComponent.prototype.setClass=function(key,className){if (this.classMap==null) this.classMap=new HashMap();this.classMap.put(key,className);this.onClassChange(key);};BaseComponent.prototype.onClassChange=function(key){};BaseComponent.prototype.setContextMenu=function(menu){this.contextMenu=menu;};BaseComponent.prototype.getContextMenu=function(){return this.contextMenu;};BaseComponent.prototype.showMenu=function(e){if (this.contextMenu !=null) this.contextMenu.show(e);};BaseComponent.prototype.onBeforeShowMenu=function(e){var simpleEvent={"obj":this};this.doEventFunc("beforeShow",simpleEvent);};BaseComponent.prototype.handleHotKey=function(key){if (this.hotKey !=null){if (key==this.hotKey&&this.onclick){this.onclick(null);return this;}}return null;};BaseComponent.prototype.setHotKey=function(hotKey){this.hotKey=hotKey;};BaseComponent.prototype.getHotKey=function(){return this.hotKey;};BaseComponent.prototype.getChangedContext=function(){return this.changedObj;};BaseComponent.prototype.setChangedContext=function(context){};BaseComponent.prototype.notifyChange=function(type,value){if (type==null) return;if (isReturning()){if (this.changedObj !=null&&typeof this.changedObj[type] !='undefined') delete this.changedObj[type];return;}if (this.changedObj==null){this.changedObj=new Object;this.changedObj.id=this.id;}this.changedObj[type]=value;};BaseComponent.prototype.clearChange=function(){delete this.changedObj;};BaseComponent.prototype.hasProperty=function(property){if(typeof property !="undefined") return true;else return false;};BaseComponent.prototype.isDblEvent=function(eventname){if (this.currentEventName !=null&&this.currentEventName==eventname) return true;else{var oThis=this;if (this.cleanCurrEventName) clearTimeout(this.cleanCurrEventName);this.currentEventName=eventname;this.cleanCurrEventName=setTimeout(function(){oThis.currentEventName=null;},500);return false;}};
window.clickHolders=new Array();if (window.globalObject==null) window.globalObject=new Object;SHIFT_MASK=1<<0;CTRL_MASK=1<<1;ALT_MASK=1<<3;document.oncontextmenu=documentContextMenu;function documentContextMenu(){for ( var i=0;i<window.clickHolders.length;i++){if (window.clickHolders[i].outsideContextMenuClick) window.clickHolders[i].outsideContextMenuClick();}if (window.debugMode==true) return true;return false;};document.onclick=documentClick;function documentClick(e){e=EventUtil.getEvent();for ( var i=0;i<window.clickHolders.length;i++){if (window.clickHolders[i].outsideClick) window.clickHolders[i].outsideClick(e);}window.clickHolders.trigger=null;clearEventSimply(e);};document.onmouseover=documentMouseover;function documentMouseover(){for ( var i=0;i<window.clickHolders.length;i++){if (window.clickHolders[i]&&window.clickHolders[i].outsideOver) window.clickHolders[i].outsideOver();}};if(document.addEventListener){document.addEventListener('DOMMouseScroll',documentMouseWheelFunc,false);}document.onmousewheel=documentMouseWheelFunc;function documentMouseWheelFunc(e){for ( var i=0;i<window.clickHolders.length;i++){if (window.clickHolders[i].outsideMouseWheelClick) window.clickHolders[i].outsideMouseWheelClick(e);}};document.onkeydown=documentKeydown;function documentKeydown(e){if (!e){e=window.event;}var keyCode=e.keyCode ? e.keyCode:e.charCode ? e.charCode:e.which ? e.which:void 0;if ((e.ctrlKey)&&(keyCode==78)){stopDefault(e);return false;}else if ((e.shiftKey)&&(keyCode==121)){stopDefault(e);return false;}else if ((e.ctrlKey)&&(keyCode==66)){stopDefault(e);return false;}else if ((e.ctrlKey)&&(keyCode==69)){stopDefault(e);}else if ((e.ctrlKey)&&(keyCode==82)){stopDefault(e);return false;}else if ((e.ctrlKey)&&(keyCode==65)){stopDefault(e);return false;}else if (keyCode==80&&e.ctrlKey){e.keyCode=0;stopDefault(e);}else if (keyCode==76&&e.ctrlKey){stopDefault(e);return false;}else if (keyCode==73&&e.ctrlKey){stopDefault(e);}else if (e.ctrlKey&&keyCode==67){}else if (e.ctrlKey&&keyCode==86){}else if (e.ctrlKey&&keyCode==68){stopDefault(e);return false;}else if (e.altKey&&keyCode==90){stopDefault(e);return false;}else if (keyCode==114){e.keyCode=505;stopDefault(e);return false;}else if (keyCode==8){var ev=e.srcElement || e.target;if (ev&&ev.tagName !="INPUT"&&ev.tagName !="TEXTAREA"){stopAll(e);return false;}}return true;};function documentKeyup(e){return $pageKeyUpFunc(e);};function $pageKeyUpFunc(e){if(!window.pageUI){return true;}if (!e) e=window.event;var keyCode=e.keyCode ? e.keyCode:e.charCode ? e.charCode:e.which ? e.which:void 0;if (keyCode==68&&e.ctrlKey&&e.shiftKey){if (window.debugMode==true) showDebugDialog();}if (window.top !=window){var parentPage=parent;while (parentPage&&!parentPage.$pageKeyUpFunc){if(parentPage==parentPage.parent) break;parentPage=parentPage.parent;}if (parentPage&&parentPage.$pageKeyUpFunc) return parentPage.$pageKeyUpFunc(e);}return true;};
function PrintProxy(){if (window.$pdb==null){try{window.$pdb=new ActiveXObject("UFGears.PrintServer");window.$pdb.setDBName("PrintDB","");}catch (error){window.$pdb=null;}}}PrintProxy.prototype.preview=function(obj){return window.$pdb.preview(obj);};PrintProxy.prototype.getVPrinters=function(){return window.$pdb.getVPrinters();};PrintProxy.prototype.getPhPrinters=function(){if (window.$pdb==null) return "";var pp=window.$pdb.getPhPrinters();eval("var data = "+pp);return data.data.join();};PrintProxy.prototype.doPrintFile=function(id){var obj=getSessionAttribute("print_content_"+id);if (obj==null){obj=parent.getSessionAttribute("print_content_"+id);}this.preview(obj);};PrintProxy.prototype.printOut=function(printerName,idArr){for ( var i=0;i<idArr.length;i++){var obj=getSessionAttribute("print_content_"+idArr[i]);window.$pdb.printOut(printerName,obj);}};function CacheProxy(dbName){if (window.db==null){try{window.db=new ActiveXObject("UFGears.LocalDB");var path="";if(window.clientMode){if(window.offlineCachePath) path=window.offlineCachePath;else path="c:\\demo\\db";}window.db.setDbName(dbName,path);}catch (error){window.db=null;}}}CacheProxy.prototype.isInitialized=function(){var rt=db.GetCacheObjs("1");eval("var obj = "+rt);return obj.data.length>0;};CacheProxy.prototype.isCacheEnabled=function(){return window.db !=null;};CacheProxy.prototype.initCache=function(){showProgressDialog( trans("rt_00000_1"));var ajax=new Ajax();ajax.setPath(window.globalPath+"/cache");ajax.addParam("type","fullinit");ajax.setReturnFunc(CacheProxy.fullInitReturnFunc);ajax.post();};CacheProxy.fullInitReturnFunc=function(xmlHttpReq,returnArgs,tip,ajax){try{var resp=xmlHttpReq.responseText;var init=db.initCache(resp);}finally{hideProgressDialog();}};CacheProxy.prototype.updateCache=function(versionMap){var rt=db.GetCacheObjs("1");eval("var obj = "+rt);if (obj.data.length>0){var tableVersionStr=new Array;for ( var i=0;i<obj.data.length;i++){var data=obj.data[i];var version=versionMap.map[data[0]];if (version !=null){if (version !=data[2]) tableVersionStr.push(data[0]+","+data[2]);}}}tableVersionStr=tableVersionStr.join(';');if (tableVersionStr !=""){showProgressDialog(trans("rt_00000_2"));var ajax=new Ajax();ajax.setPath(window.globalPath+"/cache");ajax.addParam("type","update");ajax.addParam("tableVersion",tableVersionStr);ajax.setReturnFunc(CacheProxy.fullInitReturnFunc);ajax.post();}};CacheProxy.prototype.isTableCached=function(tableName){return db.isTableCached(tableName);};CacheProxy.prototype.executeQuery=function(sql){return db.queryAll(sql);};CacheProxy.prototype.executeQueryByPage=function(sql,size,index){return db.queryByPage(sql,size,index);};CacheProxy.prototype.executeSql=function(sql){return db.executeSql(sql);};function getPrintProxy(){if (window.globalObject.printInstance==null) window.globalObject.printInstance=new PrintProxy();return window.globalObject.printInstance;}function getCacheProxy(dbName){if(window.clientMode) dbName="pbase_design";if (window.globalObject.cacheInstance==null) window.globalObject.cacheInstance=new Object;if (window.globalObject.cacheInstance[dbName]==null){window.globalObject.cacheInstance[dbName]=new CacheProxy(dbName);}return window.globalObject.cacheInstance[dbName];};
window.currentLoadingLib=[];window.idFuncArr={};window.FUNC_ID=1;function require(id,func,uuid){if(isLibLoaded(id)){if(uuid !=null){func=idFuncArr[uuid];if(func) func();}else{if(func) func();}return;}if(window.currentLoadingLib[id] !=null){if(uuid==null){uuid=window.FUNC_ID++;idFuncArr[uuid]=func;}setTimeout("require('"+id+"', null, '"+uuid+"')",100);return;}var filelib=calculateAllLibs(id);var idlib=filelib.idlib;if(idlib !=null){for(var i=0;i<idlib.length;i++) window.currentLoadingLib[idlib[i]]=1;}require_css(filelib.csslib);require_js(filelib.jslib,func,filelib.idlib);}function requireList(ids,func){if (ids.length==0) func();else{var id=ids[0];ids.splice(0,1);require(id,function(){requireList(ids,func)});}}function isLibLoaded(id){if(window.loadedLib[id] !=null) return true;if(window.debugMode==false){if(window.libArray[id] !=null) return false;return true;}return false;}function calculateAllLibs(id){var jsArr=[];var cssArr=[];var idArr=[];calculateLibs(id,jsArr,cssArr,idArr);var filelib={};filelib.csslib=cssArr;filelib.jslib=jsArr;filelib.idlib=idArr;return filelib;}function calculateLibs(id,jsArr,cssArr,idArr){if(window.loadedLib[id] !=null){return;}var lib=window.libArray[id];if(lib==null){alert("lib is null:"+id);return;}var dps=lib.dp;if(dps !=null){for(var i=0;i<dps.length;i++){calculateLibs(dps[i],jsArr,cssArr,idArr);}}if(lib.jslib !=null){for(var i=0;i<lib.jslib.length;i++) jsArr.push(lib.jslib[i]);}if(lib.csslib !=null){for(var i=0;i<lib.csslib.length;i++) cssArr.push(lib.csslib[i]);}idArr.push(id);}window.cssLoadRecord={};window.jsLoadRecord={};function require_css(files){if(files==null || files.length==0) return;var html_doc=document.getElementsByTagName('head')[0];for(var i=0;i<files.length;i++){if(window.cssLoadRecord[files[i]] !=null) continue;window.cssLoadRecord[files[i]]=1;var css=document.createElement('link');css.setAttribute('rel','stylesheet');css.setAttribute('type','text/css');var path=window.themePath+"/"+files[i]+".css";css.setAttribute('href',path);html_doc.appendChild(css);}}function require_js(files,func,ids){if(files==null || files.length==0){for(var i=0;i<ids.length;i++) window.loadedLib[ids[i]]=1;func();return;}var html_doc=document.getElementsByTagName('head')[0];if(window.jsLoadRecord[files[0]] !=null){if(files.length==1){for(var i=0;i<ids.length;i++){window.currentLoadingLib[ids[i]]=null;window.loadedLib[ids[i]]=1;}func();}else{files.splice(0,1);require_js(files,func,ids);}return;}var js=document.createElement('script');js.setAttribute('type','text/javascript');var path=window.baseGlobalPath+"/frame/device_pc/script/"+files[0]+".js";js.setAttribute('src',path);html_doc.appendChild(js);if(!IS_IE9){js.onreadystatechange=function (){if (js.readyState=='complete'|| js.readyState=='loaded'){window.jsLoadRecord[files[0]]=1;if(files.length==1){for(var i=0;i<ids.length;i++){window.currentLoadingLib[ids[i]]=null;window.loadedLib[ids[i]]=1;}func();}else{files.splice(0,1);require_js(files,func,ids);}}};}if(!IS_IE10){js.onload=function (){window.jsLoadRecord[files[0]]=1;if(files.length==1){for(var i=0;i<ids.length;i++){window.currentLoadingLib[ids[i]]=null;window.loadedLib[ids[i]]=1;}func();}else{files.splice(0,1);require_js(files,func,ids);}};}}
NumberFormatMeta.prototype=new Object;NumberFormatMeta.prototype.metaType="NumberFormatMeta";function NumberFormatMeta(){};NumberFormatMeta.prototype.isNegRed=true;NumberFormatMeta.prototype.isMarkEnable=true;NumberFormatMeta.prototype.markSymbol=",";NumberFormatMeta.prototype.pointSymbol=".";NumberFormatMeta.prototype.positiveFormat="n";NumberFormatMeta.prototype.negativeFormat="-n";CurrencyFormatMeta.prototype=new NumberFormatMeta;CurrencyFormatMeta.prototype.metaType="CurrencyFormatMeta";CurrencyFormatMeta.prototype.curSymbol="";function CurrencyFormatMeta(){this.positiveFormat="$n";this.negativeFormat="$-n";};DateTimeFormatMeta.prototype=new Object();DateTimeFormatMeta.prototype.metaType="DateTimeFormatMeta";DateTimeFormatMeta.prototype.format="yyyy-MM-dd hh:mm:ss";DateTimeFormatMeta.prototype.speratorSymbol="-";function DateTimeFormatMeta(){};DateFormatMeta.prototype=new DateTimeFormatMeta();function DateFormatMeta(){this.format="yyyy-MM-dd";};TimeFormatMeta.prototype=new DateTimeFormatMeta;function TimeFormatMeta(){this.format="hh:mm:ss";};AddressFormatMeta.prototype=new Object;function AddressFormatMeta(){this.express="C S T R P";this.separator=" ";};
function AbstractMasker(){};AbstractMasker.prototype.format=function(obj){if(obj==null) return null;var fObj=this.formatArgument(obj);return this.innerFormat(fObj);};AbstractMasker.prototype.formatArgument=function(obj){};AbstractMasker.prototype.innerFormat=function(obj){};AbstractSplitMasker.prototype=new AbstractMasker;function AbstractSplitMasker(){};AbstractSplitMasker.prototype.elements=new Array ;AbstractSplitMasker.prototype.format=function(obj){if(obj==null) return null;var fObj=this.formatArgument(obj);return this.innerFormat(fObj);};AbstractSplitMasker.prototype.formatArgument=function(obj){return obj;};AbstractSplitMasker.prototype.innerFormat=function(obj){if(obj==null || obj=="") return new FormatResult(obj);this.doSplit();var result="";result=this.getElementsValue(this.elements,obj);return new FormatResult(result);};AbstractSplitMasker.prototype.getElementsValue=function(element,obj){var result="";if (element instanceof Array){for(var i=0;i<element.length ;i++){result=result+this.getElementsValue(element[i],obj);}}else{if(element.getValue) result=element.getValue(obj);}return result;};AbstractSplitMasker.prototype.getExpress=function(){};AbstractSplitMasker.prototype.doSplit=function(){var express=this.getExpress();if(this.elements==null || this.elements.length==0) this.elements=this.doQuotation(express,this.getSeperators(),this.getReplaceds(),0);};AbstractSplitMasker.prototype.doQuotation=function(express,seperators,replaced,curSeperator){if(express.length==0) return null;var elements=new Array();var pattern=new RegExp('".*?"',"g");var fromIndex=0;var result ;do{result=pattern.exec(express);if(result !=null){var i=result.index;var j=pattern.lastIndex ;if(i !=j){if(fromIndex<i){var childElements=this.doSeperator(express.substring(fromIndex,i),seperators,replaced,curSeperator);if(childElements !=null&&childElements.length>0){elements.push(childElements);}}}elements.push(new StringElement(express.substring(i+1,j-1)));fromIndex=j;}}while (result!=null);if(fromIndex<express.length ){var childElements=this.doSeperator(express.substring(fromIndex,express.length ),seperators,replaced,curSeperator);if(childElements !=null&&childElements.length>0) elements.push(childElements);}return elements;};AbstractSplitMasker.prototype.doSeperator=function(express,seperators,replaced,curSeperator){if(curSeperator>=seperators.length){var elements=new Array;elements.push(this.getVarElement(express));return elements;}if(express.length==0) return null;var fromIndex=0;var elements=new Array();var pattern=new RegExp(seperators[curSeperator],"g");var result ;do{result=pattern.exec(express);if(result !=null){var i=result.index ;var j=pattern.lastIndex;if(i !=j){if(fromIndex<i){var childElements=this.doSeperator(express.substring(fromIndex,i),seperators,replaced,curSeperator+1);if(childElements !=null&&childElements.length>0) elements.push(childElements);}if(replaced[curSeperator] !=null){elements.push(new StringElement(replaced[curSeperator]));}else{elements.push(new StringElement(express.substring(i,j)));}fromIndex=j;}}}while (result!=null);if(fromIndex<express.length ){var childElements=this.doSeperator(express.substring(fromIndex,express.length ),seperators,replaced,curSeperator+1);if(childElements !=null&&childElements.length>0) elements.push(childElements);}return elements;};AddressMasker.prototype=new AbstractSplitMasker;function AddressMasker(formatMeta){this.formatMeta=formatMeta;};AddressMasker.prototype.getExpress=function(){return this.formatMeta.express;};AddressMasker.prototype.getReplaceds=function(){return [this.formatMeta.separator];};AddressMasker.prototype.getSeperators=function(){return ["(\\s)+?"];};AddressMasker.prototype.getVarElement=function(express){var ex={};if(express==("C")) ex.getValue=function(obj){return obj.country;};if(express==("S")) ex.getValue=function(obj){return obj.state;};if(express==("T")) ex.getValue=function(obj){return obj.city;};if(express==("D")) ex.getValue=function(obj){return obj.section;};if(express==("R")) ex.getValue=function(obj){return obj.road;};if(express==("P")) ex.getValue=function(obj){return obj.postcode;};if(typeof(ex.getValue)==undefined) return new StringElement(express);else return ex;};AddressMasker.prototype.formatArgument=function(obj){return obj;};NumberMasker.prototype=new AbstractMasker;NumberMasker.prototype.formatMeta=null;NumberMasker.prototype.innerFormat=function (obj){var dValue,express,seperatorIndex,strValue;dValue=obj.value;if (dValue>0){express=this.formatMeta.positiveFormat;strValue=dValue+'';}else if (dValue<0){express=this.formatMeta.negativeFormat;strValue=(dValue+'').substr(1,(dValue+'').length-1);}else{express=this.formatMeta.positiveFormat;strValue=dValue+'';}seperatorIndex=strValue.indexOf('.');strValue=this.setTheSeperator(strValue,seperatorIndex);strValue=this.setTheMark(strValue,seperatorIndex);var color=null;if(dValue<0&&this.formatMeta.isNegRed){color="FF0000";}return new FormatResult(express.replaceAll('n',strValue),color);};NumberMasker.prototype.setTheMark=function (str,seperatorIndex){var endIndex,first,index;if (!this.formatMeta.isMarkEnable) return str;if(seperatorIndex<=0) seperatorIndex=str.length;first=str.charCodeAt(0);endIndex=0;if(first==45) endIndex=1;index=seperatorIndex-3;while (index>endIndex){str=str.substr(0,index-0)+this.formatMeta.markSymbol+str.substr(index,str.length-index);index=index-3;}return str;};NumberMasker.prototype.setTheSeperator=function(str,seperatorIndex){var ca;if (seperatorIndex>0){ca=NumberMasker.toCharArray(str);ca[seperatorIndex]=this.formatMeta.pointSymbol;str=ca.join('');}return str;};NumberMasker.toCharArray=function(str){var str=str.split("");var charArray=new Array();for(var i=0 ;i<str.length ;i++){charArray.push(str[i]);}return charArray;};function NumberMasker(formatMeta){this.formatMeta=formatMeta;};NumberMasker.prototype.formatArgument=function(obj){var numberObj={};numberObj.value=obj;return numberObj;};CurrencyMasker.prototype=new NumberMasker;CurrencyMasker.prototype.formatMeta=null;function CurrencyMasker(formatMeta){this.formatMeta=formatMeta;};CurrencyMasker.prototype.innerFormat=function(obj){var fo=(new NumberFormat(this.formatMeta)).innerFormat(obj);fo.value=fo.value.replace("$",this.formatMeta.curSymbol);return fo;};DateTimeMasker.prototype=new AbstractSplitMasker;DateTimeMasker.enShortMonth=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];DateTimeMasker.enLongMonth=["January","February","March","April","May","June","July","August","September","October","November","December"];DateTimeMasker.prototype.formatMeta=null;function DateTimeMasker(formatMeta){this.formatMeta=formatMeta;};DateTimeMasker.prototype.doOne=function(express){if(express.length==0) return new "";var obj=new Object;if(express=="yyyy"){obj.getValue=function(o){return DateTimeMasker.getyyyy(o);};}if(express=="yy"){obj.getValue=function(o){return DateTimeMasker.getyy(o);};}if(express=="MMMM"){obj.getValue=function(o){return DateTimeMasker.getMMMM(o);};}if(express=="MMM"){obj.getValue=function(o){return DateTimeMasker.getMMM(o);};}if(express=="MM"){obj.getValue=function(o){return DateTimeMasker.getMM(o);};}if(express=="M"){obj.getValue=function(o){return DateTimeMasker.getM(o);};}if(express=="dd"){obj.getValue=function(o){return DateTimeMasker.getdd(o);};}if(express=="d"){obj.getValue=function(o){return DateTimeMasker.getd(o);};}if(express=="hh"){obj.getValue=function(o){return DateTimeMasker.gethh(o);};}if(express=="h"){obj.getValue=function(o){return DateTimeMasker.geth(o);};}if(express=="mm"){obj.getValue=function(o){return DateTimeMasker.getmm(o);};}if(express=="m"){obj.getValue=function(o){return DateTimeMasker.getm(o);};}if(express=="ss"){obj.getValue=function(o){return DateTimeMasker.getss(o);};}if(express=="s"){obj.getValue=function(o){return DateTimeMasker.gets(o);};}if(express=="HH"){obj.getValue=function(o){return DateTimeMasker.getHH(o);};}if(express=="H"){obj.getValue=function(o){return DateTimeMasker.getH(o);};}if(express=="t"){obj.getValue=function(o){return DateTimeMasker.gett(o);};}if(express=="st"){obj.getValue=function(o){return DateTimeMasker.gets(o)+DateTimeMasker.gett(o);};}if(express=="mt"){obj.getValue=function(o){return DateTimeMasker.getm(o)+DateTimeMasker.gett(o);};}if(express=="yyyyMMdd"){obj.getValue=function(o){return DateTimeMasker.getyyyy(o)+DateTimeMasker.getMM(o)+DateTimeMasker.getdd(o);};}if(typeof(obj.getValue)=="undefined"){obj.getValue=function(o){return DateTimeMasker.getyyyy(o)+"-"+DateTimeMasker.getMM(o)+"-"+DateTimeMasker.getdd(o);};}return obj;};DateTimeMasker.getyyyy=function(date){return date.getFullYear();};DateTimeMasker.getyy=function(date){return (""+date.getFullYear()).substring(2);};DateTimeMasker.getM=function(date){return ""+(date.getMonth()+1);};DateTimeMasker.getMM=function(date){var month=date.getMonth()+1;if(month<10) return "0"+month;return month;};DateTimeMasker.getMMM=function(date){return this.enShortMonth[date.getMonth()];};DateTimeMasker.getMMMM=function(date){return this.enLongMonth[date.getMonth()];};DateTimeMasker.getdd=function(date){var day=date.getDate();if(day<10) return "0"+day;return date.getDate()+"";};DateTimeMasker.getd=function(date){return date.getDate()+"";};DateTimeMasker.gethh=function(date){var hh=date.getHours();if(hh<10) return "0"+hh;return (date.getHours())+"";};DateTimeMasker.geth=function(date){return (date.getHours())+"";};DateTimeMasker.getHH=function(date){var HH=date.getHours();if(HH>=12) HH=HH-12;if(HH<10) return "0"+HH;return (HH)+"";};DateTimeMasker.getH=function(date){var HH=date.getHours();if(HH>=12) HH=HH-12;return (HH)+"";};DateTimeMasker.getmm=function(date){var mm=date.getMinutes();if(mm<10) return "0"+mm;return (date.getMinutes())+"";};DateTimeMasker.getm=function(date){return ""+(date.getMinutes());};DateTimeMasker.getss=function(date){var ss=date.getSeconds();if(ss<10) return "0"+ss;return (ss)+"";};DateTimeMasker.gets=function(date){return (date.getSeconds())+"";};DateTimeMasker.gett=function(date){var hh=date.getHours();if(hh<=12) return "AM";else return "PM";};DateTimeMasker.prototype.getExpress=function(){return this.formatMeta.format;};DateTimeMasker.prototype.getReplaceds=function(){return [" ",this.formatMeta.speratorSymbol,":"];};DateTimeMasker.prototype.getSeperators=function(){return ["(\\s)+?","-",":"];};DateTimeMasker.prototype.getVarElement=function(express){return this.doOne(express);};DateTimeMasker.prototype.formatArgument=function(obj){if (obj==0) return "";if(obj==null || obj=="") return obj;if((typeof obj)=="string"){var dateArr=obj.split(" ");if(dateArr.length>0){var arr0=dateArr[0].split("-");var date=new Date();date.setDate(1);date.setFullYear(parseInt(arr0[0],10));date.setMonth(parseInt(arr0[1],10)-1);date.setDate(parseInt(arr0[2],10));if(dateArr.length==2&&dateArr[1] !=undefined){var arr1=dateArr[1].split(":");date.setHours(parseInt(arr1[0],10));date.setMinutes(parseInt(arr1[1],10));date.setSeconds(parseInt(arr1[2],10));if(arr1.length>3) date.setMilliseconds(parseInt(arr1[3],10));}}return date;}return (obj);};DateMasker.prototype=new DateTimeMasker;function DateMasker(formatMeta){this.formatMeta=formatMeta;};TimeMasker.prototype=new DateTimeMasker;function TimeMasker(formatMeta){this.formatMeta=formatMeta;};PrecentMasker.prototype=new AbstractMasker;function PrecentMasker(){};PrecentMasker.prototype.formatArgument=function(obj){return obj;};PrecentMasker.prototype.innerFormat=function(obj){var val="";if(obj !=""){var objStr=String(obj);var objPrecision=objStr.length-objStr.indexOf(".")-1;var showPrecision=objPrecision-2;if(showPrecision<0){showPrecision=0;}val=parseFloat(obj)*100;val=(val*Math.pow(10,showPrecision)/Math.pow(10,showPrecision)).toFixed(showPrecision);val=val+"%";}return{value:val};};
function toColorfulString(result){var color;if (!result){return '';}if (result.color==null){return result.value;}color=result.color;return '<font color="'+color+'">'+result.value+'<\/font>';};StringElement.prototype=new Object();function StringElement(value){this.value=value;};StringElement.prototype.value="";StringElement.prototype.getValue=function(obj){return this.value;};FormatResult.prototype=new Object ;function FormatResult(value,color){this.value=value;this.color=color;};
function Application(){this.pageUIMap={};}Application.prototype.addPageUI=function(id,pageUI){this.pageUIMap[id]=pageUI;};Application.prototype.getPageUI=function(id){var pageUI=this.pageUIMap[id];if(pageUI==null) pageUI=getPopParent().pageUI;return pageUI;};function getApplication(){if(window.application==null) window.application=new Application();return window.application;};function getService(sName){var service=new ServiceProxy(sName);return service;};function ServiceProxy(sName){this.name=sName;};ServiceProxy.prototype.execute=function(method,args){var obj={};obj.rpcname=this.name;obj.method=method;for(var i=1;i<arguments.length;i++){obj["params"+(i-1)]=arguments[i];}var data=toJSON(obj);var ajax=new Ajax();ajax.setPath(getCorePath()+"/rpc");ajax.setQueryStr("rpcdata="+data);ajax.setReturnFunc(ServiceProxy.$returnFun);var innerArgs=[ null,null,ajax ];ajax.setReturnArgs(innerArgs);return ajax.post(false);};ServiceProxy.$returnFun=function(xmlHttpReq,returnArgs,exception){var ajaxObj=returnArgs[2];var returnFunc=returnArgs[1];var userArgs=returnArgs[0];var text=xmlHttpReq.responseText;try{eval("var obj = "+text+";");}catch(er ){eval("var obj = '"+text+"';");}return obj;};var ServerSet={sign:{saveLog:function (){return getService("uap.lfw.sign.itf.ISignService");}}};function getFormularService(){return getService("nc.uap.lfw.core.model.formular.IEditFormularService");};function getFileService(){return getService("uap.lfw.file.comp.IFileService");};function getParamsMap(){return window.$paramsMap;};function getParameter(key){var value=window.$paramsMap.get(key);return value==null ? null:decodeURIComponent(value);};function setParameter(key,value){var param=null;if (typeof key==='string') window.$paramsMap.put(key,value);else if (typeof key==='object'){param=key;window.$paramsMap.put(param.key,param.value);}};function getSessionAttributeMap(){if (typeof $cs_clientSession !="undefined") return $cs_clientSession.map;};function setSessionAttribute(key,value){$cs_clientSession.map[key]=value;};function getSessionAttribute(key){if (typeof $cs_clientSession !="undefined") return $cs_clientSession.map[key];};function getStickString(){return window.$cs_clientStickKeys;};function getStorageData(){if (window.localStorage==null || window.usercode==null) return null;if (window.$sd_storageData !=null) return window.$sd_storageData;else{if (window.localStorage.getItem(window.usercode)==null){try{window.localStorage.setItem(window.usercode,"{}");}catch(e){return null;}}var storageDataStr=window.localStorage.getItem(window.usercode);if(typeof(JSON)=="undefined") window.$sd_storageData=eval("("+storageDataStr+")");else window.$sd_storageData=JSON.parse(storageDataStr);return window.$sd_storageData;}};function saveStorageData(){if (window.$sd_storageData==null || window.localStorage==null || window.usercode==null) return;var storageDataStr=JSON.stringify(window.$sd_storageData);try{window.localStorage.setItem(window.usercode,storageDataStr);}catch(e){}};EventUtil.addEventHandler(window,"unload",winunload);function winunload(){if (window.pageUI==null) return;window.pageUI.$onClosed();if (typeof $.scrollBarDestroy=='function') $.scrollBarDestroy();removeAllComponent();};function getMasker(type){if (type !=null) type=type.toUpperCase();if(typeof window.$maskerMeta !="undefined"&&((typeof IntegerTextComp !="undefined"&&type==IntegerTextComp.prototype.componentType) ||(typeof FloatTextComp !="undefined"&&(type==FloatTextComp.prototype.componentType || EditorType.DECIMALTEXT.toUpperCase()==type)) ||(typeof MoneyTextComp !="undefined"&&type==MoneyTextComp.prototype.componentType))){return new NumberMasker(window.$maskerMeta.NumberFormatMeta);}if(typeof window.$maskerMeta !="undefined"&&typeof DateTextComp !="undefined"&&type==DateTextComp.prototype.componentType){return new DateMasker(window.$maskerMeta.DateFormatMeta);}if(typeof window.$maskerMeta !="undefined"&&type=="DATETIMETEXT"){return new DateTimeMasker(window.$maskerMeta.DateTimeFormatMeta);}if(typeof PrecentTextComp !="undefined"&&type==PrecentTextComp.prototype.componentType){return new PrecentMasker();}return null;}function getPageId(){return getSessionAttribute("pageId");};function getPageUniqueId(){return getSessionAttribute("pageUniqueId");};function getAppUniqueId(){return getSessionAttribute("appUniqueId");};function getRootPath(){return window.globalPath;};function getCorePath(){return window.corePath;};function getNodePath(){return window.globalPath+"/html/nodes/"+window.$pageId;};if (!IS_IE){Element.prototype.selectNodes=function(xPath){var evaluator=new XPathEvaluator();var nodeList=evaluator.evaluate(xPath,this,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);var nodes=new Array();if (nodeList !=null){var node=nodeList.iterateNext();while (node){nodes.push(node);node=nodeList.iterateNext();}}return nodes;};Element.prototype.selectSingleNode=function(xPath){var evaluator=new XPathEvaluator();var oResult=evaluator.evaluate(xPath,this,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if (oResult !=null){var node=oResult.iterateNext();return node;}else{return null;}};};function createXmlDom(strXML){if (window.ActiveXObject){var sigArr=[ "MSXML2.DOMDocument.5.0","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","Microsoft.XmlDom"];for ( var i=0;i<sigArr.length;i++){try{var xmlDom=new ActiveXObject(sigArr[i]);xmlDom.async=false;xmlDom.loadXML(strXML);return xmlDom;}catch (error){}}}else if (document.implementation&&document.implementation.createDocument){return new DOMParser().parseFromString(strXML,"text/xml");}else{throw new Error("Your browser doesn't support an XML DOM object.");}};function showProgressDialog(message,attachComp){var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();topWin.ProgressDialogComp.showDialog(message);};function hideProgressDialog(){ProgressDialogComp.hideDialog();};function showErrorDialog(msg,func,title,okText){var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();topWin.require('errordialog',function(){var dialog=topWin.ErrorDialogComp.showDialog(msg,title,okText,func);});};function hideErrorDialog(){ErrorDialogComp.hideDialog();};function showWarningDialog(msg){var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();return topWin.WarningDialogComp.showDialog(msg);};function hideWarningDialog(){WarningDialogComp.hideDialog();};function hideMessageDialog(){MessageDialogComp.hideDialog();};function openWindowInCenter(url,title,height,width){if(!url){return;}if(url.indexOf("?")>0){url=url+"&lrid="+Math.UUID();}else{url=url+"?lrid="+Math.UUID();}var bodyWidth=window.screen.availWidth;var bodyHeight=window.screen.availHeight;var left=0;if(typeof (width)=='number'|| width.indexOf("%")==-1){var intWidth=parseInt(width);left=bodyWidth>intWidth ? (bodyWidth-intWidth)/2:0;width+="px";}else if(width.indexOf("%")>-1){var decimal=width.substring(0,width.indexOf("%"))/100;width=parseInt(bodyWidth*decimal)+"px";}else{width="800px";}var top=0;if(typeof (height)=='number'|| height.indexOf("%")==-1){var intHeight=parseInt(height);top=bodyHeight>intHeight ? (bodyHeight-intHeight)/2:0;height+="px";}else{height=bodyHeight+"px";}window.showModalDialog(url,self,"status:no;dialogHeight:"+height+";dialogWidth:"+width+";dialogLeft:"+left+"px;dialogTop:"+top+"px");};function openNormalWindowInCenter(url,title,height,width,closeParent){if(!url){return;}if(url.indexOf("?")>0){url=url+"&lrid="+Math.UUID();}else{url=url+"?lrid="+Math.UUID();}var bodyWidth=window.screen.availWidth;var bodyHeight=window.screen.availHeight;if(isPercent(width)) width=bodyWidth*parseFloat(width)/100;if(isPercent(height)) height=bodyHeight*parseFloat(height)/100;var left=bodyWidth>width ? (bodyWidth-width)/2:0;var top=bodyHeight>height ? (bodyHeight-height)/2:0;var win=window.open(url,"","modal=yes, height="+height+", width="+width+", left="+left+", top="+top,true);if(closeParent){if(win==window) return;closeWinWithNoWarn();}};function showMaxWin(url,title,closeParent){if(!url){return;}if(url.indexOf("?")>0){url=url+"&lrid="+Math.UUID();}else{url=url+"?lrid="+Math.UUID();}var win=window.open(url,title,'resizable=no,scrollbars=yes');win.moveTo(-4,-4);var width=screen.availWidth+8;var height=screen.availHeight+7;win.resizeTo(width,height);if(closeParent){if(win==window) return;closeWinWithNoWarn();}};function closeWinWithNoWarn(){var browserName=navigator.appName;if(IS_IE || IS_WEBKIT){window.opener=null;window.open('','_self');window.close();}else{window.open('','_parent','');window.close();}};function sendRedirect(url,funcCode){if (getProxyReturnExecuting()>0 || getProxyArray().length>0 ){if (isNull(funcCode)) setTimeout("sendRedirect(' "+url+"')",100);else setTimeout("sendRedirect(' "+url+"', '"+funcCode+"')",100);return;}if (isNull(funcCode)) window.location.href=url;else{try{var topWin=getLfwTop();if (topWin !=null){topWin.MFSendRedirect(url,funcCode);}else window.location.href=url;}catch(e){window.location.href=url;}}};function showWin(pageUrl,width,height){var pos=pageUrl.indexOf("?");var randId=(Math.random()*10000).toString().substring(0,4);if (pos==-1) pageUrl+="?randid="+randId;else pageUrl+="&randid="+randId;pageUrl=pageUrl+"&lrid="+Math.UUID();if (width==null || width=="") width=parseInt(window.screen.width)-200;if (height==null || height=="") height=parseInt(window.screen.height)-300;window.showModalDialog(pageUrl,self,"dialogHeight:"+height+"px;dialogWidth:"+width+"px;center:yes;resizable:yes;status:no");};function showDialog(pageUrl,title,width,height,id,refDiv,attr,twin){if(title){title=title.replaceAll(" ","&nbsp;");}if (showDialog.dialogCount==null) showDialog.dialogCount=0;if (showDialog.dialogsTrueParent==null) showDialog.dialogsTrueParent=new Array();var dialogName="$modalDialog"+showDialog.dialogCount;if (id==null) id="";var nowWidth=document.body.clientWidth;var nowHeight=document.body.clientHeight;var topwin=getLfwTop();if(topwin !=null){var topWidth=getLfwTop().document.body.clientWidth;var topHeight=getLfwTop().document.body.clientHeight;}else{var topWidth=nowWidth;var topHeight=nowHeight;}if(width==null) width=400;if(height==null) height=300;var oriWidth=width;var oriHeight=height;if(!isPercent(width)&&width<0) width=nowWidth+width;if(!isPercent(width)&&width>topWidth) width=topWidth;if (!isPercent(height)&&height<0) height=nowHeight+height;if(!isPercent(height)&&height>topHeight) height=topHeight;if(title=='null') title=null;twin=(twin==null ? window:twin);if (showDialog.dialogsTrueParent==null) showDialog.dialogsTrueParent=new Object();var topwin=getLfwTop();if(topwin !=null&&topwin !=window){return topwin.showDialog(pageUrl,title,width,height,id,null,attr,twin);}if (((!isPercent(width)&&nowWidth<(width-40)) || (!isPercent(height)&&nowHeight<(height-40)))&&(window !=top&&parent.showDialog !=null)){showDialog.showInParent=true;if (parent.showDialog.dialogCount==null) parent.showDialog.dialogCount=0;return parent.showDialog(pageUrl,title,width,height,id,null,attr,twin);}else{if (twin.isPopView&&twin.isPopView==true) showDialog.dialogsTrueParent[showDialog.dialogCount]=twin.getTrueParent();else showDialog.dialogsTrueParent[showDialog.dialogCount]=twin;}var isShowLine=true;var isConfirmClose=false;if(attr){isShowLine=getBoolean(attr.isShowLine,isShowLine);isConfirmClose=getBoolean(attr.isConfirmClose,isConfirmClose);}var topWidth=window.document.body.clientWidth;var topHeight=window.document.body.clientHeight;if (window[dialogName]==null){window[dialogName]=new ModalDialogComp("g_modalDialog",title,0,0,width,height,null,{"isShowLine":isShowLine});}else{window[dialogName].setSize(width,height);window[dialogName].setTitle(title);window[dialogName].showLine(isShowLine);}window[dialogName].oriHeight=oriHeight;window[dialogName].oriWidth=oriWidth;window[dialogName].onAfterClose=function(){destroyDialog(dialogName);};if(isConfirmClose){var dls=new Listener("beforeClose");dls.source_id=dialogName;dls.listener_id='onBeforeClose_'+dialogName;dls.func=function (){if (window["$modalDialogFrame"+id]==null || typeof (window["$modalDialogFrame"+id].contentWindow)=="unknown") return;if(window["$modalDialogFrame"+id].contentWindow==null) return;var pageui=window["$modalDialogFrame"+id].contentWindow.pageUI;if(pageui&&window[dialogName]) return pageui.showCloseConfirm(window[dialogName]);};window[dialogName].addListener(dls);}var iframe=$ce("iframe");iframe.name="in_frame";iframe.id="in_frame";iframe.allowTransparency="true";iframe.frameBorder=0;iframe.style.width="100%";iframe.style.height="100%";if(!IS_IPAD){iframe.style.position="absolute";iframe.style.left="0px";}window["$modalDialogFrame"+id]=iframe;window[dialogName].getContentPane().appendChild(iframe);window[dialogName].dialogId=id;var reload=false;if(pageUrl !=null&&pageUrl !="") iframe.src=pageUrl;else{if(window.domain_key !=null) iframe.src="/lfw/setdomain.jsp";}window[dialogName].closeBt.style.visibility="hidden";window[dialogName].show(refDiv);showDialogColseIcon(id,dialogName);showDialog.dialogCount++;document.modalDialog=window[dialogName];if (!IS_IE7) document._pt_frame_id=iframe.id;return [window[dialogName],iframe];};function canDestroyDialog(frame){try{if (frame&&frame.contentWindow.ServerProxy&&(frame.contentWindow.getProxyReturnExecuting()>0 || frame.contentWindow.getProxyArray().length>0 )) return false;if(typeof frame.contentWindow.getTrueParent=='function'){var parent=frame.contentWindow.getTrueParent();if (parent !=null&&parent.ServerProxy&&(parent.getProxyReturnExecuting()>0 || parent.getProxyArray().length>0)) return false;}return true;}catch(e){return true;}};function destroyDialog(dialogName){if (dialogName==null) return;var dialog=window[dialogName];if (dialog==null) return;var frame=dialog.getContentPane().firstChild;if (frame==null) return;var canDestroy=canDestroyDialog(frame);if (canDestroy==false){setTimeout("destroyDialog('"+dialogName+"')",100);return;}var id=dialog.dialogId;var dialog=getDialog(id);if (dialog){try{var frame=dialog.getContentPane().firstChild;if(frame.contentWindow.handleClose){frame.contentWindow.handleClose();}frame.src="";frame.isDestroy=true;window["$modalDialogFrame"+id]=null;showDialog.dialogsTrueParent[showDialog.dialogCount]=null;dialog.getContentPane().removeChild(frame);}catch(e){};dialog=null;}};function lazyRender(){var iframe=lazyRender.iframe;var templateStr=lazyRender.templateStr;try{lazyRender.iframe=null;lazyRender.templateStr=null;iframe.contentWindow.document;}catch(error){lazyRender.iframe=iframe;lazyRender.templateStr=templateStr;setTimeout("lazyRender()",100);return;}iframe.contentWindow.document.write(templateStr);}function showDialogColseIcon(id,dialogName,count){if (count==null) count=1;if (window["$modalDialogFrame"+id] !=null){if(count>=10){window[dialogName].closeBt.style.visibility="";return;}try{window["$modalDialogFrame"+id].contentWindow.renderDone;}catch(error){count+=1;setTimeout("showDialogColseIcon('"+id+"', '"+dialogName+"',"+count+")",100);return;}if(window["$modalDialogFrame"+id].contentWindow.renderDone==true || count>=10) window[dialogName].closeBt.style.visibility="";else{count+=1;setTimeout("showDialogColseIcon('"+id+"', '"+dialogName+"',"+count+")",100);}}else{count+=1;setTimeout("showDialogColseIcon('"+id+"', '"+dialogName+"',"+count+")",100);}}function hideDialog(id,hideImmediate){if ((hideImmediate==null ||hideImmediate==false)){if(typeof(id) !='undefined'&&id !=null){setTimeout("hideDialog('"+id+"', true)",100);}else{setTimeout("hideDialog(null, true)",100);}return;}var dialog=getDialog(id);if (dialog){var frame=dialog.getContentPane().firstChild;if (frame&&frame.contentWindow.ServerProxy&&(frame.contentWindow.getProxyReturnExecuting()>0 || frame.contentWindow.getProxyArray().length>0 )){if(typeof(id) !='undefined'&&id !=null){setTimeout("hideDialog('"+id+"')",100);}else{setTimeout("hideDialog()",100);}return;}dialog.close();}};function getDialog(id){for (var i=showDialog.dialogCount-1;i>=0;i--){var dialogName="$modalDialog"+i;var dialog=window[dialogName];if (dialog==null) continue;var frm=null;if (dialog.getContentPane) frm=dialog.getContentPane().firstChild;if (frm==null || (frm.isDestroy !=null&&frm.isDestroy==true) ) continue;if (typeof(id)=='undefined'|| id==null) return dialog;if (dialog.dialogId==null) continue;if (dialog.dialogId==id) return dialog;}return null;};function closeWindow(){if (window.ServerProxy&&window.getProxyReturnExecuting()>0){setTimeout("closeWindow()",100);return;}try{window.close();}catch(e){}};function getCurrentDialog(isOpen){var dialogName=null;if (isOpen==null || isOpen==false) dialogName="$modalDialog"+(showDialog.dialogCount);else dialogName="$modalDialog"+(showDialog.dialogCount-1);return window[dialogName];};function parentHideDialog(id){if (window.opener&&window.opener !=window){if (window.ServerProxy&&(window.getProxyReturnExecuting()>0 || window.getProxyArray().length>0 )){setTimeout("parentHideDialog()",100);return;}window.close();}else if(parent.hideDialog) parent.hideDialog(id);}function getTrueParent(){if (parent==window){if (window.opener&&window.opener !=window) return window.opener;else return window;}if(parent.showDialog){if (parent.showDialog.dialogsTrueParent==null) return parent;else{for (var i=parent.showDialog.dialogCount-1;i>=0;i--){dialogName="$modalDialog"+i;dialog=parent[dialogName];if (dialog==null) continue;var frame=parent["$modalDialogFrame"+dialog.dialogId];if (frame !=null&&frame.contentWindow !=null&&frame.contentWindow==window){return parent.showDialog.dialogsTrueParent[i] !=null ? parent.showDialog.dialogsTrueParent[i]:parent;}}return parent;}}else{if (parent.pageUI) return parent;else return window;}};function getLfwTop(){if (window.lfwtop){window.lfwtopwin=window;return window.lfwtopwin;}var parentWin=window;window.hasShowDialogWin=window;try{parentWin.parent.document;parentWin=parentWin.parent;while(parentWin !=null&&parentWin !=window){if(parentWin.showDialog) window.hasShowDialogWin=parentWin;if(parentWin.lfwtop){window.lfwtopwin=parentWin;break;}if(parentWin==parentWin.parent) break;parentWin.parent.document;parentWin=parentWin.parent;}}catch(error){}if(window.lfwtopwin) return window.lfwtopwin;return window.hasShowDialogWin;};function getPopParent(){if(window.parentWindow !=null) return window.parentWindow;try{if (window.parent !=window) return getTrueParent();if (window.dialogArguments !=null&&window.parent.dialogArguments==window.dialogArguments) return window.dialogArguments;if (window.opener) return window.opener;}catch(error){return null;}};window.parentWindow=getPopParent();function compress(content){if(window.debugMode==true){return null;}var top=getLfwTop();if(top==null) return null;if(top.compressContent){var result=top.compressContent(content);return result;}return null;}function getAppTopWindow(){var wid=getPopParent();var appTopWid=wid.parent;return appTopWid;}function showCommonDialog(pageUrl,title,width,height,id){if (id==null) id="";if(!pageUrl){return;}if(pageUrl.indexOf("?")>0){pageUrl=pageUrl+"&lrid="+Math.UUID();}else{pageUrl=pageUrl+"?lrid="+Math.UUID();}var returnValue=showModalDialog(pageUrl,window,"dialogWidth:"+width+";dialogHeight:"+height+";status:0;help:0;");return returnValue;};function handleException(xmlHttpReq,exception,ajaxArgs,ajaxObj){var doc=xmlHttpReq.responseXML;return handleExceptionByDoc(doc,exception,ajaxArgs,ajaxObj,xmlHttpReq);};function openLoginPage(){var url=window.globalPath+"/app/mockapp/login.jsp&randid="+(new Date()).getTime();if (window.top !=window){var parentPage=parent;while (parentPage){if (parentPage==parentPage.parent) break;parentPage=parentPage.parent;}if (parentPage) parentPage.location.href=url;}else{window.location.href=url;}};function handleExceptionByDoc(doc,exception,ajaxArgs,ajaxObj,xmlHttpReq){if (exception){if (xmlHttpReq !=null&&xmlHttpReq.status==306){openLoginPage();}else{showErrorDialog(exception);}return false;}if(doc==null) return;var rootNode=doc.documentElement;if (rootNode==null) return;var successNode=rootNode.selectSingleNode("success");if(successNode==null) return;var success=successNode.firstChild.nodeValue;if (success=="false"){var expTextNode=rootNode.selectSingleNode("exp-text");var expStackNode=rootNode.selectSingleNode("exp-stack");var showMessageNode=rootNode.selectSingleNode("show-message");var showTitleNode=rootNode.selectSingleNode("show-title");var expText=expTextNode.firstChild==null ? "":expTextNode.firstChild.nodeValue;if (IS_IE) expStack=expStackNode.firstChild.nodeValue;else expStack=expStackNode.firstChild.nextSibling.data;var showMessage=showMessageNode.firstChild==null ? "error occurred":showMessageNode.firstChild.nodeValue;var showTitle=null;if (showTitleNode) showTitle=showTitleNode.firstChild==null ? null:showTitleNode.firstChild.nodeValue;showErrorDialog(showMessage,null,showTitle,null);return false;}else if (success=="validator"){var expNode=rootNode.selectSingleNode("exp-text");var expText=null;if(expNode){expText=expNode.firstChild.nodeValue;}var expView=changeNodeToObject(rootNode.selectSingleNode("exp-view"));expNode=rootNode.selectSingleNode("exp-components");if(expNode){var exceptionMsg=null;var exp_children=expNode.childNodes;if(exp_children&&exp_children.length>0){for(var k=0;k<exp_children.length;k++){var expComponent=changeNodeToObject(exp_children[k]);if(exp_children[k]){expComponent.elements=new Array();var children=exp_children[k].childNodes;if(children&&children.length>0){for(var i=0;i<children.length;i++){var element=changeNodeToObject(children[i]);if(typeof(element.id) !='undefined'){expComponent.elements.push(element);}}}}if(typeof(expView.id)=="string"&&typeof(expComponent.id)=="string"){var widget=pageUI.getWidget(expView.id);if(widget){var component=widget.getComponent(expComponent.id);if(component){if(component.componentType=="AUTOFORM"){if(component.errorMsg&&expComponent.errorMsg){component.errorMsg.innerHTML=expComponent.errorMsg;component.setWholeErrorPosition();component.errorMsgDiv.style.display="block";}var index="";if(component.dataset){if(component.dataset.focusRowIndex) index="_"+component.dataset.focusRowIndex;}var eleArr=component.eleArr;if(eleArr&&eleArr.length>0){var element;for(var i=0;i<eleArr.length;i++){element=eleArr[i];if(typeof(element)=="object"){for(var j=0;j<expComponent.elements.length;j++){if(expComponent.elements[j].id==(element.id+index)){if(typeof(element.setError)=='function'){element.setError(true);}if(typeof(element.setErrorMessage)=='function'){element.setErrorMessage(expComponent.elements[j].errorMsg);}if(typeof(element.setErrorStyle)=='function'){element.setErrorStyle();}if(typeof(element.setErrorPosition)=='function'){element.setErrorPosition();}break;}}}}}}else if(component.componentType=="GRIDCOMP"){if(component.errorMsg&&expComponent.errorMsg){component.errorMsg.innerHTML=expComponent.errorMsg;component.setWholeErrorPosition();component.errorMsgDiv.style.display="block";}var eleArr=component.basicHeaders;if(eleArr&&eleArr.length>0){var cell=null;for(var i=0;i<eleArr.length;i++){for(var j=0;j<expComponent.elements.length;j++){if(eleArr[i].isHidden==false&&expComponent.elements[j].id.split("_")[0]==eleArr[i].keyName){if(eleArr[i].dataDiv.cells.length==1){cell=eleArr[i].dataDiv.cells[0];}else{if(expComponent.elements[j].id.split("_").length>1){cell=eleArr[i].dataDiv.cells[expComponent.elements[j].id.split("_")[1]];}else{cell=eleArr[i].dataDiv.cells[0];}}var warningIcon=cell.warningIcon;if(typeof(warningIcon)=='undefined'){warningIcon=$ce("DIV");warningIcon.className="cellwarning";cell.warningIcon=warningIcon;cell.style.position="relative";}cell.appendChild(warningIcon);if (typeof(cell.errorMsg)=="string"&&cell.errorMsg !=""){warningIcon.style.display="block";}else{warningIcon.style.display="none";}}}}}}else{var element=component;if(typeof(element.setError)=='function'){element.setError(true);}if(typeof(element.setErrorMessage)=='function'){element.setErrorMessage(trans("ml_thisfieldcannotnull"));}if(typeof(element.setErrorStyle)=='function'){element.setErrorStyle();}if(typeof(element.setErrorPosition)=='function'){element.setErrorPosition();element.noShowErrorMsgDiv=true;}if(expComponent.errorMsg){exceptionMsg=expComponent.errorMsg;}}}else{}}else{}}}}if(typeof(exceptionMsg)=="string"){showErrorDialog(exceptionMsg);}}return false;}else if (success=="interaction"){proxyReturnExecutingAdd();var rootNode=doc.documentElement;var contentsNode=rootNode.selectSingleNode("contents");var contentNodes=contentsNode.selectNodes("content");var content=getNodeValue(contentNodes[0]);eval("var interationInfo = "+content);rePostReq.dialogId=interationInfo.id;if(interationInfo.type=="OKCANCEL_DIALOG"){var msg=interationInfo.msg;var title=interationInfo.title;var okText=interationInfo.okText;var cancelText=interationInfo.cancelText;rePostReq.ajaxObj=ajaxObj.clone();showConfirmDialog(msg,rePostOk,rePostCancel,null,null,null,okText,cancelText,title);}else if(interationInfo.type=="THREE_BUTTONS_DIALOG"){var msg=interationInfo.msg;var title=interationInfo.title;rePostReq.ajaxObj=ajaxObj.clone();var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();topWin.require("threebuttondialog",function(){topWin.ThreeButtonsDialog.showDialog(msg,rePostOk,rePostCancel,rePostMiddle,interationInfo.btnTexts,null,null,null,null,null,title)});}else if (interationInfo.type=="MESSAGE_DIALOG"){var msg=interationInfo.msg;var title=interationInfo.title;var btnText=interationInfo.btnText;rePostReq.ajaxObj=ajaxObj.clone();rePostReq.okReturn=interationInfo.okReturn;showMessageDialog(msg,rePostOk,title,btnText,false);}else if (interationInfo.type=="ERROR_MESSAGE_DIALOG"){var msg=interationInfo.msg;var title=interationInfo.title;var btnText=interationInfo.btnText;rePostReq.ajaxObj=ajaxObj.clone();rePostReq.okReturn=interationInfo.okReturn;showErrorDialog(msg,rePostOk,title,btnText);}else if(interationInfo.type=="INPUT_DIALOG"){var items=interationInfo.items;if (items !=null){var title=interationInfo.title;var id=rePostReq.dialogId;ajaxObj=ajaxObj.clone();ajaxObj.addParam(id+"interactflag","true");rePostReq.ajaxObj=ajaxObj;noPostCancel.ajaxObj=ajaxObj;var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();topWin.require("inputdialog",function(){var inputDlg=new topWin.InputDialogComp("input_dialog",title,0,0,null,null,null,rePostReq,noPostCancel);rePostReq.inputDlg=inputDlg;for (var i=0;i<items.length;i++){var item=items[i];var inputId=item.inputId;var labelText=item.labelText;var inputType=item.inputType;var required=item.required;var value=item.value;if (inputType=="string"|| inputType=="pswtext"){inputDlg.addItem(labelText,inputId,inputType,required,null,value);}else if (inputType=="int"){var attr=new Object;attr.minValue=item.minValue;attr.maxValue=item.maxValue;inputDlg.addItem(labelText,inputId,inputType,required,attr,value);}else if(inputType=="combo"){if (item.comboData){var datas=item.comboData.allCombItems;var comboData=new topWin.ComboData();var attr=new Object;attr.selectOnly=item.selectOnly;var combData=new topWin.ComboData();for(var j=0;j<datas.length;j++){var text=datas[j].text;if(text==null) text=datas[j].i18nName;combData.addItem(new topWin.ComboItem(text,datas[j].value));}attr.comboData=combData;inputDlg.addItem(labelText,inputId,inputType,required,attr,value);}}else if(inputType=="radio"){var datas=item.comboData.allCombItems;var comboData=new topWin.ComboData();var attr=new Object;attr.selectOnly=item.selectOnly;var combData=new topWin.ComboData();for(var j=0;j<datas.length;j++){var text=datas[j].text;if(text==null) text=datas[j].i18nName;combData.addItem(new topWin.ComboItem(text,datas[j].value));}attr.comboData=combData;inputDlg.addItem(labelText,inputId,inputType,required,attr,value);}else if(inputType=="languagecombotext"){var datas=item.comboData.allCombItems;var attr=new Object;attr.comboData=datas;attr.currentLangCode=item.currentLangIndex;attr.defaultLangCode=item.defaultLangIndex;inputDlg.addItem(labelText,inputId,inputType,required,attr,value);}}inputDlg.show();});}}return false;}return true;};function changeNodeToObject(expNode){var expObj=new Object();if(expNode){if(expNode.attributes&&expNode.attributes.length){for(var i=0;i<expNode.attributes.length;i++){if('nodeId'==expNode.attributes[i].nodeName){expObj.id=expNode.attributes[i].nodeValue;}else if('errorMsg'==expNode.attributes[i].nodeName){expObj.errorMsg=expNode.attributes[i].nodeValue;}}}}return expObj;}function rePostOk(){if(rePostReq.okReturn==null || rePostReq.okReturn==true){var ajaxObj=rePostReq.ajaxObj;var id=rePostReq.dialogId;ajaxObj.addParam(id+"interactflag","true");showDefaultLoadingBar();ajaxObj.post();}else{proxyReturnExecutingSub();}rePostReq.okReturn=null;};function rePostMiddle(){if(rePostReq.okReturn==null || rePostReq.okReturn==true){var ajaxObj=rePostReq.ajaxObj;var id=rePostReq.dialogId;ajaxObj.addParam(id+"interactflag","middle");showDefaultLoadingBar();ajaxObj.post();}else{proxyReturnExecutingSub();}rePostReq.okReturn=null;};function rePostCancel(){var ajaxObj=rePostReq.ajaxObj;var id=rePostReq.dialogId;ajaxObj.addParam(id+"interactflag","false");showDefaultLoadingBar();ajaxObj.post();};function noPostCancel(){var ajaxObj=noPostCancel.ajaxObj;if (ajaxObj !=null&&ajaxObj.req_id !=null){for (i=0 ;i<Ajax.REQ_ARRAY.length ;i++){if (Ajax.REQ_ARRAY[i]==ajaxObj.req_id){Ajax.REQ_ARRAY.splice(i,1);break;}}ajaxObj.destroySelf();}proxyReturnExecutingSub();}function rePostReq(){var ajaxObj=rePostReq.ajaxObj;if (rePostReq.inputDlg){var dlg=rePostReq.inputDlg;var itemsMap=dlg.getItems();var resultStr="";var keySet=itemsMap.keySet();for(var i=0,count=keySet.length;i<count;i++){var inputId=keySet[i];var inputComp=itemsMap.get(inputId);if(inputComp.componentType=="LANGUAGECOMBOBOX"){var options=inputComp.getOptions();var optionsLength=options.length;var inputCompValue='';for(var j=0;j<optionsLength;j++){inputCompValue+=options[j].langTip+":"+options[j].value+";";}resultStr+=inputId+"="+inputCompValue;}else{resultStr+=inputId+"="+inputComp.getValue();}if(i !=count-1) resultStr+=",";}ajaxObj.addParam("interactresult",resultStr);var key=rePostReq.dialogId+"interactresult";ajaxObj.addParam(key,resultStr);rePostReq.inputDlg=null;}showDefaultLoadingBar();ajaxObj.post();};function showExceptionDialog(friendMsg,errorMsg,stackMsg){return showErrorDialog(friendMsg);};function hideExceptionDialog(){ExceptionDialog.hideDialog();};function showMessageDialog(msg,func,title,okBtnText,isShowSec){var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();topWin.require("messagedialog",function(){var dialog=topWin.MessageDialogComp.showDialog(msg,title,okBtnText,func,isShowSec);});};function showMessage(title,attr){var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();topWin.require("messagecomp",function(){topWin.MessageComp.showMessage(title,attr)})};function hideMessageDialog(){MessageDialogComp.hideDialog();};function showWarningDialog(msg,func){var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();var dialog=topWin.WarningDialogComp.showDialog(msg);if (func !=null) dialog.onclick=func;return dialog;};function hideWarningDialog(){WarningDialogComp.hideDialog();};function showConfirmDialog(msg,okFunc,cancelFunc,obj1,obj2,zIndex,okText,cancelText,title){var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();topWin.require("confirmdialog",function(){topWin.ConfirmDialogComp.showDialog(msg,okFunc,cancelFunc,obj1,obj2,null,null,okText,cancelText,title)});};function showThreeButtonConfirmDialog(msg,rePostOk,rePostCancel,rePostMiddle,btnTexts,obj1,obj2,obj3,zIndex,another,title){var topWin=getLfwTop();if(topWin==null) topWin=getTrueParent();topWin.require("threebuttondialog",function(){topWin.ThreeButtonsDialog.showDialog(msg,rePostOk,rePostCancel,rePostMiddle,btnTexts,obj1,obj2,obj3,zIndex,another,title)});};function hideConfirmDialog(){ConfirmDialogComp.hideDialog();};function getNodeValue(node){if (IS_IE) return node.text;var firstNode=node.firstChild;if(firstNode==null) return null;var nextSibling=firstNode.nextSibling;if(nextSibling==null) return firstNode.data;return nextSibling.data;};function getNodeAttribute(node,attrName){if (IS_IE) return node.getAttribute(attrName);var attrs=node.attributes;if (attrs==null) return null;for ( var i=0;i<attrs.length;i++){if (attrs[i].nodeName==attrName) return attrs[i].nodeValue;}return null;};function getChildForType(node,type,index){var nodes=node.childNodes;if (nodes==null) return null;var count=-1;for ( var i=0;i<nodes.length;i++){if (nodes[i].nodeName !=null&&nodes[i].nodeName.toLowerCase()==type){count++;if (count==index) return nodes[i];}}return null;};function removeFromArray(arr,ele){if (!arr) return false;for ( var i=0;i<arr.length;i++){if (arr[i]==ele){arr.splice(i,1);return true;}}return false;};function showStatusMsg(msg){window.status=msg;};function getConfigAttribute(key){var value=getConfigFromCookieById(key);if (value !=null) return value;else return getSessionAttribute(key);};function getConfigFromCookieById(key){var allCookie=document.cookie;var pos=allCookie.indexOf("LFW_CONFIG_KEY=");if (pos !=-1){var start=pos+15;var end=allCookie.indexOf(";",start);if (end==-1) end=allCookie.length;var value=allCookie.substring(start,end);var v=value.split("$");if (key=="connectServerCycle") return v[0];else if (key=="theme") return v[1];else if (key=="openNodeMode") return v[2];else if (key=="noticeRefreshCycle") return v[3];else if (key=="jobRefreshCycle") return v[4];}else return null;};function setCookie(sName,sValue,oExpires,sPath,sDomain,bSecure){var sCookie=sName+"="+encodeURIComponent(sValue);if (oExpires) sCookie+="; expires="+oExpires.toGMTString();if (sPath) sCookie+="; path="+sPath;if (sDomain) sCookie+="; domain="+sDomain;if (bSecure) sCookie+="; secure="+bSecure;document.cookie=sCookie;};function getCookie(sName){var sRE="(?:; )?"+sName+"=([^;]*);?";var oRE=new RegExp(sRE);if (oRE.test(document.cookie)){return decodeURIComponent(RegExp["$1"]);}else return null;};function deleteCookie(sName,sPath,sDomain){setCookie(sName,"",new Date(0),sPath,sDomain);}function uploadSuccess(data,targetComp){var comp=getComponent(targetComp);comp.onUploaded(data);};function getFromCache(key){return window.globalObject[key];};function putToCache(key,value){window.globalObject[key]=value;};function removeComponent(compId){var comp=window["$c_"+compId];if (comp){comp.destroySelf();window["$c_"+compId]=null;}};function removeAllComponent(){for ( var i=0;i<window.clickHolders.length;i++){window.clickHolders[i]=null;}if(window.pageUI){pageUI.destroySelf();}for (var i in window.objects){var comp=window.objects[i];if (comp&&comp.destroySelf){comp.destroySelf();}comp=null;}window.objects=null;};function clearNodeProperties(node){for(var i in node){try{node[i]=null;}catch(error){}}}function clearHtmlNodeProperties(node){if(node !=null){var nodeName=node.nodeName;if(nodeName=="IMG"|| nodeName=="img"){return;}try{node.onclick=null;node.onmouseover=null;node.keypress=null;node.onfocus=null;node.onblur=null;node.owner=null;}catch(error){}}}function clearEvent(event){try{for (var i in event){if (i=="type"|| i=="eventPhase"|| i=="bubbles"|| i=="cancelable"|| i=="timeStamp"|| i=="which"|| i=="rangeParent"|| i=="rangeOffset"|| i=="pageX"|| i=="pageY"|| i=="isChar"|| i=="getPreventDefault"|| i=="screenX"|| i=="screenY"|| i=="clientX"|| i=="clientY"|| i=="ctrlKey"|| i=="shiftKey"|| i=="altKey"|| i=="metaKey"|| i=="button"|| i=="initMouseEvent"|| i=="stopPropagation"|| i=="preventDefault"|| i=="initEvent"|| i=="view"|| i=="detail"|| i=="initUIEvent"|| i=="CAPTURING_PHASE"|| i=="AT_TARGET"|| i=="BUBBLING_PHASE"|| i=="mozPressure"|| i=="initNSMouseEvent"|| i=="explicitOriginalTarget"|| i=="preventBubble"|| i=="preventCapture"|| i=="isTrusted"|| i=="layerX"|| i=="layerY"|| i=="cancelBubble"|| i=="MOUSEDOWN"|| i=="MOUSEUP"|| i=="MOUSEOVER"|| i=="MOUSEOUT"|| i=="MOUSEMOVE"|| i=="MOUSEDRAG"|| i=="CLICK"|| i=="DBLCLICK"|| i=="KEYDOWN"|| i=="KEYUP"|| i=="KEYPRESS"|| i=="DRAGDROP"|| i=="FOCUS"|| i=="BLUR"|| i=="SELECT"|| i=="CHANGE"|| i=="RESET"|| i=="SUBMIT"|| i=="SCROLL"|| i=="LOAD"|| i=="UNLOAD"|| i=="XFER_DONE"|| i=="ABORT"|| i=="ERROR"|| i=="LOCATE"|| i=="MOVE"|| i=="RESIZE"|| i=="FORWARD"|| i=="HELP"|| i=="BACK"|| i=="TEXT"|| i=="ALT_MASK"|| i=="CONTROL_MASK"|| i=="SHIFT_MASK"|| i=="META_MASK"|| i=="SCROLL_PAGE_UP"|| i=="SCROLL_PAGE_DOWN"){continue;}try{event[i]=null;}catch (error){}}}catch (error){}event=null;};function clearEventSimply(event){if(event){if (IS_IE){if (event.originalTarget) event.originalTarget=null;if (event.target) event.target=null;if (event.currentTarget) event.currentTarget=null;if (event.relatedTarget) event.relatedTarget=null;try{event.fromElement=null;}catch (error){}try{event.toElement=null;}catch (error){}try{event.srcElement=null;}catch (error){}}event=null;}};function addCssByStyle(cssString){var doc=document;var style=doc.createElement("style");style.setAttribute("type","text/css");if(style.styleSheet){style.styleSheet.cssText=cssString;}else{var cssText=doc.createTextNode(cssString);style.appendChild(cssText);}var heads=doc.getElementsByTagName("head");if(heads.length) heads[0].appendChild(style);else doc.documentElement.appendChild(style);}function adjustContainerFramesHeight(syncFlag){if (!IS_IE7&&!IS_IE8) syncFlag=true;try{if(!document._pt_frame_id){document._pt_frame_id=getRequest()["$portletWind"]+"_iframe";}if(document._pt_frame_id){var frame=parent.getParentsContainer(document._pt_frame_id);parent.adjustIFramesHeightOnLoad(frame,syncFlag);}else if(parent.document._pt_frame_id){var frame=parent.parent.getParentsContainer(parent.document._pt_frame_id);parent.parent.adjustIFramesHeightOnLoad(frame,syncFlag);}else if(window.opener){if(window.opener.document._pt_frame_id){var frame=window.opener.parent.getParentsContainer(window.opener.document._pt_frame_id);window.opener.parent.adjustIFramesHeightOnLoad(frame,syncFlag);}}}catch (e){}}function restoreContainerFramesHeight(){try{if(document._pt_frame_id){parent.initFrameMiniHeight(document._pt_frame_id);}else if(parent.document._pt_frame_id){parent.parent.initFrameMiniHeight(parent.document._pt_frame_id);}else if(window.opener){if(window.opener.document._pt_frame_id){window.opener.parent.initFrameMiniHeight(window.opener.document._pt_frame_id);}}}catch (e){}}function uploadedExcelFile(result){var proxy=new ServerProxy(null,null,false);var results=result.split(",");proxy.addParam('clc',results[0]);var method=results[3];if(method==null || method=="") method='onUploadedExcelFile';proxy.addParam('m_n',method);proxy.addParam('widget_id',results[2]);proxy.addParam('el','2');proxy.addParam("excel_imp_path",results[1]);proxy.execute();}function sysDownloadFile(url){if (window.sys_DownFileFrame==null){var frm=$ce('iframe');frm.frameborder=0;frm.vspace=0;frm.hspace=0;frm.style.width='1px';frm.style.heigh='0px';frm.style.display='none';window.sys_DownFileFrame=frm;document.body.appendChild(window.sys_DownFileFrame);}window.sys_DownFileFrame.src=url;}function _setOpacity(obj,value){if (document.all){if (value==100){obj.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+value+")";}else{obj.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+value+")";}}else{obj.style.opacity=value/100;}obj.style.opacity=value/100;};var ftTimeOutFunc;function _changeOpacity(startValue,endValue,step,speed,divObj,type){if (divObj.ftTimeOutFunc){clearTimeout(divObj.ftTimeOutFunc);}if(step>0){if(startValue>endValue){return;}}else if(step<0){if(startValue<endValue){if(typeof(type)=='string'){if(type=='display'){divObj.style.display="none";}else if(type=='visibility'){divObj.style.visibility="hidden";}}return;}}else if(step==0){if(startValue>=endValue){if(typeof(type)=='string'){if(type=='display'){divObj.style.display="block";}else if(type=='visibility'){divObj.style.visibility="visible";}}}else{if(typeof(type)=='string'){if(type=='display'){divObj.style.display="none";}else if(type=='visibility'){divObj.style.visibility="hidden";}}}return;}_setOpacity(divObj,startValue);divObj.ftTimeOutFunc=setTimeout( function(){_changeOpacity(startValue+step,endValue,step,speed,divObj,type);},speed);};function fadeInDiv(divObj,step,speed,type){if(typeof(divObj)=="object"){if(typeof(type)=='string'){if(type=='display'){divObj.style.display="block";}else if(type=='visibility'){divObj.style.visibility="visible";}}if(IS_IE&&!IS_STANDARD){return;}if(document.all){divObj.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)";}else{divObj.style.opacity=0;}if(typeof(step) !="number"){step=20;}if(typeof(speed) !="number"){speed=100;}_changeOpacity(0,100,step,speed,divObj,type);}};function fadeOutDiv(divObj,step,speed,type){if(typeof(divObj)=="object"){if(IS_IE&&!IS_STANDARD){if(typeof(type)=='string'){if(type=='display'){divObj.style.display="none";}else if(type=='visibility'){divObj.style.visibility="hidden";}}return;}if(document.all){divObj.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)";}else{divObj.style.opacity=1;}if(typeof(step) !="number"){step=-20;}if(typeof(speed) !="number"){speed=100;}_changeOpacity(100,0,step,speed,divObj,type);}};window.__flash__removeCallback=function(e,f){try{if(e){e[f]=null}}catch(g){}};window.execDynamicScript2RemoveLayout=function(id,type,params){if (!id) return false;var obj=("string"==typeof id) ? $ge(id):id;if (!obj) return false;var parent;if (obj.objType){parent=$ge(obj.id+"_raw");if (parent){obj=parent;parent=obj.parentNode;}}if (!parent){parent=obj.parentNode;}if (parent){parent.removeChild(obj);return true}return false;};window.execDynamicScript2RemovePanel=function(id,type,params){if (!id) return false;var obj=("string"==typeof id) ? $ge(id):id;if (!obj) return false;var parent;if (obj.objType){parent=$ge(obj.id+"_raw");if (parent){obj=parent;parent=obj.parentNode;}}else{parent=obj.parentNode;}if (parent){parent.removeChild(obj);window.layoutInitFunc();return true}return false;};window.execDynamicScript2RemoveComponent=function(id,widgetId,compId,params){if (!id || !widgetId || !compId) return false;var obj=("string"==typeof id) ? $ge(id):id;if (!obj) return false;var parent=obj.parentNode;if (parent){pageUI.getWidget(widgetId).removeComponent(compId);parent.removeChild(obj);return true}return false;};window.execDynamicScript2RemoveFormElement2=function(id,widgetId,formId,feId){if (!id || !widgetId || !formId) return false;var obj=("string"==typeof id) ? $ge(id):id;if (!obj) return false;var parent=obj.parentNode;if (parent){pageUI.getWidget(widgetId).getComponent(formId).removeElementById(feId);parent.removeChild(obj);return true}return false;};window.execDynamicScript2RemoveGridColumn=function(widgetId,gridId,keyName,params){var comp=pageUI.getWidget(widgetId).getComponent(gridId);var header=comp.removeHeader(keyName);comp.paintData();};window.execDynamicScript2RemoveFormElement=function(widgetId,formId,keyName,params){try{var comp=pageUI.getWidget(widgetId).getComponent(formId);comp.removeElementById(keyName);comp.pLayout.paint(true);}catch (e){alert(e);}};function getRequest(url){if(!url) url=location.search;var theRequest=new Object();if (url.indexOf("?") !=-1){var str=url.substring(url.indexOf("?")+1);strs=str.split("&");for(var i=0;i<strs.length;i++){theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);}}return theRequest;};
function execFormula(widgetId,dsId,fieldId){var proxy=new ServerProxy(null,null,false);proxy.addParam('clc','nc.uap.lfw.core.app.LfwAppDefaultController');proxy.addParam('m_n','onFormular');proxy.addParam('widgetId',widgetId);proxy.addParam("dsId",dsId);proxy.addParam("formula_widgetId",widgetId);var sbr=new SubmitRule();var wdRule=new WidgetRule(widgetId);if(dsId){var dsRule=new DatasetRule(dsId,"ds_all_line");wdRule.addDsRule(dsId,dsRule);}sbr.addWidgetRule(widgetId,wdRule);proxy.setSubmitRule(sbr);proxy.addParam("fieldId",fieldId);proxy.execute();}
LoadingBarComp.prototype=new BaseComponent;LoadingBarComp.prototype.componentType="LOADING";LoadingBarComp.ZINDEX="10000";function LoadingBarComp(parent,name,left,top,width,height,position,align,valign,zIndex,className,fixed){if (arguments.length==0) return;this.base=BaseComponent;this.base(name,left,top,width,height);this.parentOwner=parent;this.position=getString(position,"absolute");this.overflow="hidden";this.align=align;this.valign=valign;this.zIndex=getZIndex();this.innerHTML=null;this.visible=false;this.className=getString(className,"panel_div_alpha");this.fixed=getBoolean(fixed,false);this.create();};LoadingBarComp.prototype.create=function(){this.Div_gen=$ce("DIV");this.Div_gen.style.background="url("+window.globalPath+"/frame/themes/images/transparent.gif)";this.Div_gen.id=this.id;if (this.fixed==true){this.positionElement();this.Div_gen.style.width=this.width;this.Div_gen.style.height=this.height;}else{this.Div_gen.style.left="0px";this.Div_gen.style.top="0px";this.Div_gen.style.width="100%";this.Div_gen.style.height="100%";}this.Div_gen.style.position=this.position;this.Div_gen.style.overflow=this.overflow;this.Div_gen.className=this.className;this.Div_gen.style.zIndex=this.zIndex;if (this.parentOwner){if (this.parentOwner.Div_gen){this.parentOwner.Div_gen.appendChild(this.Div_gen);if (this.parentOwner.Div_gen.zIndex !=null&&this.parentOwner.Div_gen.zIndex>this.zIndex) this.zIndex=this.parentOwner.Div_gen.zIndex+1;}else{this.parentOwner.appendChild(this.Div_gen);if (this.parentOwner.zIndex !=null&&this.parentOwner.zIndex>this.zIndex) this.zIndex=this.parentOwner.zIndex+1;}}else{document.body.appendChild(this.Div_gen);}this.imgDiv=$ce("DIV");var img=$ce("IMG");img.style.className="panel_vertical_middle_div";var langCookie=getCookie('LA_K1');if(langCookie !="simpchn") langCookie="english";var imgSrc=window.themePath+"/ui/ctrl/loading/images/loading_"+langCookie+".gif";img.src=imgSrc;this.imgDiv.appendChild(img);this.imgDiv.style.position="absolute";this.imgDiv.style.left="0px";this.imgDiv.style.top="0px";this.imgDiv.style.width="250px";this.imgDiv.style.height="147px";this.imgDiv.style.visibility="hidden";var topWin=getLfwTop();topWin=topWin==null ? window:topWin;if (IS_IE7) topWin=window;topWin.document.body.appendChild(this.imgDiv);this.manageSelf();};LoadingBarComp.prototype.positionElement=function(){if (this.align !=null&&this.align !=""){var parentWidth=0;if (this.parentOwner==null || this.parentOwner==document.body){parentWidth=document.body.clientWidth;}else{if (this.parentOwner.Div_gen !=null){parentWidth=this.parentOwner.Div_gen.offsetWidth;}else{parentWidth=this.parentOwner.style.offsetWidth;}}var left=0;var eleWidth=this.width;if (isPercent(this.width)){left=0;}else if (parentWidth<=parseInt(this.width)) left=0;else{if (this.align=="center"){left=(parentWidth-parseInt(this.width))/2;left=parseInt(left);}else if (this.align=="left"){left=0;}else if (this.align=="right"){left=parentWidth-parseInt(this.width);}}this.Div_gen.style.left=left+"px";}if (this.valign !=null&&this.valign !=""){var parentHeight=0;if (this.parentOwner==null || this.parentOwner==document.body){parentHeight=document.body.clientHeight;}else{if (this.parentOwner.Div_gen !=null){parentHeight=this.parentOwner.Div_gen.offsetHeight;}else{parentHeight=this.parentOwner.style.offsetHeight;}}var top=0;var eleHeight=this.height;if (isPercent(this.height)){top=0;}else if (parentHeight<=parseInt(this.height)) top=0;else{if (this.align=="center"){top=(parentHeight-parseInt(this.height))/2;top=parseInt(top);}else if (this.align=="top"){}}this.Div_gen.style.top=top+"px";}if (this.align==null || this.align==""){this.Div_gen.style.left=this.left+"px";}if (this.valign==null || this.valign==""){this.Div_gen.style.top=this.top+"px";}};LoadingBarComp.prototype.manageSelf=function(){if (this.innerHTML !=null){this.Div_gen.innerHTML=this.innerHTML;}};LoadingBarComp.prototype.setInnerHTML=function(innerHTML){if (innerHTML !=null){this.innerHTML=innerHTML;this.imgDiv.innerHTML=innerHTML;}};LoadingBarComp.prototype.show=function(){if (this.Div_gen&&this.imgDiv){this.Div_gen.style.zIndex=getZIndex();this.Div_gen.style.display="";this.imgDiv.style.visibility="visible";this.imgDiv.style.display="";this.imgDiv.style.zIndex=getZIndex();this.visible=true;var sctop=0;sctop=compFirstScrollTop();var topWin=getLfwTop();topWin=topWin==null ? window:topWin;topWin.positionElementToScreenCenter(this.imgDiv,sctop);}};LoadingBarComp.prototype.hide=function(){if (this.Div_gen){this.imgDiv.style.visibility="hidden";this.imgDiv.style.display="none";this.Div_gen.style.display="none";this.Div_gen.style.zIndex=-1;this.visible=false;}};function initDefaultLoadingBar(left,top,width,height,align,valign,zIndex,innerHTML){window.loadingBar=new LoadingBarComp(document.body,"$loadingBar",left,top,width,height,null,align,valign,zIndex);window.loadingBar.setInnerHTML(innerHTML);};function showDefaultLoadingBar(){if(window.editMode) return;if (window.loadingBar==null){window.loadingBar=new LoadingBarComp(document.body,"$loadingBar",0,0,"150","50",null,"center","center",100000);}if (window.showLoadingBarTimeOutFunc) clearTimeout(window.showLoadingBarTimeOutFunc);if (IS_IE){window.showLoadingBar=true;window.showLoadingBarDivTimeOutFunc=window.setTimeout("window.loadingBar.showDivgen()",100);}else{window.loadingBar.Div_gen.style.display="";window.loadingBar.Div_gen.style.zIndex=getZIndex();}window.showLoadingBarTimeOutFunc=window.setTimeout("window.loadingBar.show()",1000);};LoadingBarComp.prototype.showDivgen=function(){if (window.showLoadingBar !=true) return;if (this.Div_gen){this.Div_gen.style.zIndex=getZIndex();this.Div_gen.style.display="";}};function hideDefaultLoadingBar(){window.showLoadingBar=false;if (window.showLoadingBarDivTimeOutFunc) clearTimeout(window.showLoadingBarDivTimeOutFunc);if (window.showLoadingBarTimeOutFunc) clearTimeout(window.showLoadingBarTimeOutFunc);if (window.loadingBar !=null) window.loadingBar.hide();};
 function Ajax(){this.path=null;this.queryStr=null;this.returnFunc=null;this.returnArgs=null;this.format=true;this.params=new HashMap();};Ajax.prototype.setPath=function(path){this.path=path;};Ajax.prototype.setQueryStr=function(qryStr){this.queryStr=qryStr;};Ajax.prototype.addParam=function(key,value){this.params.put(key,value);};Ajax.prototype.setReturnFunc=function(returnFunc){this.returnFunc=returnFunc;};Ajax.prototype.setReturnArgs=function(returnArgs){this.returnArgs=returnArgs;};Ajax.prototype.setFormat=function(format){this.format=format;};Ajax.getHttpProxy=function(){var xmlHttpReq;try{xmlHttpReq=new XMLHttpRequest();}catch (e){xmlHttpReq=new ActiveXObject("Microsoft.XMLHTTP");}return xmlHttpReq;};Ajax.prototype.clone=function(){var ajax=new Ajax();ajax.path=this.path;ajax.queryStr=this.queryStr;ajax.returnFunc=this.returnFunc;ajax.returnArgs=this.returnArgs;ajax.format=this.format;ajax.params=this.params;return ajax;};Ajax.prototype.get=function(asyn){if (typeof (getStickString) !="undefined"){var stickStr=getStickString();if (stickStr !=null&&stickStr !="") this.queryStr=mergeParameter(this.queryStr,stickStr);}asyn=getBoolean(asyn,true);if (this.queryStr==null){this.queryStr="";}if (this.returnFunc==null){this.returnFunc=function(){};}try{var urlParam=this.path+(this.path.indexOf("?")==-1 ? "?":"")+this.queryStr+"&isAjax=1";if (this.queryStr !=""&&this.queryStr[this.queryStr.length-1] !="&") urlParam+="&";else urlParam+="&";if (this.params.size()>0){var keys=this.params.keySet();for ( var i=0,count=keys.length;i<count;i++){urlParam+=keys[i]+"="+encodeURIComponent(this.params.get(keys[i]));urlParam+="&";}}urlParam+="tmprandid="+Math.random();var xmlHttpReq=Ajax.getHttpProxy();xmlHttpReq.open("GET",urlParam,asyn);xmlHttpReq.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");if(IS_IE10_ABOVE){try{xmlHttpReq.responseType='msxml-document';}catch(e){}}xmlHttpReq.send(null);if (!asyn){if (this.format) return xmlHttpReq.responseXML;return xmlHttpReq.responseText;}this.addCallBack(xmlHttpReq);}catch (e){if (IS_IE) showErrorDialog("Ajax request error:"+e.name+" "+e.message);else showErrorDialog("Ajax request error:"+e);}};Ajax.prototype.post=function(asyn){if (typeof (getStickString) !="undefined"){var stickStr=getStickString();if (stickStr !=null&&stickStr !="") this.queryStr=mergeParameter(this.queryStr,stickStr);}asyn=getBoolean(asyn,true);if (this.queryStr==null){this.queryStr="";}if (this.returnFunc==null){this.returnFunc=function(){};}var paramStr="";if (this.params.size()>0){var keys=this.params.keySet();for ( var i=0,count=keys.length;i<count;i++){paramStr+=keys[i]+"="+encodeURIComponent(this.params.get(keys[i]));if (i !=count-1) paramStr+="&";}}var xmlHttpReq=Ajax.getHttpProxy();xmlHttpReq.open("POST",this.path,asyn);xmlHttpReq.setRequestHeader("Method","POST "+this.path+" HTTP/1.1");xmlHttpReq.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");if(IS_IE10_ABOVE){try{xmlHttpReq.responseType='msxml-document';}catch(e){}}this.xmlHttpReq=xmlHttpReq;var qryStr=this.queryStr;if (paramStr !="") qryStr+="&"+paramStr;if (asyn) this.addCallBack(xmlHttpReq);var bodyStr=qryStr+"&isAjax=1";xmlHttpReq.send(bodyStr);if (!asyn){var result=this.returnFunc(xmlHttpReq,this.returnArgs,null,this);this.destroySelf();return result;}};Ajax.prototype.addCallBack=function(xmlHttpReq){var oThis=this;xmlHttpReq.onreadystatechange=function(){if (this.readyState==4){if (this.status==200){oThis.returnFunc(this,oThis.returnArgs,null,oThis);}else if (this.status==306){oThis.returnFunc(this,oThis.returnArgs,"会话已失效,请重新登录",oThis);}else{oThis.returnFunc(this,oThis.returnArgs,"",oThis);}oThis.destroySelf();oThis=null;}};xmlHttpReq=null;};Ajax.prototype.destroySelf=function(){this.returnFunc=null;this.returnArgs=null;try{if (this.xmlHttpReq !=null){this.xmlHttpReq.onreadystatechange=null;this.xmlHttpReq=null;}}catch(e){if (this.xmlHttpReq !=null){this.xmlHttpReq.onreadystatechange=function(){};this.xmlHttpReq=null;}}};function mergeParameter(sourceParam,appendParam){if (sourceParam==null || sourceParam=="") return appendParam;else if (appendParam==null || appendParam=="") return sourceParam;else{return sourceParam+"&"+appendParam;}};
escapeJSONChar=function escapeJSONChar(c){if(c=="\"" || c == "\\") return "\\" + c;    else if (c == "\b") return "\\b";    else if (c == "\f") return "\\f";    else if (c == "\n") return "\\n";    else if (c == "\r") return "\\r";    else if (c == "\t") return "\\t";    var hex = c.charCodeAt(0).toString(16);    if(hex.length == 1) return "\\u000" + hex;    else if(hex.length == 2) return "\\u00" + hex;    else if(hex.length == 3) return "\\u0" + hex;    else return "\\u" + hex;};escapeJSONString =function escapeJSONString(s){            var parts = s.split("");    for(var i=0; i < parts.length; i++) {	var c =parts[i];	if(c == '"' ||	   c == '\\' ||	   c.charCodeAt(0) < 32 ||	   c.charCodeAt(0) >= 128)	    parts[i] = escapeJSONChar(parts[i]);    }    return "\"" + parts.join("") + "\"";};toJSON = function toJSON(o){    if(o == null) {		return "null";    }     else if(o.constructor == String) {		return escapeJSONString(o);    }     else if(o.constructor == Number) {		return o.toString();    }    else if(o.constructor == Boolean) {		return o.toString();    }     else if(o.constructor == Date) {		return '{javaClass:"java.util.Date",time:' + o.valueOf() +'}';    }     else if(o.constructor == Array || o.constructor.toString().indexOf('function Array') != -1) {		var v = [];		for(var i = 0; i < o.length; i++) 			v.push(toJSON(o[i]));		return "[" + v.join(", ") + "]";    }     else {		var v = [];		for(attr in o) {	  		if(o[attr] == null) 	  	  		v.push("\"" + attr + "\": null");	    	else if(typeof o[attr] == "function"){	    	}	    	else 	   			v.push(attr + ": " + toJSON(o[attr]));		}	    		return "{" + v.join(", ") + "}";    }};JSONRpcClient =function JSONRpcClient_ctor(serverURL, user, pass, objectID){    this.serverURL = serverURL;    this.user = user;    this.pass = pass;    this.objectID = objectID;        if(this.objectID) {	this._addMethods(["listMethods"]);	var req = this._makeRequest("listMethods", []);    } else {	this._addMethods(["system.listMethods"]);	var req = this._makeRequest("system.listMethods", []);    }    var m = this._sendRequest(req);    this._addMethods(m);};JSONRpcClient.Exception =function JSONRpcClient_Exception_ctor(code, message, javaStack){    this.code = code;    var name;    if(javaStack) {	this.javaStack = javaStack;	var m = javaStack.match(/^([^:]*)/);	if(m) name = m[0];    }    if(name) this.name = name;    else this.name = "JSONRpcClientException";    this.message = message;};JSONRpcClient.Exception.CODE_REMOTE_EXCEPTION = 490;JSONRpcClient.Exception.CODE_ERR_CLIENT = 550;JSONRpcClient.Exception.CODE_ERR_PARSE = 590;JSONRpcClient.Exception.CODE_ERR_NOMETHOD = 591;JSONRpcClient.Exception.CODE_ERR_UNMARSHALL = 592;JSONRpcClient.Exception.CODE_ERR_MARSHALL = 593;JSONRpcClient.Exception.prototype = new Error();JSONRpcClient.Exception.prototype.toString =function JSONRpcClient_Exception_toString(code, msg){    return this.name + ": " + this.message;};JSONRpcClient.default_ex_handler =function JSONRpcClient_default_ex_handler(e) { alert(e); };JSONRpcClient.toplevel_ex_handler = JSONRpcClient.default_ex_handler;JSONRpcClient.profile_async = false;JSONRpcClient.max_req_active = 1;JSONRpcClient.requestId = 1;JSONRpcClient.prototype._createMethod =function JSONRpcClient_createMethod(methodName){    var fn=function()    {	var args = [];	var callback = null;	for(var i=0;i<arguments.length;i++) args.push(arguments[i]);	if(typeof args[0] == "function") callback = args.shift();	var req = fn.client._makeRequest.call(fn.client, fn.methodName,					      args, callback);	if(callback == null) {	    return fn.client._sendRequest.call(fn.client, req);	} else {	    JSONRpcClient.async_requests.push(req);	    JSONRpcClient.kick_async();	    return req.requestId;	}    };    fn.client = this;    fn.methodName = methodName;    return fn;};JSONRpcClient.prototype._addMethods =function JSONRpcClient_addMethods(methodNames){    for(var i=0; i<methodNames.length; i++) {	var obj = this;	var names = methodNames[i].split(".");	for(var n=0; n<names.length-1; n++) {	    var name = names[n];	    if(obj[name]) {		obj = obj[name];	    } else {		obj[name]  = new Object();		obj = obj[name];	    }	}	var name = names[names.length-1];	if(!obj[name]) {	    var method = this._createMethod(methodNames[i]);	    obj[name] = method;	}    }};JSONRpcClient._getCharsetFromHeaders =function JSONRpcClient_getCharsetFromHeaders(http){    try {	var contentType = http.getResponseHeader("Content-type");	var parts = contentType.split(/\s*;\s*/);	for(var i =0; i < parts.length; i++) {	    if(parts[i].substring(0, 8) == "charset=")		return parts[i].substring(8, parts[i].length);	}    } catch (e) {}    return "UTF-8"; };JSONRpcClient.async_requests = [];JSONRpcClient.async_inflight = {};JSONRpcClient.async_responses = [];JSONRpcClient.async_timeout = null;JSONRpcClient.num_req_active = 0;JSONRpcClient._async_handler =function JSONRpcClient_async_handler(){    JSONRpcClient.async_timeout = null;    while(JSONRpcClient.async_responses.length > 0) {	var res = JSONRpcClient.async_responses.shift();	if(res.canceled) continue;	if(res.profile) res.profile.dispatch = new Date();	try {	    res.cb(res.result, res.ex, res.profile);	} catch(e) {	    JSONRpcClient.toplevel_ex_handler(e);	}    }    while(JSONRpcClient.async_requests.length > 0 &&	  JSONRpcClient.num_req_active < JSONRpcClient.max_req_active) {	var req = JSONRpcClient.async_requests.shift();	if(req.canceled) continue;	req.client._sendRequest.call(req.client, req);    }};JSONRpcClient.kick_async =function JSONRpcClient_kick_async(){    if(JSONRpcClient.async_timeout == null)	JSONRpcClient.async_timeout =	    setTimeout(JSONRpcClient._async_handler, 0);};JSONRpcClient.cancelRequest =function JSONRpcClient_cancelRequest(requestId){        if(JSONRpcClient.async_inflight[requestId]) {	JSONRpcClient.async_inflight[requestId].canceled = true;	return true;    }        for(var i in JSONRpcClient.async_requests) {	if(JSONRpcClient.async_requests[i].requestId == requestId) {	    JSONRpcClient.async_requests[i].canceled = true;	    return true;	}    }        for(var i in JSONRpcClient.async_responses) {	if(JSONRpcClient.async_responses[i].requestId == requestId) {	    JSONRpcClient.async_responses[i].canceled = true;	    return true;	}    }    return false;};JSONRpcClient.prototype._makeRequest =function JSONRpcClient_makeRequest(methodName, args, cb){    var req = {};    req.client = this;    req.requestId = JSONRpcClient.requestId++;    var obj = {};    obj.id = req.requestId;    if (this.objectID)	obj.method = ".obj#" + this.objectID + "." + methodName;    else	obj.method = methodName;    obj.params = args;    if (cb) req.cb = cb;    if (JSONRpcClient.profile_async)	req.profile = { "submit": new Date() };    req.data = toJSON(obj);    return req;};JSONRpcClient.prototype._sendRequest =function JSONRpcClient_sendRequest(req){    if(req.profile) req.profile.start = new Date();        var http = JSONRpcClient.poolGetHTTPRequest();    JSONRpcClient.num_req_active++;        if (typeof(this.user) == "undefined") {	http.open("POST", this.serverURL, (req.cb != null));    } else {	http.open("POST", this.serverURL, (req.cb != null), this.user, this.pass);    }        try { http.setRequestHeader("Content-type", "text/plain"); } catch(e) {}        if(req.cb) {	var self = this;	http.onreadystatechange = function() {	    if(http.readyState == 4) {		http.onreadystatechange = function () {};		var res = { "cb": req.cb, "result": null, "ex": null};		if (req.profile) {		    res.profile = req.profile;		    res.profile.end = new Date();		}		try { res.result = self._handleResponse(http); }		catch(e) { res.ex = e; }		if(!JSONRpcClient.async_inflight[req.requestId].canceled)		    JSONRpcClient.async_responses.push(res);		delete JSONRpcClient.async_inflight[req.requestId];		JSONRpcClient.kick_async();	    }	};    } else {	http.onreadystatechange = function() {};    }    JSONRpcClient.async_inflight[req.requestId] = req;	    try {	http.send(req.data);    } catch(e) {	JSONRpcClient.poolReturnHTTPRequest(http);	JSONRpcClient.num_req_active--;	throw new JSONRpcClient.Exception	    (JSONRpcClient.Exception.CODE_ERR_CLIENT, "Connection failed");    }    if(!req.cb) return this._handleResponse(http);};JSONRpcClient.prototype._handleResponse =function JSONRpcClient_handleResponse(http){        if(!this.charset) {	this.charset = JSONRpcClient._getCharsetFromHeaders(http);    }        var status, statusText, data;    try {	status = http.status;	statusText = http.statusText;	data = http.responseText;    } catch(e) {	JSONRpcClient.poolReturnHTTPRequest(http);	JSONRpcClient.num_req_active--;	JSONRpcClient.kick_async();	throw new JSONRpcClient.Exception	    (JSONRpcClient.Exception.CODE_ERR_CLIENT, "Connection failed");    }        JSONRpcClient.poolReturnHTTPRequest(http);    JSONRpcClient.num_req_active--;        if(status != 200) {	throw new JSONRpcClient.Exception(status, statusText);    }    var obj;    try {	eval("obj = " + data);    } catch(e) {	throw new JSONRpcClient.Exception(550, "error parsing result");    }    if(obj.error)	throw new JSONRpcClient.Exception(obj.error.code, obj.error.msg,					  obj.error.trace);    var res = obj.result;        if(res && res.objectID && res.JSONRPCType == "CallableReference")	return new JSONRpcClient(this.serverURL, this.user,				 this.pass, res.objectID);    return res;};JSONRpcClient.http_spare = [];JSONRpcClient.http_max_spare = 8;JSONRpcClient.poolGetHTTPRequest =function JSONRpcClient_pool_getHTTPRequest(){    if(JSONRpcClient.http_spare.length > 0) {	return JSONRpcClient.http_spare.pop();    }    return JSONRpcClient.getHTTPRequest();};JSONRpcClient.poolReturnHTTPRequest =function JSONRpcClient_poolReturnHTTPRequest(http){    if(JSONRpcClient.http_spare.length >= JSONRpcClient.http_max_spare)	delete http;    else	JSONRpcClient.http_spare.push(http);};JSONRpcClient.msxmlNames = [ "MSXML2.XMLHTTP.5.0",			     "MSXML2.XMLHTTP.4.0",			     "MSXML2.XMLHTTP.3.0",			     "MSXML2.XMLHTTP",			     "Microsoft.XMLHTTP" ];JSONRpcClient.getHTTPRequest =function JSONRpcClient_getHTTPRequest(){        try {	JSONRpcClient.httpObjectName = "XMLHttpRequest";	return new XMLHttpRequest();    } catch(e) {}        for (var i=0;i < JSONRpcClient.msxmlNames.length; i++) {	try {	    JSONRpcClient.httpObjectName = JSONRpcClient.msxmlNames[i];	    return new ActiveXObject(JSONRpcClient.msxmlNames[i]);	} catch (e) {}    }        JSONRpcClient.httpObjectName = null;    throw new JSONRpcClient.Exception(0, "Can't create XMLHttpRequest object");};
var FormaterMap=new HashMap();function Formater(){};Formater.prototype.format=function(value,direction){if (direction==null || direction==true) return getString(value,"");return value;};Formater.prototype.valid=function(presssKey,aggValue){return true;};BooleanFormater.trueArr=[ 1,'Y','y',true,'true'];BooleanFormater.falseArr=[ 0,'N','n',false,'false'];function BooleanFormater(trueArr,falseArr,defaultValue){if (trueArr==null) this.trueArr=BooleanFormater.trueArr;else this.trueArr=trueArr;if (falseArr==null) this.falseArr=BooleanFormater.falseArr;else this.falseArr=falseArr;this.defaultValue=getBoolean(defaultValue,false);};BooleanFormater.prototype.format=function(value,direction){if (direction==null || direction==true){if (this.falseArr.indexOf(value) !=-1) return false;if (this.trueArr.indexOf(value) !=-1) return true;return this.defaultValue;}return value;};function StringFormater(maxSize){if (maxSize==null || parseInt(maxSize)<0) this.maxSize=-1;else this.maxSize=maxSize;};StringFormater.prototype.format=function(value){if (value==null || value=="") return "";if (this.maxSize>0){if (value.lengthb()>this.maxSize) value=value.substrCH(this.maxSize);}return value;};StringFormater.prototype.valid=function(key,aggValue,currValue){if (this.maxSize !=-1){if (aggValue.lengthb()>this.maxSize) return false;}};function DicimalFormater(precision,minValue,maxValue){this.precision=getInteger(precision,2);this.minValue=minValue;this.maxValue=maxValue;};DicimalFormater.prototype.format=function(value){if (value==null || value=="") return "";if (this.minValue !=null&&parseFloat(value)<this.minValue) return "";if (this.maxValue !=null&&parseFloat(value)>this.maxValue) return "";value=value+"";for ( var i=0;i<value.length;i++){if ("-0123456789.".indexOf(value.charAt(i))==-1) return "";}return checkDicimalInvalid(value,this.precision);};DicimalFormater.prototype.valid=function(key,aggValue,currValue){if("0123456789.-".indexOf(key)==-1){return false;}return checkInputDicimal(aggValue,this.precision);};function checkInputDicimal(value,precision){if (value==null || value=="") return false;value=value+"";var freg=new RegExp(/^-?([0-9]\d*\.\d*|0\.\d*[0-9]\d*|0?\.0+|0)$/);if(freg.test(value)){if (value.indexOf(".") !=-1){var intNumber=value.substr(0,value.indexOf("."));if (intNumber.length>15-precision-1) return false;}var num=0,start=0;if ((start=value.indexOf(".")) !=-1){if ((value.substring(start+1)).length>parseInt(precision)) return false;}return true;}var nreg=new RegExp(/^(-|\+)?\d+$/);if(nreg.test(value)){if (value.length>15-precision-1) return false;return true;}if(value=="-"){return true;}if(value=="0."|| value=="-0.") return true;return false;};function checkDicimalInvalid(str,precision){if (str==null || isNaN(str)) return "";if (str.length>15) str=str.substring(0,15);if (precision==null || !isNumberOnly(precision)) precision=2;else precision=parseInt(precision);var digit=parseFloat(str);var result=(digit*Math.pow(10,precision)/Math.pow(10,precision)) .toFixed(precision);if (result=="NaN") return "";return result;};function IntegerFormater(minValue,maxValue){if (!isNumber(minValue)) this.minValue=-999999999999999;else this.minValue=parseInt(minValue);if (!isNumber(maxValue)) this.maxValue=999999999999999;else this.maxValue=parseInt(maxValue);};IntegerFormater.prototype.format=function(value,isBlur){if (value==null || value=="") return "";if(!IS_IE){while(value.charAt(0)=="0"&&value.length>1){value=value.substring(1);}}if (!isNumber(value)){return "";}if(isBlur){if(value<this.minValue || value>this.maxValue) return "";}if (checkIntegerIsValid(value,this.minValue,this.maxValue)==true) return value;else return "";};IntegerFormater.prototype.valid=function(key,aggValue,currValue){var isInvalid=false;if ("-0123456789".indexOf(key)==-1) isInvalid=false;else isInvalid=true;if (isInvalid==true){if (aggValue=="-") return true;else{if(isNumber(aggValue)){if(aggValue.length>15) return false;return checkIntegerIsValid(aggValue,this.minValue,this.maxValue);}return false;}}else return false;return true;};function checkIntegerIsValid(value,minValue,maxValue){if (!isNumber(value)) return false;value=parseInt(value);if (!isNumber(minValue)){minValue=-99999999999999;}if (!isNumber(maxValue)){maxValue=999999999999999;}if ((value>maxValue) || (minValue<0&&value<minValue)) return false;else return true;};function DateFormater(){};DateFormater.prototype.valid=function(key,aggValue,currValue){return true;};DateFormater.prototype.getMaskerFormatValue=function(value){if(typeof(value)=="undefined"|| value==""|| value==null){return "";}var type="DATETEXT";if(typeof(DateTextComp) !="undefined"&&typeof(DateTextComp.prototype.componentType) !="undefined"){type=DateTextComp.prototype.componentType;}var maskerType=this.showTimeBar ? "DateTimeText":type;var masker=getMasker(maskerType);if(masker !=null) return masker.format(value).value;else return value;};DateFormater.prototype.format=function(value){if (typeof(value)=="undefined"|| value==null || value==""){return "";}if (value.indexOf('$')==0){return value;}if (value.length>10){var dateTimeValue=this.formatDateTime(value);if (dateTimeValue !=""){return dateTimeValue;}}else if(value.length>=8){var dateTimeValue=this.formatDate(value);if (dateTimeValue !=""){return dateTimeValue;}}else{return "";}var changeValue=value.replace(/-/ig,"/");if (!isNaN(Date.parse(changeValue))){var d=new Date(changeValue);var nowDate=new Date();var y=d.getFullYear();var m=d.getMonth()+1;if (parseInt(m)<10){m="0"+m;}var d=d.getDate();if (d<10){d="0"+d;}hour=nowDate.getHours();min=nowDate.getMinutes();sec=nowDate.getSeconds();return y+"-"+m+"-"+d+" "+hour+":"+min+":"+sec;}else{return "";}};DateFormater.prototype.formatDateTime=function(value){if (typeof(value)=="undefined"|| value==null || value=="") return "";if (value.indexOf('$')==0){return value;}var reg=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/;var r=value.match(reg);if(r==null) return "";var d=new Date(r[1],r[3]-1,r[4],r[5],r[6],r[7]);if (d.getFullYear()==r[1]&&(d.getMonth()+1)==r[3]&&d.getDate()==r[4]&&d.getHours()==r[5]&&d.getMinutes()==r[6]&&d.getSeconds()==r[7]) return r[1]+"-"+r[3]+"-"+r[4]+" "+r[5]+":"+r[6]+":"+r[7];else return "";};DateFormater.prototype.formatYearAndMonth=function(value){var strDate=value;if (typeof(strDate)=="undefined"|| strDate==null || strDate=="") return "";if(strDate.length>7){strDate=strDate.substring(0,7);}var reg=/^(\d{1,4})(-|\/)(([0]{0,1}[1-9]{1})|([1]{1}[0-2]{1}))$/;var r=strDate.match(reg);if (r==null){return "";}else if (r==false){return "";}var year=parseInt(r[1],10);var month=parseInt(r[3],10);var date=1;var dateObj=new Date(year,month-1,date);if (dateObj.getFullYear()==year&&(dateObj.getMonth()+1)==month&&dateObj.getDate()==date){var m=dateObj.getMonth()+1;if (m<10){m="0"+m;}value=dateObj.getFullYear()+"-"+m;}else{value="";}return value;};DateFormater.prototype.formatMonth=function(value){var strDate=value;if (typeof(strDate)=="undefined"|| strDate==null || strDate=="") return "";if(strDate.length>2){strDate=strDate.substring(0,2);}var reg=/^(([0]{0,1}[1-9]{1})|([1]{1}[0-2]{1}))$/;var r=strDate.match(reg);if (r==null){return "";}else if (r==false){return "";}if (strDate<10&&strDate.length<2){strDate="0"+strDate;}return strDate;};DateFormater.prototype.formatYear=function(value){var strDate=value;if (typeof(strDate)=="undefined"|| strDate==null || strDate=="") return "";if(strDate.length>4){strDate=strDate.substring(0,4);}var reg=/^\d{4}$/;var r=strDate.match(reg);if (r==null){return "";}else if (r==false){return "";}return strDate;};DateFormater.prototype.formatDate=function(value){var strDate=value;if (typeof(strDate)=="undefined"|| strDate==null || strDate=="") return "";if (value.indexOf('$')==0){return value;}if(strDate.length>10){strDate=strDate.substring(0,10);}var reg=/^(\d{1,4})(-|\/)(([0]{0,1}[1-9]{1})|([1]{1}[0-2]{1}))(-|\/)(([0]{0,1}[1-9]{1})|([1-2]{1}[0-9]{1})|([3]{1}[0-1]{1}))$/;var r=strDate.match(reg);if (r==null){return "";}else if (r==false){return "";}var year=parseInt(r[1],10);var month=parseInt(r[3],10);var date=parseInt(r[7],10);var dateObj=new Date(year,month-1,date);if (dateObj.getFullYear()==year&&(dateObj.getMonth()+1)==month&&dateObj.getDate()==date){var m=dateObj.getMonth()+1;if (m<10){m="0"+m;}var d=dateObj.getDate();if (d<10){d="0"+d;}value=dateObj.getFullYear()+"-"+m+"-"+d;}else{value="";}return value;};DateFormater.prototype.formatTime=function(value){var strDate=value;if (typeof(strDate)=="undefined"|| strDate==null || strDate=="") return "";if(strDate.length>8){strDate=strDate.substring(0,8);}var reg=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/;var r=strDate.match(reg);if (r==null){return "";}else if (r==false){return "";}return strDate;};DateFormater.prototype.formatDateToString=function(date){if(typeof(date) !="object"|| !(date instanceof Date)){date=new Date();}var year=date.getFullYear();var month=date.getMonth()+1;if(month<10){month=new String("0"+month);}var day=date.getDate();if (day<10){day=new String("0"+day);}var hour=date.getHours();if (hour<10){hour=new String("0"+hour);}var min=date.getMinutes();if (min<10){min=new String("0"+min);}var sec=date.getSeconds();if (sec<10){sec=new String("0"+sec);}return year+"-"+month+"-"+day+" "+hour+":"+min+":"+sec;};DateFormater.prototype.formatInputValueToDateString=function(inputValue){var value=this.formatDateTime(inputValue);if(value !=""){return value;}value=this.formatDate(inputValue);if(value !=""){var date=new Date();var hour=date.getHours();if (hour<10){hour=new String("0"+hour);}var min=date.getMinutes();if (min<10){min=new String("0"+min);}var sec=date.getSeconds();if (sec<10){sec=new String("0"+sec);}return value+" "+hour+":"+min+":"+sec;}return value;};function showVerifyMessage(obj,msg){if (window.sys_verifyMessageDiv==null){var div=$ce("DIV");div.style.background="#D8E3E8";div.style.zIndex=getZIndex();div.style.position="absolute";div.appendChild(document.createTextNode(""));window.sys_verifyMessageDiv=div;document.body.appendChild(window.sys_verifyMessageDiv);window.sys_verifyMessageDiv.style.display="none";}window.sys_verifyCount=0;if(typeof obj.getObjHtml=="function"){var top=compOffsetTop(obj.getObjHtml())+obj.getObjHtml().offsetHeight;var left=compOffsetLeft(obj.getObjHtml());}window.sys_verifyMessageDiv.replaceChild(document.createTextNode(msg),window.sys_verifyMessageDiv.firstChild);window.sys_verifyMessageDiv.style.top=top+4+"px";window.sys_verifyMessageDiv.style.left=left+"px";window.sys_verifyMessageDiv.style.display="block";setTimeout("startVerifyMessageFloating()",100);};function startVerifyMessageFloating(){if (window.sys_verifyCount<10){window.sys_verifyMessageDiv.style.top=window.sys_verifyMessageDiv.offsetTop-4+"px";window.sys_verifyCount++;setTimeout("startVerifyMessageFloating()",100);}else{window.sys_verifyMessageDiv.style.display="none";}};function EmailFormater(maxSize){if (maxSize==null || parseInt(maxSize)<0) this.maxSize=-1;else this.maxSize=maxSize;};EmailFormater.prototype.format=function(value){if (value==null || value=="") return "";if (this.maxSize>0){if (value.lengthb()>this.maxSize) value=value.substrCH(this.maxSize);}var reg=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;var r=value.match(reg);if (r==null){return "";}else if (r==false){return "";}return value;};EmailFormater.prototype.valid=function(key,aggValue,currValue){if (this.maxSize !=-1){if (aggValue.lengthb()>this.maxSize) return false;}};function PhoneFormater(maxSize){if (maxSize==null || parseInt(maxSize)<0) this.maxSize=-1;else this.maxSize=maxSize;};PhoneFormater.prototype.format=function(value){if (value==null || value=="") return "";if (this.maxSize>0){if (value.lengthb()>this.maxSize) value=value.substrCH(this.maxSize);}var reg=/^([0\+]\d{2,3}-)?(\d{11})$|^([0\+]\d{2,3}-)?(0\d{2,3}-)?(\d{7,8})(-(\d{1,4}))?$/;var r=value.match(reg);if (r==null){return "";}else if (r==false){return "";}return value;};PhoneFormater.prototype.valid=function(key,aggValue,currValue){if (this.maxSize !=-1){if (aggValue.lengthb()>this.maxSize) return false;}};

var layoutResizeMap=new HashMap();var layoutInitMap=new HashMap();var layoutMonitorArray=new Array();function addResizeEvent(obj,func,bUndoResizeFunc){if (!obj) return;if (bUndoResizeFunc){layoutInitMap.put(obj.id,func);}else{if (IS_IE7){EventUtil.addEventHandler(obj,"resize",function(){func.call(obj)});}else{layoutResizeMap.put(obj.id,func);}layoutInitMap.put(obj.id,func);}};function addAndCallResizeEvent(obj,func){addResizeEvent(obj,func);func.call(obj);}var windowResizeArray=new Array;function addWindowResize(func){windowResizeArray.add(func);};window.onresize=windowResizeFunc;function windowResizeFunc(){var e=EventUtil.getEvent();var keySet=layoutResizeMap.keySet();for (var i=0;i<keySet.length;i++){var id=keySet[i];var obj=$ge(id);var func=layoutResizeMap.get(id);if (obj==null || func==null) continue;func.call(obj,e);}for (var i=0;i<windowResizeArray.length;i++){windowResizeArray[i].call(e);}clearEvent(e);};function layoutInitFunc(){var keySet=layoutInitMap.keySet();for (var i=0;i<keySet.length;i++){var id=keySet[i];var obj=$ge(id);var func=layoutInitMap.get(id);func.call(obj);}};function resizeChildDiv(oContainer,height){var arrChild=oContainer.childNodes;for (var i=0;i<arrChild.length;i++){if (arrChild[i].nodeName=="DIV"){if (arrChild[i].style.height=="100%"){arrChild[i].isMaxSizeDiv=true;}if (arrChild[i].isMaxSizeDiv){arrChild[i].style.height=height;}}}};function borderResize(e){var oBorder=this;var id=oBorder.id;var oBorderCenter=$ge(id+"_center");var newWidth=oBorder.offsetWidth;var newHeight=oBorder.offsetHeight;if (newWidth !=oBorder.oldWidth){var oBorderLeft=$ge(id+"_left");var oBorderRight=$ge(id+"_right");var width=oBorder.offsetWidth-(oBorderLeft ? oBorderLeft.offsetWidth:0)-(oBorderRight ? oBorderRight.offsetWidth:0);if (!IS_IE || IS_IE8) width-=0.5;if (width<0) width=0;oBorderCenter.style.width=width+"px";}if (newHeight !=oBorder.oldHeight){var oBorderMiddle=$ge(id+"_middle");var oBorderInner=$ge(id+"_inner");var oBorderTop=$ge(id+"_top");var oBorderBottom=$ge(id+"_bottom");var height=oBorder.offsetHeight-(oBorderTop ? oBorderTop.offsetHeight:0)-(oBorderBottom ? oBorderBottom.offsetHeight:0);if (height<0) height=0;oBorderMiddle.style.height=height+"px";if (oBorderInner) oBorderInner.style.height=height+"px";}oBorder.oldWidth=oBorder.offsetWidth;oBorder.oldHeight=oBorder.offsetHeight;};function flowhResize(e){var oFlow=this;var id=oFlow.id;var newWidth=oFlow.offsetWidth;if (true || newWidth !=oFlow.oldWidth){var arrKnownWidthItem=new Array();var arrUnknownWidthItem=new Array();var lastChild=null;if(oFlow==null || oFlow.childNodes==null) return;for (var i=0;i<oFlow.childNodes.length;i++){var oFlowItem=oFlow.childNodes[i];if (oFlowItem.id&&oFlowItem.id.indexOf(id) !=-1){if (oFlowItem.getAttribute("haswidth")=="1"){arrKnownWidthItem.push(oFlowItem);}else{arrUnknownWidthItem.push(oFlowItem);}lastChild=oFlowItem;}}var totalWidth=oFlow.offsetWidth;for (var i=0;i<arrKnownWidthItem.length;i++){totalWidth-=arrKnownWidthItem[i].offsetWidth;var borderLeft=parseInt(arrKnownWidthItem[i].style.borderLeftWidth);borderLeft=isNaN(borderLeft) ? 0:borderLeft;totalWidth-=borderLeft;var borderRight=parseInt(arrKnownWidthItem[i].style.borderRightWidth);borderRight=isNaN(borderRight) ? 0:borderRight;totalWidth-=borderRight;}var itemLength=arrUnknownWidthItem.length;if(itemLength>0){var width=totalWidth/itemLength;width=parseInt(width);var lastMarginLeft=newWidth-totalWidth;for (var i=0;i<itemLength;i++){var tempWidth=width;var paddingLeft=parseInt(arrUnknownWidthItem[i].style.paddingLeft);paddingLeft=isNaN(paddingLeft) ? 0:paddingLeft;var paddingRight=parseInt(arrUnknownWidthItem[i].style.paddingRight);paddingRight=isNaN(paddingRight) ? 0:paddingRight;tempWidth=tempWidth-paddingLeft-paddingRight;var borderLeft=parseInt(arrUnknownWidthItem[i].style.borderLeftWidth);borderLeft=isNaN(borderLeft) ? 0:borderLeft;var borderRight=parseInt(arrUnknownWidthItem[i].style.borderRightWidth);borderRight=isNaN(borderRight) ? 0:borderRight;tempWidth=tempWidth-borderLeft-borderRight;if (tempWidth<0) tempWidth=0;if (i==itemLength-1&&arrUnknownWidthItem[i]==lastChild){arrUnknownWidthItem[i].style.marginLeft=lastMarginLeft+"px";arrUnknownWidthItem[i].style[ATTRFLOAT]='';arrUnknownWidthItem[i].style.overflowX="";}else arrUnknownWidthItem[i].style.width=tempWidth+"px";lastMarginLeft+=width;if (arrUnknownWidthItem[i].offsetHeight==0&&arrUnknownWidthItem[i].childNodes.length==0){arrUnknownWidthItem[i].style.height=oFlow.offsetHeight+"px";}}}}oFlow.oldWidth=oFlow.offsetWidth;};function flowhResizeEdit(e){var borderWidth=1;var marginWidth=1;var paddingWidth=3;var otherWidth=marginWidth*2+paddingWidth*2+borderWidth*2;var oFlow=this;var id=oFlow.id;var newWidth=oFlow.offsetWidth;if (newWidth !=oFlow.oldWidth){var arrKnownWidthItem=new Array();var arrUnknownWidthItem=new Array();for (var i=0;i<oFlow.childNodes.length;i++){var oFlowItem=oFlow.childNodes[i];if (oFlowItem.id&&oFlowItem.id.indexOf(id) !=-1){if (oFlowItem.getAttribute("haswidth")=="1"){arrKnownWidthItem.push(oFlowItem);}else{arrUnknownWidthItem.push(oFlowItem);}}}var totalWidth=oFlow.offsetWidth;for (var i=0;i<arrKnownWidthItem.length;i++){totalWidth-=(arrKnownWidthItem[i].offsetWidth+otherWidth);}var width=totalWidth/(arrUnknownWidthItem.length==0 ? 1:arrUnknownWidthItem.length);width=parseInt(width);for (var i=0,n=arrUnknownWidthItem.length;i<n;i++){if (i==n-1){width=(totalWidth-width*(arrUnknownWidthItem.length-1)-otherWidth);if (!IS_IE || IS_IE8) width-=1;}if (width<0) width=0;arrUnknownWidthItem[i].style.width=width+"px";}}oFlow.oldWidth=oFlow.offsetWidth;};function flowvResize(e){var oFlow=this;var id=oFlow.id;var newHeight=oFlow.offsetHeight;if (true || newHeight !=oFlow.oldHeight){var arrKnownHeightItem=new Array();var arrUnknownHeightItem=new Array();for (var i=0;i<oFlow.childNodes.length;i++){var oFlowItem=oFlow.childNodes[i];if (oFlowItem.id&&oFlowItem.id.indexOf(id) !=-1){if (oFlowItem.getAttribute("hasheight")=="1"){arrKnownHeightItem.push(oFlowItem);}else{arrUnknownHeightItem.push(oFlowItem);}}}var totalHeight=oFlow.offsetHeight;for (var i=0;i<arrKnownHeightItem.length;i++){totalHeight-=arrKnownHeightItem[i].offsetHeight;}var height=totalHeight/(arrUnknownHeightItem.length==0 ? 1:arrUnknownHeightItem.length);height=parseInt(height);for (var i=0,n=arrUnknownHeightItem.length;i<n;i++){if (i==n-1){height=(totalHeight-height*(arrUnknownHeightItem.length-1));}var paddingTop=parseInt(arrUnknownHeightItem[i].style.paddingTop);paddingTop=isNaN(paddingTop) ? 0:paddingTop;var paddingBottom=parseInt(arrUnknownHeightItem[i].style.paddingBottom);paddingBottom=isNaN(paddingBottom) ? 0:paddingBottom;height=height-paddingTop-paddingBottom;if (height<0) height=0;arrUnknownHeightItem[i].style.height=height+"px";}}oFlow.oldHeight=oFlow.offsetHeight;};function absoluteResize(e){var oLayout=this;var id=oLayout.id;var newHeight=oLayout.offsetHeight;var newWidth=oLayout.offsetWidth;if (newHeight !=oLayout.oldHeight&&newWidth !=oLayout.oldWidth){var oPreItem=null;var preleft=0;var preright=0;var pretop=0;var prebottom=0;for (var i=0;i<oLayout.childNodes.length;i++){var oItem=oLayout.childNodes[i];if (oItem.id&&oItem.id.indexOf(id) !=-1){var left=oItem.getAttribute("attleft");var right=oItem.getAttribute("attright");var top=oItem.getAttribute("atttop");var bottom=oItem.getAttribute("attbottom");var width=oItem.getAttribute("attwidth");var height=oItem.getAttribute("attheight");var anchorLeft=oItem.getAttribute("anchorLeft");var anchorRight=oItem.getAttribute("anchorRight");var anchorTop=oItem.getAttribute("anchorTop");var anchorBottom=oItem.getAttribute("anchorBottom");var remainWidth=newWidth;var offsetLeft=0;if (anchorLeft=="panel"){remainWidth=remainWidth-preright;offsetLeft=preright;}else if(anchorRight=="panel"){remainWidth=preleft;}if (width !='null'){if (isPercent(width)) width=remainWidth*per2decimal(width);if (left=='null'&&right !='null'){if (isPercent(right)) left=remainWidth-width-(remainWidth-width)*per2decimal(left)+offsetLeft;else left=remainWidth-width-right+offsetLeft;}else{if (left=='null') left=0;if (isPercent(left)) left=(remainWidth-width)*per2decimal(left)+offsetLeft;else left=parseInt(left)+offsetLeft;}}else{if (left=='null') left=0;if (right=='null') right=0;width=remainWidth-left-right;}if (left<0) left=0;oItem.style.width=width+"px";oItem.style.left=left+"px";preleft=left;preright=parseInt(left)+parseInt(width);var remainHeight=newHeight;var offsetTop=0;if (anchorTop=="panel"){remainHeight=remainHeight-prebottom;offsetTop=prebottom;}else if(anchorBottom=="panel"){remainHeight=pretop;}if (height !='null'){if (isPercent(height)) height=remainHeight*per2decimal(height);if (top=='null'&&bottom !='null'){if (isPercent(bottom)) top=remainHeight-height-(remainHeight-height)*per2decimal(top)+offsetTop;else top=remainHeight-height-bottom+offsetTop;}else{if (top=='null') top=0;if (isPercent(top)) top=(remainHeight-height)*per2decimal(top)+offsetTop;else top=parseInt(top)+offsetTop;}}else{if (top=='null') top=0;if (bottom=='null') bottom=0;height=remainHeight-top-bottom;}if (top<0) top=0;oItem.style.height=height+"px";oItem.style.top=top+"px";pretop=parseInt(top);prebottom=parseInt(top)+parseInt(height);}}}oLayout.oldHeight=oLayout.offsetHeight;oLayout.oldWidth=oLayout.offsetWidth;};function scrollToAnchor(id,anchor,widgetId){if (id==null || id=="") return;var divId="$d_"+(widgetId==null || widgetId==""? "":(widgetId+"_"))+id;var oFlow=$ge(divId);if (oFlow&&anchor !=null&&anchor !=""){if (isDivVScroll(oFlow)){var scrollTop=0;for (var i=0;i<oFlow.childNodes.length;i++){var oFlowItem=oFlow.childNodes[i];if (oFlowItem.id&&oFlowItem.id.indexOf(divId) !=-1){if (oFlowItem.getAttribute("anchor")==anchor){oFlow.scrollTop=scrollTop;}else{scrollTop+=oFlowItem.offsetHeight;}}}}}};function getFlowvPanel(id,anchor,widgetId){if (id==null || id=="") return null;var divId="$d_"+(widgetId==null || widgetId==""? "":(widgetId+"_"))+id;var oFlow=$ge(divId);if (oFlow&&anchor !=null&&anchor !=""){for (var i=0;i<oFlow.childNodes.length;i++){var oFlowItem=oFlow.childNodes[i];if (oFlowItem.id&&oFlowItem.id.indexOf(divId) !=-1){if (oFlowItem.getAttribute("anchor")==anchor){return oFlowItem;}}}}};function gridLayoutResize(e){var oGridLayout=this;var id=oGridLayout.id;var colCount=oGridLayout.getAttribute("colcount");var newHeight=oGridLayout.offsetHeight;var newWidth=oGridLayout.offsetWidth;if (newHeight !=oGridLayout.oldHeight){var arrKnownHeightItem=new Array();var arrUnknownHeightItem=new Array();for (var i=0;i<oGridLayout.childNodes.length;i++){var oGridLayoutItem=oGridLayout.childNodes[i];if (oGridLayoutItem.id&&oGridLayoutItem.id.indexOf(id) !=-1&&oGridLayoutItem.getAttribute("hasheight")&&oGridLayoutItem.getAttribute("hasheight") !=""){if (oGridLayoutItem.getAttribute("hasheight")=="1"){arrKnownHeightItem.push(oGridLayoutItem);}else{arrUnknownHeightItem.push(oGridLayoutItem);}}}var totalHeight=oGridLayout.offsetHeight;for (var i=0;i<arrKnownHeightItem.length;i++){totalHeight-=arrKnownHeightItem[i].offsetHeight;}var height=totalHeight/arrUnknownHeightItem.length;height=parseInt(height);for (var i=0,n=arrUnknownHeightItem.length;i<n;i++){if (i==n-1){height=(totalHeight-height*(arrUnknownHeightItem.length-1));}if (height<0) height=0;arrUnknownHeightItem[i].style.height=height+"px";}}if (newWidth !=oGridLayout.oldWidth){var arrKnownWidthItem=new Array();var arrUnknownWidthItem=new Array();var arrKnownItemNum=new Array();var arrUnknownItemNum=new Array();for (var j=0;j<oGridLayout.childNodes.length;j++){var oGridLayoutRowItem=oGridLayout.childNodes[j];if (oGridLayoutRowItem.id&&oGridLayoutRowItem.id.indexOf(id) !=-1&&oGridLayoutRowItem.getAttribute("hasheight")&&oGridLayoutRowItem.getAttribute("hasheight") !=""){for (var i=0;i<oGridLayoutRowItem.childNodes.length;i++){var oGridLayoutItem=oGridLayoutRowItem.childNodes[i];if (oGridLayoutItem.id&&oGridLayoutItem.id.indexOf(id) !=-1&&oGridLayoutItem.getAttribute("haswidth")&&oGridLayoutItem.getAttribute("haswidth") !=""){if (oGridLayoutItem.getAttribute("haswidth")=="1"){arrKnownWidthItem.push(oGridLayoutItem);if (arrKnownItemNum.indexOf(i)==-1) arrKnownItemNum.push(i);}else{arrUnknownWidthItem.push(oGridLayoutItem);if (arrUnknownItemNum.indexOf(i)==-1) arrUnknownItemNum.push(i);}}}}}var totalWidth=oGridLayout.offsetWidth;for (var i=0;i<arrKnownItemNum.length;i++){totalWidth-=arrKnownWidthItem[i].offsetWidth;}var width=totalWidth/(arrUnknownItemNum.length==0 ? 1:arrUnknownItemNum.length);width=parseInt(width);var lastWidth=(totalWidth-width*(arrUnknownItemNum.length-1));lastWidth=lastWidth<0 ? 0:lastWidth;var specialWidth=(lastWidth-0.5)<0 ? 0:(lastWidth-0.5);for (var i=0,n=arrUnknownWidthItem.length;i<n;i++){if ((i % arrUnknownItemNum.length)==1){if (!IS_IE || IS_IE8) arrUnknownWidthItem[i].style.width=specialWidth+"px";else arrUnknownWidthItem[i].style.width=lastWidth+"px";}else{arrUnknownWidthItem[i].style.width=(width<0 ? 0:width)+"px";}}}oGridLayout.oldHeight=oGridLayout.offsetHeight;oGridLayout.oldWidth=oGridLayout.offsetWidth;};function cardResize(e){var oCard=this;var childDivArray=oCard.childNodes;for (var i=0,n=childDivArray.length;i<n;i++){var childDiv=childDivArray[i];if (childDiv.nodeName.toLowerCase()=="div"&&childDiv.getAttribute("hasWidth") !=1&&childDiv.getAttribute("hasHeight") !=1){if(IS_IE7&&childDiv.style.position=="absolute"){continue;}childDiv.style.width=oCard.offsetWidth+"px";if (childDiv.style.height.indexOf('%')==-1) childDiv.style.height=oCard.offsetHeight+"px";}}};function addLayoutMonitor(obj){if (obj !=null) layoutMonitorArray.push(obj);};function removeLayoutMonitor(obj){var i=layoutMonitorArray.indexOf(obj);if (i !=-1) layoutMonitorArray.splice(i,1);};function initLayoutMonitorState(){for (var i=0;i<layoutMonitorArray.length;i++){if (layoutMonitorArray[i].scrollHeight==layoutMonitorArray[i].offsetHeight) layoutMonitorArray[i].vScroll=false;else layoutMonitorArray[i].vScroll=true;}};function executeLayoutMonitor(){for (var i=0;i<layoutMonitorArray.length;i++){if (layoutMonitorArray[i].vScroll==null) return;if (layoutMonitorArray[i].scrollHeight==layoutMonitorArray[i].offsetHeight){if (layoutMonitorArray[i].vScroll==true){layoutInitFunc();return;}}else{if (layoutMonitorArray[i].vScroll==false){layoutInitFunc();return;}}}};

var EventContextConstant=new Object;EventContextConstant.eventcontext="e";EventContextConstant.parentcontext="pe";EventContextConstant.params="ps";EventContextConstant.groupparams="gps";EventContextConstant.param="p";EventContextConstant.key="k";EventContextConstant.value="v";EventContextConstant.context="c";EventContextConstant.changedcontext="cc";EventContextConstant.attributes="as";EventContextConstant.attribute="a";EventContextConstant.res_parameters="dsps";EventContextConstant.req_parameters="dqps";EventContextConstant.parameter="dp";EventContextConstant.NULL="。";EventContextConstant.records="rs";EventContextConstant.record="r";EventContextConstant.erecord="er";EventContextConstant.drecord="dr";ServerProxy.PROXY_ARRAY=new Array();ServerProxy.PROXYRETURN_EXECUTING=0;ServerProxy.PROXYLIST_EXECUTING=false;PageUI.prototype=new ListenerUtil;function PageUI(title){ListenerUtil.call(this,true);this.title=title;this.widgetMap=new HashMap();this.dialogMap=new HashMap();this.connMap=new HashMap();this.attributeMap=new HashMap();this.cardMap=new HashMap();this.tabMap=new HashMap();this.panelMap=new HashMap();this.hasChanged=false;this.exParams=new HashMap();this.plugOutMap=new HashMap();this.PROXY_ARRAY=new Array();this.PROXYRETURN_EXECUTING=0;this.PROXYLIST_EXECUTING=false;};getProxyArray=function(){if (typeof(pageUI) !='undefined') return pageUI.PROXY_ARRAY;else return ServerProxy.PROXY_ARRAY;};getProxyReturnExecuting=function(){if (typeof(pageUI) !='undefined') return pageUI.PROXYRETURN_EXECUTING;else return ServerProxy.PROXYRETURN_EXECUTING;};proxyReturnExecutingAdd=function(){if (typeof(pageUI) !='undefined') pageUI.PROXYRETURN_EXECUTING++;else ServerProxy.PROXYRETURN_EXECUTING++;};proxyReturnExecutingSub=function(){if (typeof(pageUI) !='undefined') pageUI.PROXYRETURN_EXECUTING--;else ServerProxy.PROXYRETURN_EXECUTING--;};getProxyListExecuting=function(){if (typeof(pageUI) !='undefined') return pageUI.PROXYLIST_EXECUTING;else return ServerProxy.PROXYLIST_EXECUTING;};setProxyListExecuting=function(executing){if (typeof(pageUI) !='undefined') pageUI.PROXYLIST_EXECUTING=executing;else ServerProxy.PROXYLIST_EXECUTING=executing;};PageUI.prototype.getContext=function(submitRule){var context=new Object;context.c="PageUIContext";context.hasChanged=this.hasChanged;var contextXmlArray=new Array();contextXmlArray.push("<"+EventContextConstant.context+">");contextXmlArray.push(toJSON(context));contextXmlArray.push("</"+EventContextConstant.context+">");if (submitRule !=null){var widgets=this.widgetMap.values();if (widgets !=null&&widgets.length>0){for ( var i=0;i<widgets.length;i++){var widget=widgets[i];if (widget.id==null) continue;contextXmlArray.push("<widget id=\"" + widget.id + "\">");var widgetRule=submitRule.getWidgetRule(widget.id);contextXmlArray.push(widget.getContext(widgetRule));contextXmlArray.push("</widget>");}}}return contextXmlArray.join("");};PageUI.prototype.getChangedContext=function(){var context=new Object;context.hasChanged=this.hasChanged;var widgets=this.widgetMap.values();if (widgets !=null&&widgets.length>0){for ( var i=0;i<widgets.length;i++){var widget=widgets[i];if (widget.id==null) continue;var ctx=null;ctx=widget.getChangedContext();if(ctx==null) continue;if (context["widgets"]==null) context["widgets"]=new Array();context["widgets"].push(ctx);}}return context;};PageUI.prototype.setChangedContext=function(context){if (context==null) return;if (typeof(context.hasChanged) !='undefined'){this.setChanged(context.hasChanged);}if (typeof(context.widgets) !='undefined'){var widgets=context.widgets;for (var i=0;i<widgets.length;i++){var widgetCtx=widgets[i];var widget=this.getWidget(widgetCtx.id);if (widget !=null) widget.setChangedContext(widgetCtx);}}};PageUI.prototype.addWidget=function(widget){this.widgetMap.put(widget.id,widget);};PageUI.prototype.removeWidget=function(id){var widget=this.widgetMap.remove(id);if(widget !=null){widget.destroySelf();widget=null;}};PageUI.prototype.getWidget=function(widgetId){return this.widgetMap.get(widgetId);};PageUI.prototype.getWidgets=function(){return this.widgetMap.values();};PageUI.prototype.addDialog=function(id,dialog){this.dialogMap.put(id,dialog);};PageUI.prototype.removeDialog=function(id){var dialog=this.dialogMap.remove(id);if(dialog !=null){}};PageUI.prototype.getDialog=function(id){return this.dialogMap.get(id);};PageUI.prototype.getDialogs=function(){return this.dialogMap.values();};PageUI.prototype.addAttribute=function(name,value){this.attributeMap.put(name,value);};PageUI.prototype.getAttribute=function(name){return this.attributeMap.get(name);};PageUI.prototype.addConnector=function(conn){var arr=this.connMap.get(conn.source);if (arr==null){arr=new Array;this.connMap.put(conn.source,arr);}arr.push(conn);};PageUI.prototype.getConnectors=function(source,signal){var arr=this.connMap.get(source);if (arr==null) return null;var connArr=new Array;for ( var i=0;i<arr.length;i++){if (arr[i].signal==signal) connArr.push(arr[i]);}return connArr;};PageUI.prototype.$beforePageInit=function(){this.doEventFunc("beforePageInit");adjustContainerFramesHeight(true);};PageUI.prototype.$afterPageInit=function(){var widgets=this.getWidgets();if(widgets !=null&&widgets.length>0){for(var i=0;i<widgets.length;i++){widgets[i].onBeforeShow();}}this.doEventFunc("afterPageInit");adjustContainerFramesHeight(true);};PageUI.prototype.$beforeInitData=function(){var wds=this.getWidgets();for ( var i=0;i<wds.length;i++){wds[i].$beforeInitData();}};PageUI.prototype.destroySelf=function(){var widgets=pageUI.getWidgets();for (var i=0,n=widgets.length;i<n;i++){widgets[i].destroySelf();}this.widgetMap.clear();this.widgetMap=null;this.dialogMap.clear();this.dialogMap=null;this.connMap.clear();this.connMap=null;this.attributeMap.clear();this.attributeMap=null;this.cardMap.clear();this.cardMap=null;this.tabMap.clear();this.tabMap=null;this.panelMap.clear();this.panelMap=null;this.exParams.clear();this.exParams=null;this.plugOutMap.clear();this.plugOutMap=null;for(var i in this){this[i]=null;}};PageUI.prototype.updateInitedWidgets=function(){this.$beforeInitData();};PageUI.prototype.$externalInit=function(){this.doEventFunc("externalInit");};PageUI.prototype.$beforeActive=function(){this.doEventFunc("beforeActive");};PageUI.prototype.$onClosing=function(){return this.doEventFunc("onClosing");};PageUI.prototype.$onClosed=function(){this.doEventFunc("onClosed");};PageUI.prototype.beforeDialogClose=function(){var result=this.doEventFunc("beforeDialogClose");if (result===false) return false;return true;};PageUI.prototype.onerror=function(msg,url,line){showMessageDialog(msg);};PageUI.prototype.addTab=function(tab){this.tabMap.put(tab.id,tab);};PageUI.prototype.getTab=function(id){return this.tabMap.get(id);};PageUI.prototype.addCard=function(card){this.cardMap.put(card.id,card);};PageUI.prototype.getCard=function(id){return this.cardMap.get(id);};PageUI.prototype.addPanel=function(panel){this.panelMap.put(panel.id,panel);};PageUI.prototype.getPanel=function(id){return this.panelMap.get(id);};PageUI.prototype.removePanel=function(id){this.panelMap.remove(id);};PageUI.prototype.getPlugOut=function(id){return this.plugOutMap.get(id);};PageUI.prototype.addPlugOut=function(plugout){this.plugOutMap.put(plugout.id,plugout);};PageUI.prototype.showCloseConfirm=function(obj){if (this.hasChanged==true){var topWin=getLfwTop();if (topWin==null) topWin=getTrueParent();if(!window.SaveAndExit){topWin.require("confirmdialog",function(){topWin.ConfirmDialogComp.showDialog(trans("ml_confirm_close_dialog"),PageUI.okClose,null,obj,null)});return false;}else{topWin.require("threebuttondialog",function(){topWin.ThreeButtonsDialog.showDialog(trans("ml_confirm_save_dialog"),window.SaveAndExit,null,PageUI.okClose,[trans("ml_save"),trans("ml_does_not_save"),trans("ml_cancel")],obj)});return false;}}else{return true;}};PageUI.okClose=function(obj){obj.onClosing();obj.hide();obj.onAfterClose();};PageUI.prototype.closeSilent=function(obj){pageUI.hasChanged=false;closeWinWithNoWarn();};PageUI.prototype.toClose=function(){var result=this.$onClosing();if (result==false) return false;else this.$onClosed();};PageUI.prototype.setChanged=function(hasChanged){this.hasChanged=hasChanged;};PageUI.prototype.hasChanged=function(){return this.hasChanged;};function Connector(id,source,target,signal,slot){this.id=id;this.source=source;this.target=target;this.signal=signal;this.slot=slot;};function SubmitRule(){this.widgetRuleMap=null;this.tabSubmit=false;this.cardSubmit=false;this.panelSubmit=false;this.parentSubmitRule=null;this.paramMap=null;};SubmitRule.prototype.clone=function(){var submitRule=new SubmitRule();if (this.widgetRuleMap !=null){var keys=this.widgetRuleMap.keySet();if (keys !=null){for ( var i=0;i<keys.length;i++){var widgetRule=this.widgetRuleMap.get(keys[i]).clone();submitRule.addWidgetRule(keys[i],widgetRule);}}}if (this.parentSubmitRule !=null){var parentSubmitRule=this.parentSubmitRule.clone();submitRule.setParentSubmitRule(parentSubmitRule);}if (this.paramMap !=null){var keys=this.paramMap.keySet();if (keys !=null){for ( var i=0;i<keys.length;i++){var value=this.paramMap.get(keys[i]);submitRule.addParam(keys[i],value);}}}return submitRule;};SubmitRule.prototype.addParam=function(key,value){if (this.paramMap==null) this.paramMap=new HashMap();this.paramMap.put(key,value);};SubmitRule.prototype.getParamMap=function(){return this.paramMap;};SubmitRule.prototype.setParentSubmitRule=function(submitRule){this.parentSubmitRule=submitRule;};SubmitRule.prototype.addWidgetRule=function(id,widgetRule){if (this.widgetRuleMap==null) this.widgetRuleMap=new HashMap;this.widgetRuleMap.put(id,widgetRule);};SubmitRule.prototype.getWidgetRule=function(id){if (this.widgetRuleMap==null) return null;return this.widgetRuleMap.get(id);};SubmitRule.prototype.setTabSubmit=function(submit){this.tabSubmit=submit;};SubmitRule.prototype.getTabSubmit=function(){return this.tabSubmit;};SubmitRule.prototype.setCardSubmit=function(submit){this.cardSubmit=submit;};SubmitRule.prototype.getCardSubmit=function(){return this.cardSubmit;};SubmitRule.prototype.setPanelSubmit=function(submit){this.panelSubmit=submit;};SubmitRule.prototype.getPanelSubmit=function(){return this.panelSubmit;};function WidgetRule(id){this.id=id;this.dsRuleMap=null;this.treeRuleMap=null;this.gridRuleMap=null;this.tabSubmit=false;this.cardSubmit=false;this.panelSubmit=false;};WidgetRule.prototype.clone=function(){var widgetRule=new WidgetRule(this.id);if (this.dsRuleMap !=null){var keys=this.dsRuleMap.keySet();if (keys !=null){for ( var i=0;i<keys.length;i++){var dsRule=this.dsRuleMap.get(keys[i]);if (dsRule){dsRule=dsRule.clone();widgetRule.addDsRule(keys[i],dsRule);}}}}if (this.treeRuleMap !=null){var keys=this.treeRuleMap.keySet();if (keys !=null){for ( var i=0;i<keys.length;i++){var treeRule=this.treeRuleMap.get(keys[i]);if (treeRule){treeRule=treeRule.clone();widgetRule.addTreeRule(keys[i],treeRule);}}}}return widgetRule;};WidgetRule.prototype.addDsRule=function(id,dsRule){if (this.dsRuleMap==null) this.dsRuleMap=new HashMap();this.dsRuleMap.put(id,dsRule);};WidgetRule.prototype.removeDsRule=function(id){if (this.dsRuleMap==null) return;this.dsRuleMap.remove(id);};WidgetRule.prototype.setTabSubmit=function(submit){this.tabSubmit=submit;};WidgetRule.prototype.getTabSubmit=function(){return this.tabSubmit;};WidgetRule.prototype.setCardSubmit=function(submit){this.cardSubmit=submit;};WidgetRule.prototype.getCardSubmit=function(){return this.cardSubmit;};WidgetRule.prototype.setPanelSubmit=function(submit){this.panelSubmit=submit;};WidgetRule.prototype.getPanelSubmit=function(){return this.panelSubmit;};WidgetRule.prototype.getId=function(){return this.id;};WidgetRule.prototype.addGridRule=function(id,grid){if (this.gridRuleMap==null) this.gridRuleMap=new HashMap();this.gridRuleMap.put(id,grid);};WidgetRule.prototype.getGridRule=function(id){if (this.gridRuleMap==null) return null;return this.gridRuleMap.get(id);};WidgetRule.prototype.addTreeRule=function(id,tree){if (this.treeRuleMap==null) this.treeRuleMap=new HashMap();this.treeRuleMap.put(id,tree);};WidgetRule.prototype.getTreeRule=function(id){if (this.treeRuleMap==null) return null;return this.treeRuleMap.get(id);};WidgetRule.prototype.getDsRule=function(id){if (this.dsRuleMap==null) return null;return this.dsRuleMap.get(id);};WidgetRule.prototype.getFormRule=function(id){if (this.formRuleMap==null) return null;return this.formRuleMap.get(id);};WidgetRule.prototype.addFormRule=function(id,form){if (this.formRuleMap==null) this.formRuleMap=new HashMap();this.formRuleMap.put(id,form);};function DatasetRule(id,type){this.id=id;this.type=type;};DatasetRule.prototype.clone=function(){var dsRule=new DatasetRule(this.id,this.type);return dsRule;};DatasetRule.prototype.getId=function(){return this.id;};DatasetRule.prototype.getType=function(){return this.type;};function TreeRule(id,type){this.id=id;this.type=type;};TreeRule.prototype.clone=function(){var treeRule=new TreeRule(this.id,this.type);return treeRule;};TreeRule.prototype.getId=function(){return this.id;};TreeRule.prototype.getType=function(){return this.type;};function GridRule(id,type){this.id=id;this.type=type;};GridRule.prototype.getId=function(){return this.id;};GridRule.prototype.getType=function(){return this.type;};function FormRule(id,type){this.id=id;this.type=type;};FormRule.prototype.getId=function(){return this.id;};FormRule.prototype.getType=function(){return this.type;};function ServerProxy(listener,eventName,async){this.params=new HashMap();this.returnParams=new HashMap();this.returnFunc=null;this.submitRule=null;this.eventName=eventName;this.listener=listener;this.async=async;this.nmc=true;};ServerProxy.prototype.destroySelf=function(){this.submitRule=null;this.params=null;this.returnFunc=null;this.eventName=null;this.listener=null;};ServerProxy.prototype.setNmc=function(nmc){this.nmc=nmc;};ServerProxy.prototype.setAsync=function(async){this.async=async;};ServerProxy.prototype.setParamMap=function(paramsMap){this.params=paramsMap;};ServerProxy.prototype.addParam=function(key,value){this.params.put(key,value);};ServerProxy.prototype.setSubmitRule=function(submitRule){this.submitRule=submitRule;};ServerProxy.prototype.setReturnArgs=function(returnArgs){this.returnArgs=returnArgs;};ServerProxy.prototype.setReturnFunc=function(returnFunc){this.returnFunc=returnFunc;};ServerProxy.prototype.getSubmitRule=function(){var useSubmitRule=this.submitRule;if (useSubmitRule==null&&this.listener !=null){useSubmitRule=this.listener.submitRule;}if (useSubmitRule==null) useSubmitRule=new SubmitRule();this.submitRule=useSubmitRule;return this.submitRule;};ServerProxy.prototype.getParamString=function(useSubmitRule){var contextXmlArray=new Array();contextXmlArray.push("<"+EventContextConstant.params+">");if (this.listener !=null){if (this.listener.source_id !=null){contextXmlArray.push("<"+EventContextConstant.param+">");contextXmlArray.push("<"+EventContextConstant.key+">source_id</"+EventContextConstant.key+">");contextXmlArray.push("<"+EventContextConstant.value+">"+this.listener.source_id+"</"+EventContextConstant.value+">");contextXmlArray.push("</"+EventContextConstant.param+">");}if (this.listener.listener_id !=null){contextXmlArray.push("<"+EventContextConstant.param+">");contextXmlArray.push("<"+EventContextConstant.key+">listener_id</"+EventContextConstant.key+">");contextXmlArray.push("<"+EventContextConstant.value+">"+this.listener.listener_id+"</"+EventContextConstant.value+">");contextXmlArray.push("</"+EventContextConstant.param+">");}if (this.listener.widget_id !=null){contextXmlArray.push("<"+EventContextConstant.param+">");contextXmlArray.push("<"+EventContextConstant.key+">widget_id</"+EventContextConstant.key+">");contextXmlArray.push("<"+EventContextConstant.value+">"+this.listener.widget_id+"</"+EventContextConstant.value+">");contextXmlArray.push("</"+EventContextConstant.param+">");}if (this.eventName !=null){contextXmlArray.push("<"+EventContextConstant.param+">");contextXmlArray.push("<"+EventContextConstant.key+">event_name</"+EventContextConstant.key+">");contextXmlArray.push("<"+EventContextConstant.value+">"+this.eventName+"</"+EventContextConstant.value+">");contextXmlArray.push("</"+EventContextConstant.param+">");}if (this.listener.source_type !=null){contextXmlArray.push("<"+EventContextConstant.param+">");contextXmlArray.push("<"+EventContextConstant.key+">source_type</"+EventContextConstant.key+">");contextXmlArray.push("<"+EventContextConstant.value+">"+this.listener.source_type+"</"+EventContextConstant.value+">");contextXmlArray.push("</"+EventContextConstant.param+">");}if (this.listener.parent_source_id !=null){contextXmlArray.push("<"+EventContextConstant.param+">");contextXmlArray.push("<"+EventContextConstant.key+">parent_source_id</"+EventContextConstant.key+">");contextXmlArray.push("<"+EventContextConstant.value+">"+this.listener.parent_source_id+"</"+EventContextConstant.value+">");contextXmlArray.push("</"+EventContextConstant.param+">");}}if (this.params !=null&&this.params.size()>0){var keySet=this.params.keySet();var size=this.params.size();for ( var i=0;i<size;i++){var key=keySet[i];var value=this.params.get(key);if (value==null) value="";else if (typeof value=="string"){value=value.replace(/\&/g,"&amp;");value=value.replace(/\</g,"&lt;");}contextXmlArray.push("<"+EventContextConstant.param+">");contextXmlArray.push("<"+EventContextConstant.key+">"+key+"</"+EventContextConstant.key+">");contextXmlArray.push("<"+EventContextConstant.value+">"+value+"</"+EventContextConstant.value+">");contextXmlArray.push("</"+EventContextConstant.param+">");}}if (pageUI.hasChanged !=null){contextXmlArray.push("<"+EventContextConstant.param+">");contextXmlArray.push("<"+EventContextConstant.key+">hasChanged</"+EventContextConstant.key+">");contextXmlArray.push("<"+EventContextConstant.value+">"+pageUI.hasChanged+"</"+EventContextConstant.value+">");contextXmlArray.push("</"+EventContextConstant.param+">");}var paramMap=useSubmitRule.getParamMap();if (paramMap !=null){var keys=paramMap.keySet();for ( var i=0;i<keys.length;i++){var key=keys[i];var value=paramMap.get(key);if (value==null) value=getParameter(value);if (value==null) value=getSessionAttribute(value);if (value==null) value="";contextXmlArray.push("<"+EventContextConstant.param+">");contextXmlArray.push("<"+EventContextConstant.key+">"+key+"</"+EventContextConstant.key+">");contextXmlArray.push("<"+EventContextConstant.value+">"+value+"</"+EventContextConstant.value+">");contextXmlArray.push("</"+EventContextConstant.param+">");}}contextXmlArray.push("</"+EventContextConstant.params+">");return contextXmlArray.join("");};ServerProxy.prototype.getPageCtxStr=function(useSubmitRule){var contextXmlArray=new Array;contextXmlArray.push(pageUI.getContext(useSubmitRule));return contextXmlArray.join("");};ServerProxy.prototype.getParentPageCtxStr=function(useSubmitRule){if (useSubmitRule !=null&&useSubmitRule.parentSubmitRule !=null){var contextXmlArray=new Array;contextXmlArray.push("<"+EventContextConstant.parentcontext+">");if(typeof(getTrueParent().getPageId)=="function"){contextXmlArray.push("<"+EventContextConstant.eventcontext+" id='"+getTrueParent().getPageId()+"'>");}else{contextXmlArray.push("<"+EventContextConstant.eventcontext+" id=''>");}if(typeof(getTrueParent().pageUI) !='undefined'&&getTrueParent().pageUI !=null){contextXmlArray.push(getTrueParent().pageUI.getContext(useSubmitRule.parentSubmitRule));}contextXmlArray.push("</"+EventContextConstant.eventcontext+">");contextXmlArray.push("</"+EventContextConstant.parentcontext+">");return contextXmlArray.join("");}return "";};ServerProxy.prototype.execute=function(){if (pageUI.exParams.size()>0){var keySet=pageUI.exParams.keySet();var size=pageUI.exParams.size();for ( var i=0;i<size;i++){var key=keySet[i];var value=pageUI.exParams.get(key);this.addParam(key,value);}pageUI.exParams.clear();}if (getProxyReturnExecuting()>0){getProxyArray().push(this);setTimeout("ServerProxy.execServerProxyList()",100);return;}if (getProxyArray().length>0){getProxyArray().push(this);ServerProxy.execServerProxyList();return;}proxyReturnExecutingAdd();var useSubmitRule=this.getSubmitRule();var contextXmlArray=new Array;contextXmlArray.push("<root><"+EventContextConstant.eventcontext+" id=\"" + getPageId() + "\">");contextXmlArray.push(this.getParamString(useSubmitRule));contextXmlArray.push(this.getPageCtxStr(useSubmitRule));contextXmlArray.push("<"+EventContextConstant.changedcontext+">");contextXmlArray.push(toJSON(pageUI.getChangedContext()).replace(/\&/g,"&amp;").replace(/\</g,"&lt;"));contextXmlArray.push("</"+EventContextConstant.changedcontext+">");contextXmlArray.push("</"+EventContextConstant.eventcontext+">");contextXmlArray.push(this.getParentPageCtxStr(useSubmitRule));contextXmlArray.push("</root>");var contextXml=contextXmlArray.join("");var innerArgsList=[[this.returnArgs,this.returnFunc]];showDefaultLoadingBar();clearChangedData();ServerProxy.proxyCall(contextXml,innerArgsList,this.async,this.nmc);};ServerProxy.compressRequest=function(contextXml){return compress(contextXml);};ServerProxy.proxyCall=function(contextXml,innerArgsList,async,nmc){var requestXml="type=processEvent"+(nmc==false ? "&nonmc=1":"")+"&xml=";var result=null;if (window.debugMode==null || window.debugMode==false) result=ServerProxy.compressRequest(contextXml);if(result==null) requestXml+=encodeURIComponent(contextXml);else{requestXml+=encodeURIComponent(result);requestXml+="&compress=1&compressl="+contextXml.length;}var ajax=new Ajax();ajax.setPath(getCorePath());ajax.setQueryStr(requestXml);ajax.setReturnFunc(ServerProxy.$returnFun);ajax.setReturnArgs(innerArgsList);return ajax.post(async==null ? true:async,true);};ServerProxy.$returnFun=function(xmlHttpReq,returnArgsList,exception,ajaxObj){var execList=[];setReturning(true);try{if (handleException(xmlHttpReq,exception,returnArgsList,ajaxObj)){var userArgs=returnArgsList[0][0];var doc=xmlHttpReq.responseXML;var rootNode=doc.documentElement;var contentsNode=rootNode.selectSingleNode("contents");var contentNodes=contentsNode.selectNodes("content");var result=true;if (contentNodes !=null){for ( var i=0,count=contentNodes.length;i<count;i++){var content=getNodeValue(contentNodes[i]);content=content.replaceAll("<CD>","<![CDATA[");content=content.replaceAll("</CD>","]]>");var resultDoc=createXmlDom(content);var eventContextNode=resultDoc.documentElement;var isPlug=eventContextNode.selectSingleNode("isPlug");if (isPlug !=null&&(isPlug.text=="true"|| isPlug.textContent=="true")&&window.isPopView !=null&&window.isPopView==true){if(getTrueParent().ServerProxy){content=getTrueParent().ServerProxy.$updateCtx(eventContextNode,userArgs,false);}else{content=ServerProxy.$updateCtx(eventContextNode,userArgs,false);}}else content=ServerProxy.$updateCtx(eventContextNode,userArgs,false);var afterExecNode=eventContextNode.selectSingleNode("afterExec");if (afterExecNode !=null){var script=getNodeValue(afterExecNode);if (script !=null&&script !=""){execList.push(script);}}}}for(var i=0;i<returnArgsList.length-1;i++){var args=returnArgsList[i];var returnFunc=args[1];var userArg=args[0];if (returnFunc !=null) returnFunc.call(this,userArg,true);}for(var i=0;i<execList.length;i++){if (typeof execList[i] !="undefined") eval(execList[i]);}hideDefaultLoadingBar();return result;}hideDefaultLoadingBar();}catch(e){Logger.error(e);}finally{setReturning(false);proxyReturnExecutingSub();adjustContainerFramesHeight();}};ServerProxy.wrapProxy=function(proxy){if (pageUI.exParams.size()>0){var keySet=pageUI.exParams.keySet();var size=pageUI.exParams.size();for ( var i=0;i<size;i++){var key=keySet[i];var value=pageUI.exParams.get(key);proxy.addParam(key,value);}}if(ServerProxy.suspend){getProxyArray().push(proxy);}else{ServerProxy.cleanProxy();}};ServerProxy.cleanProxy=function(){ServerProxy.suspend=false;ServerProxy.execServerProxyList();};ServerProxy.execServerProxyList=function(){if (getProxyListExecuting()==true){setTimeout("ServerProxy.execServerProxyList()",100);return;}setProxyListExecuting(true);try{ServerProxy.aggregateProxyRequest();}finally{setProxyListExecuting(false);}};ServerProxy.aggregateProxyRequest=function(){if (getProxyReturnExecuting()>0){setTimeout("ServerProxy.execServerProxyList()",100);return;}proxyReturnExecutingAdd();var count=getProxyArray().length;if(count==0){proxyReturnExecutingSub();return;}var submitRules=[];var paramList=[];var innerArgsList=[];var async=true;var i=0;var nmc=true;while(getProxyArray().length>0){var proxy=getProxyArray()[0];if(proxy.nmc==false) nmc=false;var rule=proxy.getSubmitRule();var arr=[];var args=proxy.returnArgs;var func=proxy.returnFunc;if(innerArgsList.length==0 || (args==null&&func==null)){submitRules.push(rule);paramList[i]=proxy.getParamString(rule);arr.push(args);arr.push(func);getProxyArray().splice(0,1);innerArgsList[i]=arr;async=(async&&proxy.async);proxy.destroySelf();}else{break;}i++;}var useSubmitRule=ServerProxy.mergeSubmitRules(submitRules);var contextXmlArray=new Array;contextXmlArray.push("<root><"+EventContextConstant.eventcontext+" id=\"" + getPageId() + "\">");contextXmlArray.push("<"+EventContextConstant.groupparams+">");for(var i=0;i<count;i++){contextXmlArray.push(paramList[i]);}contextXmlArray.push("</"+EventContextConstant.groupparams+">");contextXmlArray.push(pageUI.getContext(useSubmitRule));contextXmlArray.push("<"+EventContextConstant.changedcontext+">");contextXmlArray.push(toJSON(pageUI.getChangedContext()).replace(/\&/g,"&amp;").replace(/\</g,"&lt;"));contextXmlArray.push("</"+EventContextConstant.changedcontext+">");contextXmlArray.push("</"+EventContextConstant.eventcontext+">");if (useSubmitRule !=null&&useSubmitRule.parentSubmitRule !=null){contextXmlArray.push("<"+EventContextConstant.parentcontext+">");if(typeof(getTrueParent().getPageId)=="function"){contextXmlArray.push("<"+EventContextConstant.eventcontext+" id='"+getTrueParent().getPageId()+"'>");}else{contextXmlArray.push("<"+EventContextConstant.eventcontext+" id=''>");}if(typeof(getTrueParent().pageUI) !='undefined'&&getTrueParent().pageUI !=null){contextXmlArray.push(getTrueParent().pageUI.getContext(useSubmitRule.parentSubmitRule));}contextXmlArray.push("</"+EventContextConstant.eventcontext+">");contextXmlArray.push("</"+EventContextConstant.parentcontext+">");}contextXmlArray.push("</root>");var contextXml=contextXmlArray.join("");showDefaultLoadingBar();if(getProxyArray().length>0) ServerProxy.execServerProxyList();clearChangedData();ServerProxy.proxyCall(contextXml,innerArgsList,async,nmc);};ServerProxy.mergeSubmitRules=function(rules){var submitRule=new SubmitRule();for (var i=0;i<rules.length;i++){var rule=rules[i].clone();ServerProxy.mergeSubmitRule(submitRule,rule);}return submitRule;};ServerProxy.mergeSubmitRule=function(targetSubmitRule,sourceSubmitRule){if (sourceSubmitRule==null) return;if (sourceSubmitRule.tabSubmit==true) targetSubmitRule.tabSubmit=true;if (sourceSubmitRule.cardSubmit==true) targetSubmitRule.cardSubmit=true;if (sourceSubmitRule.panelSubmit==true) targetSubmitRule.panelSubmit=true;if (targetSubmitRule.widgetRuleMap==null&&sourceSubmitRule.widgetRuleMap !=null) targetSubmitRule.widgetRuleMap=sourceSubmitRule.widgetRuleMap;else if (sourceSubmitRule.widgetRuleMap !=null){var keys=sourceSubmitRule.widgetRuleMap.keySet();if (keys !=null){for ( var i=0;i<keys.length;i++){var sourceWidgetRule=sourceSubmitRule.widgetRuleMap.get(keys[i]);if(sourceWidgetRule==null) continue;var targetWidgetRule=targetSubmitRule.widgetRuleMap.get(keys[i]);if (targetWidgetRule !=null) ServerProxy.mergeWidgetRule(targetWidgetRule,sourceWidgetRule);else targetSubmitRule.addWidgetRule(sourceWidgetRule.getId(),sourceWidgetRule);}}}if (targetSubmitRule.parentSubmitRule==null&&sourceSubmitRule.parentSubmitRule !=null) targetSubmitRule.parentSubmitRule=sourceSubmitRule.parentSubmitRule.clone();else if(sourceSubmitRule.parentSubmitRule !=null){ServerProxy.mergeSubmitRule(targetSubmitRule.parentSubmitRule,sourceSubmitRule.parentSubmitRule.clone());}};ServerProxy.mergeWidgetRule=function(targetWidgetRule,sourceWidgetRule){if (sourceWidgetRule==null) return;if (sourceWidgetRule.tabSubmit==true) targetWidgetRule.tabSubmit=true;if (sourceWidgetRule.cardSubmit==true) targetWidgetRule.cardSubmit=true;if (sourceWidgetRule.panelSubmit==true) targetWidgetRule.panelSubmit=true;if (targetWidgetRule.dsRuleMap==null) targetWidgetRule.dsRuleMap=sourceWidgetRule.dsRuleMap;else if (sourceWidgetRule.dsRuleMap !=null){var keys=sourceWidgetRule.dsRuleMap.keySet();if (keys !=null){for ( var i=0;i<keys.length;i++){var sourceDsRule=sourceWidgetRule.dsRuleMap.get(keys[i]);if(sourceDsRule==null) continue;var targetDsRule=targetWidgetRule.dsRuleMap.get(keys[i]);if (targetDsRule !=null) ServerProxy.mergeDsRule(targetDsRule,sourceDsRule);else targetWidgetRule.addDsRule(sourceDsRule.getId(),sourceDsRule);}}}if (targetWidgetRule.treeRuleMap==null) targetWidgetRule.treeRuleMap=sourceWidgetRule.treeRuleMap;else if (sourceWidgetRule.treeRuleMap !=null){var keys=sourceWidgetRule.treeRuleMap.keySet();if (keys !=null){for ( var i=0;i<keys.length;i++){var sourceTreeRule=sourceWidgetRule.treeRuleMap.get(keys[i]);if(sourceTreeRule==null) continue;var targetTreeRule=targetWidgetRule.treeRuleMap.get(keys[i]);if (targetTreeRule !=null) ServerProxy.mergeTreeRule(targetTreeRule,sourceTreeRule);else targetWidgetRule.addTreeRule(sourceTreeRule.getId(),sourceTreeRule);}}}if (targetWidgetRule.gridRuleMap==null) targetWidgetRule.gridRuleMap=sourceWidgetRule.gridRuleMap;else if (sourceWidgetRule.gridRuleMap !=null){var keys=sourceWidgetRule.gridRuleMap.keySet();if (keys !=null){for ( var i=0;i<keys.length;i++){var sourceGridRule=sourceWidgetRule.gridRuleMap.get(keys[i]);if(sourceGridRule==null) continue;var targetGridRule=targetWidgetRule.gridRuleMap.get(keys[i]);if (targetGridRule !=null) ServerProxy.mergeGridRule(targetGridRule,sourceGridRule);else targetWidgetRule.addGridRule(sourceGridRule.getId(),sourceGridRule);}}}if (targetWidgetRule.formRuleMap==null) targetWidgetRule.formRuleMap=sourceWidgetRule.formRuleMap;else if (sourceWidgetRule.formRuleMap !=null){var keys=sourceWidgetRule.formRuleMap.keySet();if (keys !=null){for ( var i=0;i<keys.length;i++){var sourceFormRule=sourceWidgetRule.formRuleMap.get(keys[i]);if(sourceFormRule==null) continue;var targetFormRule=targetWidgetRule.formRuleMap.get(keys[i]);if (targetFormRule !=null) ServerProxy.mergeFormRule(targetFormRule,sourceFormRule);else targetWidgetRule.addFormRule(sourceFormRule.getId(),sourceFormRule);}}}};ServerProxy.mergeDsRule=function(targetDsRule,sourceDsRule){var targetRuleValue=ServerProxy.getDsRuleValue(targetDsRule.type);var sourceRuleValue=ServerProxy.getDsRuleValue(sourceDsRule.type);if (targetRuleValue<sourceRuleValue) targetDsRule.type=sourceDsRule.type;else if (targetRuleValue==sourceRuleValue&&targetDsRule.type !=sourceDsRule.type) targetDsRule.type="ds_all_line";};ServerProxy.getDsRuleValue=function (type){if (type="ds_current_line") return 0;else if (type="ds_current_key") return 1;else if (type="ds_current_page") return 1;else if (type="ds_all_sel_line") return 1;else if (type="ds_all_line") return 2;else return-1;};ServerProxy.mergeTreeRule=function(targetTreeRule,sourceTreeRule){var targetRuleValue=ServerProxy.getTreeRuleValue(targetTreeRule.type);var sourceRuleValue=ServerProxy.getTreeRuleValue(sourceTreeRule.type);if (targetRuleValue<sourceRuleValue) targetTreeRule.type=sourceTreeRule.type;};ServerProxy.getTreeRuleValue=function (type){if (type="tree_current_parent") return 0;else if (type="tree_current_parent_children") return 1;else if (type="tree_all") return 2;else return-1;};ServerProxy.mergeGridRule=function(targetGridRule,sourceGridRule){var targetRuleValue=ServerProxy.getGridRuleValue(targetGridRule.type);var sourceRuleValue=ServerProxy.getGridRuleValue(sourceGridRule.type);if (targetRuleValue<sourceRuleValue) targetGridRule.type=sourceGridRule.type;};ServerProxy.getGridRuleValue=function (type){if (type="grid_current_row") return 0;else if (type="grid_all_row") return 1;else return-1;};ServerProxy.mergeFormRule=function(targetFormRule,sourceFormRule){var targetRuleValue=ServerProxy.getFormRuleValue(targetFormRule.type);var sourceRuleValue=ServerProxy.getFormRuleValue(sourceFormRule.type);if (targetRuleValue<sourceRuleValue) targetFormRule.type=sourceFormRule.type;};ServerProxy.getFormRuleValue=function (type){if (type="no_child") return 0;else if (type="all_child") return 1;else return-1;};PageUI.prototype.handleHotKey=function(key){var widgets=this.widgetMap.values();if (widgets !=null&&widgets.length>0){for ( var i=0;i<widgets.length;i++){var widget=widgets[i];var comps=widget.getComponents();for ( var j=0,m=comps.length;j<m;j++){var comp=comps[j];if (comp.componentType=="TOOLBAR"|| comp.componentType=="BUTTON"){var obj=comp.handleHotKey(key);if (obj !=null) return obj;}}var menus=widget.getMenus();for ( var j=0,m=menus.length;j<m;j++){var menu=menus[j];var obj=menu.handleHotKey(key);if (obj !=null) return obj;}}}return null;};ServerProxy.$updateCtx=function(eventContextNode,userArgs,isParent){if(!window.pageUI){return;}var nowUI=window.pageUI;if (isParent){nowUI=getTrueParent().pageUI;}var result=true;var resultNode=eventContextNode.selectSingleNode("result");if (resultNode !=null){var rv=getNodeValue(resultNode);if (rv=="false") result=false;}var beforeExecNode=eventContextNode.selectSingleNode("beforeExec");if (beforeExecNode !=null){var script=getNodeValue(beforeExecNode);if (script !=null&&script !=""){eval(script);}}var attrNodes=eventContextNode.selectSingleNode(EventContextConstant.attributes);if (attrNodes !=null){var attrs=attrNodes.selectNodes(EventContextConstant.attribute);if (attrs !=null&&attrs.length>0){for ( var i=0;i<attrs.length;i++){var node=attrs[i];var keyNode=node.selectSingleNode(EventContextConstant.key);var valueNode=node.selectSingleNode(EventContextConstant.value);var key=getNodeValue(keyNode);var value=getNodeValue(valueNode);setSessionAttribute(key,value);}}}var pagemeta=eventContextNode.selectSingleNode("pagemeta");var beforeExecNode=pagemeta.selectSingleNode("beforeExec");if (beforeExecNode !=null){var script=getNodeValue(beforeExecNode);if (script !=null&&script !=""){eval(script);}}var widgetNodes=pagemeta.selectNodes("widget");if (widgetNodes !=null){for ( var k=0;k<widgetNodes.length;k++){var widgetNode=widgetNodes[k];var widgetId=getNodeAttribute(widgetNode,"id");var widget=nowUI.getWidget(widgetId);if (widget==null) continue;var childNodes=widgetNode.childNodes;if (childNodes !=null){for ( var j=0;j<childNodes.length;j++){var child=childNodes[j];if (!IS_IE){if (child.nodeName=="#text") continue;}if (child.nodeName==EventContextConstant.context) continue;if (child.nodeName=="dataset"){var dsId=getNodeAttribute(child,"id");var ds=widget.getDataset(dsId);if (ds==null) continue;var data=child.selectSingleNode("data");var dataXml=getNodeValue(data);ds.setData(dataXml,userArgs);}}}}}var changedJsonNode=pagemeta.selectSingleNode(EventContextConstant.changedcontext);if (changedJsonNode !=null){var contextStr=getNodeValue(changedJsonNode);if (contextStr !=null&&contextStr !=""){eval("var context = "+contextStr);nowUI.setChangedContext(context);}}var execNode=pagemeta.selectSingleNode("exec");if (execNode !=null){var script=getNodeValue(execNode);if (script !=null&&script !=""){eval(script);}}var execNode=eventContextNode.selectSingleNode("exec");if (execNode !=null){var script=getNodeValue(execNode);if (script !=null&&script !=""){eval(script);}}var pctx=eventContextNode.selectSingleNode(EventContextConstant.parentcontext);if (pctx !=null){var pctxResult=pctx.selectSingleNode(EventContextConstant.eventcontext);if(getTrueParent() !=null){getTrueParent().proxyReturnExecutingAdd();try{getTrueParent().ServerProxy.$updateCtx(pctxResult,null,false);}finally{getTrueParent().proxyReturnExecutingSub();}}}return result;};function triggerPlugout(widgetId,plugoutId){var plugout=pageUI.getWidget(widgetId).getPlugOut(plugoutId);if (plugout==null) return;var proxy=new ServerProxy();proxy.addParam("widget_id",widgetId);proxy.addParam("plug","1");proxy.addParam("plugsource",widgetId);proxy.addParam("plugid",plugoutId);proxy.addParam("plugtype","view");if (plugout.submitRule !=null) proxy.submitRule=plugout.submitRule;proxy.execute();}function triggerWinPlugout(plugoutId){var plugout=pageUI.getPlugOut(plugoutId);if (plugout==null) return;var proxy=new ServerProxy();proxy.addParam("plug","1");proxy.addParam("plugsource",pageUI.title);proxy.addParam("plugid",plugoutId);proxy.addParam("plugtype","window");if (plugout.submitRule !=null) proxy.submitRule=plugout.submitRule;proxy.execute();}function setReturning(returning){if (window.pageUI !=null) window.pageUI.isReturn=getBoolean(returning,false);}function clearChangedData(){if(!window.pageUI){return;}var widgets=window.pageUI.getWidgets();if(widgets !=null&&widgets.length>0){for(var i=0;i<widgets.length;i++){widgets[i].clearChangedData();}}};function isReturning(){if (window.pageUI !=null&&window.pageUI.isReturn !=null&&window.pageUI.isReturn==true) return true;else return false;}$(function(){try{var lfwTop=getLfwTop() || window;lfwTop.preCompressContent();}catch(e){}});function compressContent(content){preCompressContent();if(window.compressObj){try{return window.compressObj.compress(content);}catch(error){return null;}}return null;};function preCompressContent(){if(window.compressObjSign==null){window.compressObjSign=1;var div=document.createElement("DIV");div.id="compressDivContent";document.body.appendChild(div);try{var swfVersionStr="0.0.0";var xiSwfUrlStr="";var flashvars={};var params={};params.allowscriptaccess="always";var attributes={};attributes.id="Compress";attributes.name="Compress";attributes.align="middle";swfobject.embedSWF( "/lfw/frame/device_pc/script/ui/external/Compress.swf","compressDivContent","0","0",swfVersionStr,xiSwfUrlStr,flashvars,params,attributes);}catch(e){}}};

Widget.prototype=new ListenerUtil;function Widget(id,visible,dialog){ListenerUtil.call(this,true);this.id=id;this.comps=new HashMap;this.dss=new HashMap;this.combodatas=new HashMap;this.refnodes=new HashMap;this.dsRelations=null;this.menuMap=new HashMap();this.cardMap=new HashMap();this.tabMap=new HashMap();this.panelMap=new HashMap();this.outlookMap=new HashMap();this.splitMap=new HashMap();this.plugOutMap=new HashMap();this.visible=visible;this.dialog=dialog;this.pageState=null;this.operateState=null;};Widget.prototype.addSplit=function(split){this.splitMap.put(split.id,split);};Widget.prototype.getSplit=function(id){return this.splitMap.get(id);};Widget.prototype.addTab=function(tab){this.tabMap.put(tab.id,tab);};Widget.prototype.getTab=function(id){return this.tabMap.get(id);};Widget.prototype.getTabs=function(){return this.tabMap.values();};Widget.prototype.addCard=function(card){this.cardMap.put(card.id,card);};Widget.prototype.getCard=function(id){return this.cardMap.get(id);};Widget.prototype.getCards=function(){return this.cardMap.values();};Widget.prototype.getPanel=function(id){return this.panelMap.get(id);};Widget.prototype.getPanels=function(){return this.panelMap.values();};Widget.prototype.addPanel=function(panel){this.panelMap.put(panel.id,panel);};Widget.prototype.addOutlook=function(outlook){this.outlookMap.put(outlook.id,outlook);};Widget.prototype.getOutlook=function(id){return this.outlookMap.get(id);};Widget.prototype.removePanel=function(id){this.panelMap.remove(id);};Widget.prototype.getPlugOut=function(id){return this.plugOutMap.get(id);};Widget.prototype.addPlugOut=function(plugout){this.plugOutMap.put(plugout.id,plugout);};Widget.prototype.addMenu=function(menu){this.menuMap.put(menu.id,menu);};Widget.prototype.getMenus=function(){return this.menuMap.values();};Widget.prototype.getMenu=function(id){return this.menuMap.get(id);};Widget.prototype.setVisible=function(visible){if (this.visible !=visible){this.visible=visible;if (this.dialog){if (visible){if (this.onBeforeShow()==false){this.visible=!this.visible;return;}pageUI.getDialog(this.id).show();}else{var result=pageUI.getDialog(this.id).close();if (result==null || result==false) this.visible=!this.visible;}}}var dlgListener=new Listener("afterClose");var oThis=this;dlgListener.func=function(simpleEvent){oThis.visible=false;};pageUI.getDialog(this.id).addListener(dlgListener);if (this.lazyInit){this.lazyInit();this.lazyInit=null;this.$beforeInitData();}this.notifyChange(NotifyType.VISIBLE,this.visible);};Widget.prototype.onBeforeShow=function(){if(pageUI.renderDone){var simpleEvent={"obj":this};this.doEventFunc("beforeShow",simpleEvent);}};Widget.prototype.onclose=function(){this.doEventFunc("onclose");};Widget.prototype.getUserStateMap=function(){};Widget.prototype.destroySelf=function(){var dss=this.getDatasets();for(var i=0;i<dss.length;i++){var ds=this.removeDataset(dss[i].id);ds.destroySelf();}var comps=this.getComponents();for(var i=0;i<comps.length;i++){var comp=this.removeComponent(comps[i].id);comp.destroySelf();}var panels=this.getPanels();for(var i=0;i<panels.length;i++){var panel=panels[i];panel.destroySelf();}var menus=this.getMenus();for(var i=0;i<menus.length;i++){var menu=menus[i];menu.destroySelf();}this.clearListenerMap();this.comps.clear();this.comps=null;this.dss.clear();this.dss=null;this.combodatas.clear();this.combodatas=null;this.refnodes.clear();this.refnodes=null;if(this.dsRelations !=null){this.dsRelations.destroySelf();this.dsRelations=null;}this.menuMap.clear();this.menuMap=null;this.cardMap.clear();this.cardMap=null;this.tabMap.clear();this.tabMap=null;this.panelMap.clear();this.panelMap=null;this.outlookMap.clear();this.outlookMap=null;this.splitMap.clear();this.splitMap=null;this.plugOutMap.clear();this.plugOutMap=null;for(var i in this){this[i]=null;}};Widget.prototype.getActivedMenubars=function(){var menubars=[];var menus=this.menuMap.values();for ( var i=0,count=menus.length;i<count;i++){menubars.push(menus[i]);}return menubars;};Widget.prototype.getContext=function(widgetRule){var context=new Object;context.c="WidgetUIContext";context.visible=this.visible;var contextXmlArray=new Array();contextXmlArray.push("<"+EventContextConstant.context+">");contextXmlArray.push(toJSON(context));contextXmlArray.push("</"+EventContextConstant.context+">");var comps=this.comps.values();if (comps !=null&&comps.length>0){for ( var i=0;i<comps.length;i++){var comp=comps[i];var compType=comp.componentType.toLowerCase();var type=null;if (typeof TreeViewComp !="undefined"&&comp.componentType==TreeViewComp.prototype.componentType){var rule=widgetRule==null ? null:widgetRule .getTreeRule(comp.id);if (rule !=null) type=rule.type;}else{continue;}var ctx=comp.getContext(type);if(ctx==null) continue;contextXmlArray.push("<"+compType+" id=\"" + comp.id + "\">");contextXmlArray.push("<"+EventContextConstant.context+"><![CDATA[");contextXmlArray.push(toJSON(ctx));contextXmlArray.push("]]></"+EventContextConstant.context+">");contextXmlArray.push("</"+compType+">");}}var dss=this.dss.values();if (dss !=null&&dss.length>0){for ( var i=0;i<dss.length;i++){var ds=dss[i];var dsRule=null;var type=null;if (widgetRule !=null){dsRule=widgetRule.getDsRule(ds.id);if (dsRule !=null) type=dsRule.type;}contextXmlArray.push("<dataset id=\"" + ds.id + "\">");contextXmlArray.push("<data>");var dsContent=searializeDataset(ds,type);contextXmlArray.push("<![CDATA["+dsContent+"]]>");contextXmlArray.push("</data>");contextXmlArray.push("</dataset>");}}return contextXmlArray.join("");};Widget.prototype.getChangedContext=function(){var comps=this.comps.values();if (comps !=null&&comps.length>0){for ( var i=0;i<comps.length;i++){var comp=comps[i];var compType=comp.componentType.toLowerCase();var ctx=null;if (comp.getChangedContext) ctx=comp.getChangedContext();if(ctx==null) continue;if (this.changedObj==null){this.changedObj=new Object;this.changedObj.id=this.id;}ctx.compType=compType;if (this.changedObj["comps"]==null) this.changedObj["comps"]=new Array();this.changedObj["comps"].push(ctx);}}var menus=this.menuMap.values();if (menus !=null&&menus.length>0){for ( var i=0;i<menus.length;i++){var menu=menus[i];var ctx=null;if (menu.getChangedContext) ctx=menu.getChangedContext();if(ctx==null) continue;if (this.changedObj==null){this.changedObj=new Object;this.changedObj.id=this.id;}if (menu.componentType=='CONTEXTMENU'){if (this.changedObj["cMenus"]==null) this.changedObj["cMenus"]=new Array();this.changedObj["cMenus"].push(ctx);}else{if (this.changedObj["menus"]==null) this.changedObj["menus"]=new Array();this.changedObj["menus"].push(ctx);}}}var tabs=this.tabMap.values();if (tabs !=null&&tabs.length>0){for ( var i=0;i<tabs.length;i++){var tab=tabs[i];var ctx=null;if (tab.getChangedContext) ctx=tab.getChangedContext();if(ctx==null) continue;if (this.changedObj==null){this.changedObj=new Object;this.changedObj.id=this.id;}if (this.changedObj["tabs"]==null) this.changedObj["tabs"]=new Array();this.changedObj["tabs"].push(ctx);}}var cards=this.cardMap.values();if (cards !=null&&cards.length>0){for ( var i=0;i<cards.length;i++){var card=cards[i];var ctx=null;if (card.getChangedContext) ctx=card.getChangedContext();if(ctx==null) continue;if (this.changedObj==null){this.changedObj=new Object;this.changedObj.id=this.id;}if (this.changedObj["cards"]==null) this.changedObj["cards"]=new Array();this.changedObj["cards"].push(ctx);}}var panels=this.panelMap.values();if (panels !=null&&panels.length>0){for ( var i=0;i<panels.length;i++){var panel=panels[i];var ctx=null;if (panel.getChangedContext) ctx=panel.getChangedContext();if(ctx==null) continue;if (this.changedObj==null){this.changedObj=new Object;this.changedObj.id=this.id;}if (this.changedObj["panels"]==null) this.changedObj["panels"]=new Array();this.changedObj["panels"].push(ctx);}}return this.changedObj;};Widget.prototype.setChangedContext=function(context){if (context==null) return;if (typeof(context.hasChanged) !='undefined'){this.setChanged(context.hasChanged);}if (typeof(context.caption) !='undefined'){var dialog=pageUI.getDialog("'"+this.id+"'");if (dialog !=null) dialog.titleDiv.innerHTML=context.caption;}if (typeof(context.comps) !='undefined'){var comps=context.comps;if (comps.length&&comps.length>0){for (var i=0;i<comps.length;i++){var compCtx=comps[i];var comp=this.getComponent(compCtx.id);if(comp !=null) comp.setChangedContext(compCtx);}}}if (typeof(context.cMenus) !='undefined'){var cMenus=context.cMenus;if (cMenus.length&&cMenus.length>0){for (var i=0;i<cMenus.length;i++){var cMenuCtx=cMenus[i];var cMenu=this.getMenu(cMenuCtx.id);if (cMenu !=null) cMenu.setChangedContext(cMenuCtx);}}}if (typeof(context.menus) !='undefined'){var menus=context.menus;if (menus.length&&menus.length>0){for (var i=0;i<menus.length;i++){var menuCtx=menus[i];var menu=this.getMenu(menuCtx.id);if (menu !=null) menu.setChangedContext(menuCtx);}}}};Widget.prototype.notifyChange=function(type,value){if (isReturning()) return;if (type==null) return;if (this.changedObj==null){this.changedObj=new Object;this.changedObj.id=this.id;}this.changedObj[type]=value;};Widget.prototype.clearChangedData=function(){delete this.changedObj;var comps=this.getComponents();if(comps !=null&&comps.length>0){for(var i=0;i<comps.length;i++){comps[i].clearChange();}}var menus=this.getMenus();if(menus !=null&&menus.length>0){for(var i=0;i<menus.length;i++){menus[i].clearChange();}}var tabs=this.getTabs();if(tabs !=null&&tabs.length>0){for(var i=0;i<tabs.length;i++){tabs[i].clearChange();}}var cards=this.getCards();if(cards !=null&&cards.length>0){for(var i=0;i<cards.length;i++){cards[i].clearChange();}}var panels=this.getPanels();if(panels !=null&&panels.length>0){for(var i=0;i<panels.length;i++){panels[i].clearChange();}}};Widget.prototype.recordUndo=function(){this.oldOperateState=this.operateState;this.oldBusinessState=this.businessState;this.oldUserState=this.userState;};Widget.prototype.undo=function(){};Widget.prototype.addComponent=function(comp){this.comps.put(comp.id,comp);};Widget.prototype.addDataset=function(ds){this.dss.put(ds.id,ds);};Widget.prototype.addComboData=function(combodata){this.combodatas.put(combodata.id,combodata);};Widget.prototype.getComboData=function(id){return this.combodatas.get(id);};Widget.prototype.addRefNode=function(refnode){this.refnodes.put(refnode.id,refnode);};Widget.prototype.getRefNode=function(id){return this.refnodes.get(id);};Widget.prototype.setDsRelations=function(dsRelations){this.dsRelations=dsRelations;};Widget.prototype.getDsRelations=function(){return this.dsRelations;};Widget.prototype.getComponents=function(){return this.comps.values();};Widget.prototype.getComponent=function(id){return this.comps.get(id);};Widget.prototype.getDataset=function(id){return this.dss.get(id);};Widget.prototype.getDatasets=function(){return this.dss.values();};Widget.prototype.removeComponent=function(id){return this.comps.remove(id);};Widget.prototype.removeDataset=function(id){return this.dss.remove(id);};Widget.prototype.beforeWidgetInit=function(){this.doEventFunc("beforeWidgetInit");};Widget.prototype.afterWidgetInit=function(){};Widget.prototype.afterActive=function(){};Widget.prototype.$beforeInitData=function(){this.initialized=true;if (this.lazyInit !=null) return;var openBillId=getParameter("openBillId");var openDsId=getParameter("openDsId");var dss=this.getDatasets();if (dss !=null){for ( var j=0;j<dss.length;j++){if (openDsId==dss[j].id) dss[j].addReqParameter("openBillId",openBillId);if (openDsId==dss[j].id){if (dss[j].dsLoaded) continue;dss[j].dsLoaded=true;dss[j].setCurrentPage(Dataset.MASTER_KEY,0);dss[j].reqParameterMap.remove("openBillId");}if(!dss[j].dsLoaded&&!dss[j].lazyLoad){if(dss[j].compArr.length==0&&dss[j].hasComp) continue;dss[j].dsLoaded=true;dss[j].setCurrentPage(Dataset.MASTER_KEY,0);}}}};Widget.prototype.replaceComboData=function(cbId,keyArr,valueArr,updateDs,imageArr){var cb=new ComboData(cbId);if (keyArr !=null&&keyArr.length>0){for ( var i=0;i<keyArr.length;i++){if(typeof(imageArr) !="undefined") var item=new ComboItem(keyArr[i],valueArr[i],imageArr[i]);else var item=new ComboItem(keyArr[i],valueArr[i]);cb.addItem(item);}}this.combodatas.put(cb.id,cb);var comps=this.comps.values();for ( var i=0;i<comps.length;i++){var comp=comps[i];if ((typeof ComboComp !="undefined"&&comp instanceof ComboComp) || (typeof RadioGroupComp !="undefined"&&comp instanceof RadioGroupComp) || (typeof CheckboxGroupComp !="undefined"&&comp instanceof CheckboxGroupComp)){this.replaceCombo(comp,cbId,cb,updateDs);}else if (typeof AutoFormComp !="undefined"&&typeof AutoFormComp !='undefined'&&comp instanceof AutoFormComp){for ( var j=0;j<comp.eleArr.length;j++){if ((typeof ComboComp !="undefined"&&comp.eleArr[j] instanceof ComboComp) || (typeof RadioGroupComp !="undefined"&&comp.eleArr[j] instanceof RadioGroupComp) || (typeof CheckboxGroupComp !="undefined"&&comp.eleArr[j] instanceof CheckboxGroupComp) ){this.replaceCombo(comp.eleArr[j],cbId,cb,updateDs);}}}else if (typeof GridComp !="undefined"&&typeof GridComp !='undefined'&&comp instanceof GridComp){for (var k=0;k<comp.model.basicHeaders.length;k++){if (comp.model.basicHeaders[k].comboData !=null&&comp.model.basicHeaders[k].comboData.id==cbId){comp.model.basicHeaders[k].comboData=cb;comp.model.basicHeaders[k].reRender();}}var gridcomps=(comp.compsMap==null ? null:comp.compsMap.values());if(gridcomps !=null&&gridcomps.length>0){for ( var j=0;j<gridcomps.length;j++){if ((typeof ComboComp !="undefined"&&gridcomps[j] instanceof ComboComp) || (typeof RadioGroupComp !="undefined"&&gridcomps[j] instanceof RadioGroupComp) || (typeof CheckboxGroupComp !="undefined"&&gridcomps[j] instanceof CheckboxGroupComp) ){this.replaceCombo(gridcomps[j],cbId,cb,updateDs);}}}}}};Widget.prototype.replaceCombo=function(comp,cbId,cb,updateDs){if (comp.comboData !=null&&comp.comboData.id==cbId){comp.setComboData(cb,updateDs);}};Widget.prototype.widgetClosing=function(){};Widget.prototype.widgetClosed=function(){};Widget.prototype.callAllDsClearStatus=function(){var dss=this.getDatasets();if (dss !=null&&dss.length !=0){for ( var i=0,count=dss.length;i<count;i++) dss[i].clearState();}};Widget.prototype.callAllDsClearUndo=function(){var dss=this.getDatasets();if (dss !=null&&dss.length !=0){for ( var i=0;i<dss.length;i++) dss[i].clearUndo();}};Widget.prototype.dispatchEvent2Ds=function(event,masterDsId){if (event==null || masterDsId==null) return;if (RowSelectEvent.prototype.isPrototypeOf(event)){}else if (RowUnSelectEvent.prototype.isPrototypeOf(event)){}else if (DataChangeEvent.prototype.isPrototypeOf(event)){if (event.oldValue==event.currentValue){return;}var ds=this.getDataset(masterDsId);var field=ds.metadata[event.cellColIndex];if(field.editFormular || field.validateFormular) execFormula(this.id,masterDsId,field.key);}};function createDsDataTypeMap(ds){var cache=getFromCache("dstype_key");if (cache==null){cache=new Object;putToCache("dstype_key",cache);}var obj=cache[ds];if (obj==null){obj=new Object;obj.javaClass='java.util.HashMap';var objMap=new Object;obj.map=objMap;for ( var i=0,len=ds.metadata.length;i<len;i++){var md=ds.metadata[i];var replaceField=null;if (md.field !=null&&md.field !="") replaceField=md.field.replace(".","_$_");if (replaceField==null || replaceField=="") replaceField=md.key;objMap[replaceField]=md.dataType;}}return obj;}Widget.prototype.openReference=function(refNodeId,returnFuncName,dialogWidth,dialogHeight,param,refresh,filterValue){var refNode=this.getRefNode(refNodeId);if (refNode==null){showErrorDialog("Can not find refnode by id:"+refNodeId);return;}var trueDialogWidth=getInteger(dialogWidth,650);var trueDialogHeight=getInteger(dialogHeight,400);var trueReadDsName=getString(refNode.readDs,"masterDs");var url=window.corePath+"/"+refNode.path+"?pageId="+refNode.pageMeta+"&widgetId="+this.id+"&otherPageUniqueId="+getPageUniqueId()+"&readDs="+trueReadDsName+"&nodeId="+refNodeId;if (returnFuncName !=null) url+="&returnFunc="+returnFuncName;if (refNode.multiSel) url+="&multiSel=1";if (refNode.delegator !=null) url+="&delegator="+refNode.delegator;if (refNode.fromNc){url+="&fromNc=Y";}if (param !=null) url+="&"+param;if (refresh) url+="&refresh=1";showDialog(url,refNode.name,trueDialogWidth,trueDialogHeight,0);Widget.doFilterRefDialog(getString(filterValue,""),0);};Widget.doFilterRefDialog=function(value,id){if (Widget.waitFilterRt !=null) clearTimeout(Widget.waitFilterRt);if (window["$modalDialogFrame"+id].contentWindow==null || window["$modalDialogFrame"+id].contentWindow.renderDone==null){Widget.waitFilterRt=setTimeout("Widget.doFilterRefDialog('"+value+"','"+id+"');",50);return;}window["$modalDialogFrame"+id].contentWindow.doFilter(value);};WidgetListener.listenerType="WIDGET_LISTENER";function WidgetListener(){}WidgetListener.prototype.beforeWidgetInit=function(){};WidgetListener.prototype.afterWidgetInit=function(){};function PlugOut(id){this.id=id;};PlugOut.prototype.getItems=function(){return this.items;};PlugOut.prototype.getItem=function(itemId){return this.items.get(id);};PlugOut.prototype.addItem=function (item){if (this.items==null) this.items=new HashMap();this.items.put(item.id,item);};function PlugOutItem(name,type,source,desc){this.id=name;this.type=type;this.source=source;this.desc=desc;};

ButtonComp.prototype=new BaseComponent;ButtonComp.prototype.componentType="BUTTON";ButtonComp.BUTTON_HEIGHT=23;ButtonComp.WIDTH=90;function ButtonComp(parent,name,left,top,width,height,text,tip,refImg,position,align,disabled,className,documentClick){if (arguments.length==0) return;this.base=BaseComponent;this.className=getString(className,"button_div");this.initStaticConstant();if(IS_IPAD) width=parseInt(width)+11;this.base(name,left,top,width,height);this.align=align;this.parentOwner=parent;this.position=getString(position,"absolute");this.tip=getString(tip,"");this.text=getString(text,"");this.disabled=getBoolean(disabled,false);this.documentClick=getBoolean(documentClick,true);this.refImg=getString(refImg,"");this.create();};ButtonComp.prototype.initStaticConstant=function(){};ButtonComp.prototype.create=function(){var oThis=this;this.Div_gen=$ce("div");this.Div_gen.id=this.id;this.Div_gen.style.position=this.position;this.Div_gen.style.left=this.left+"px";this.Div_gen.style.top=this.top+"px";this.Div_gen.style.width=this.width;this.Div_gen.style.height=this.height;this.Div_gen.className=this.className;this.Div_gen.title=this.text;if(IS_IE7){this.parentOwner.style.width=this.width;}this.btnLeftDiv=$ce("div");this.btnLeftDiv.className="btn_left_off";this.btnCenterDiv=$ce("div");this.btnCenterDiv.className="btn_center";if (IS_IE) this.btnCenterDiv.style.overflowY="hidden";this.btnRightDiv=$ce("div");this.btnRightDiv.className="btn_right_off";this.Div_gen.appendChild(this.btnLeftDiv);this.Div_gen.appendChild(this.btnCenterDiv);this.Div_gen.appendChild(this.btnRightDiv);this.butt=$ce("button");this.butt.style.width="100%";this.butt.className="btn_off";if (this.butt.type=="submit") this.butt.setAttribute("type","button");this.btnCenterDiv.appendChild(this.butt);this.Div_gen.tip=this.tip;if (this.disabled){this.butt.disabled=true;this.btnLeftDiv.className="btn_left_disabled";this.btnRightDiv.className="btn_right_disabled";this.butt.className="btn_disabled";}if(!IS_IPAD){this.Div_gen.onmouseover=function(e){if (oThis.disabled) return;e=EventUtil.getEvent();oThis.btnLeftDiv.className="btn_left_on";oThis.btnRightDiv.className="btn_right_on";oThis.butt.className="btn_on";oThis.onmouseover(e);clearEventSimply(e);};}this.Div_gen.onmouseout=function(e){if (oThis.disabled) return;e=EventUtil.getEvent();oThis.btnLeftDiv.className="btn_left_off";oThis.btnRightDiv.className="btn_right_off";oThis.butt.className="btn_off";oThis.onmouseout(e);clearEventSimply(e);};this.Div_gen.onmousedown=function(e){if(oThis.disabled){return;}e=EventUtil.getEvent();oThis.btnLeftDiv.className="btn_left_down";oThis.btnRightDiv.className="btn_right_down";oThis.butt.className="btn_down";oThis.onmousedown(e);clearEventSimply(e);};this.Div_gen.onmouseup=function(e){if(oThis.disabled){return;}e=EventUtil.getEvent();oThis.btnLeftDiv.className="btn_left_on";oThis.btnRightDiv.className="btn_right_on";oThis.butt.className="btn_on";oThis.onmouseup(e);clearEventSimply(e);};this.Div_gen.onfocus=function(e){if(oThis.disabled){return;}e=EventUtil.getEvent();oThis.btnLeftDiv.className="btn_left_focus";oThis.btnRightDiv.className="btn_right_focus";oThis.butt.className="btn_focus";oThis.onfocus(e);clearEventSimply(e);};this.Div_gen.onblur=function(e){if(oThis.disabled){return;}e=EventUtil.getEvent();oThis.btnLeftDiv.className="btn_left_off";oThis.btnRightDiv.className="btn_right_off";oThis.butt.className="btn_off";oThis.onblur(e);clearEventSimply(e);};this.Div_gen.onclick=function(e){if (oThis.isDblEvent("onclick")) return;if(oThis.documentClick){document.onclick();}if (oThis.disabled) return;e=EventUtil.getEvent();e.triggerObj=oThis;oThis.onclick(e);stopEvent(e);e.triggerObj=null;clearEventSimply(e);};if (this.parentOwner) this.placeIn(this.parentOwner);};ButtonComp.prototype.manageSelf=function(){this.textNode=document.createTextNode(this.text);this.textNodeDiv=$ce("DIV");if(IS_IE){this.textNodeDiv.style.marginTop="3px";}else{this.textNodeDiv.style.marginBottom="3px";}this.textNodeDiv.appendChild(this.textNode);if (this.refImg !=""){this.imgNode=$ce("img");this.imgNode.style.marginRight="5px";var brNode=$ce("br");this.imgNode.src=this.refImg;if (this.text==null || this.text==""){this.butt.appendChild(this.imgNode);}else{this.imgNode.align="absmiddle";if (this.align=="left"){this.butt.appendChild(this.textNodeDiv);this.butt.appendChild(this.imgNode);}if (this.align=="right"){this.butt.appendChild(this.imgNode);this.butt.appendChild(this.textNodeDiv);}if (this.align=="top"){this.butt.appendChild(this.textNodeDiv);this.butt.appendChild(brNode);this.butt.appendChild(this.imgNode);}if (this.align=="bottom"){this.butt.appendChild(this.imgNode);this.butt.appendChild(brNode);this.butt.appendChild(this.textNodeDiv);}}}else{this.butt.appendChild(this.textNodeDiv);}this.textNodeDiv.style.whiteSpace="nowrap";this.textNodeDiv.style.overflow="hidden";this.textNodeDiv.style.textOverflow="ellipsis";};ButtonComp.prototype.changeImage=function(imgPath){if (this.refImg !=null&&this.refImg !=""){this.refImg=imgPath;this.imgNode.src=imgPath;}};ButtonComp.prototype.changeText=function(text){var newNode=document.createTextNode(text);this.textNodeDiv.replaceChild(newNode,this.textNode);this.textNode=newNode;this.text=text;this.Div_gen.title=this.text;this.ctxChanged=true;this.notifyChange(NotifyType.TEXT,this.text);};ButtonComp.prototype.setActive=function(isActive){var isActive=getBoolean(isActive,false);if (this.disabled==false&&isActive==false){this.butt.disabled=true;this.disabled=true;this.butt.className="btn_disabled";}else if (this.disabled==true&&isActive==true){this.butt.disabled=false;this.disabled=false;this.butt.className="btn_off";}this.ctxChanged=true;this.notifyChange(NotifyType.ENABLE,!this.disabled);};ButtonComp.prototype.isActive=function(){return !this.disabled;};ButtonComp.prototype.onmouseout=function(e){var mouseEvent={"obj":this,"event":e};this.doEventFunc("onmouseout",mouseEvent);};ButtonComp.prototype.onmouseover=function(e){var mouseEvent={"obj":this,"event":e};this.doEventFunc("onmouseover",mouseEvent);};ButtonComp.prototype.onmousedown=function(e){var mouseEvent={"obj":this,"event":e};this.doEventFunc("onmousedown",mouseEvent);};ButtonComp.prototype.onmouseup=function(e){var mouseEvent={"obj":this,"event":e};this.doEventFunc("onmouseup",mouseEvent);};ButtonComp.prototype.onclick=function(e){var mouseEvent={"obj":this,"event":e};this.doEventFunc("onclick",mouseEvent);};BaseComponent.prototype.handleHotKey=function(key){if (this.isActive()==false) return null;if (this.hotKey !=null){if (key==this.hotKey&&this.onclick){this.onclick(null);return this;}}return null;};ButtonComp.prototype.setVisible=function(visible){if (visible !=null&&this.visible !=visible){if (visible==true) this.Div_gen.style.visibility="";else this.Div_gen.style.visibility="hidden";this.visible=visible;}this.ctxChanged=true;this.notifyChange(NotifyType.VISIBLE,visible);};ButtonComp.prototype.changeClass=function(className){this.Div_gen.className=className;};ButtonComp.prototype.changeWidth=function(width){if (width !=null&&convertWidth(width) !=this.width){this.width=(convertWidth(width));this.Div_gen.style.width=this.width;if(IS_IE7){this.parentOwner.style.width=this.width;}var tempWidth=0;if (isPercent(this.width)) tempWidth=this.Div_gen.offsetWidth;else tempWidth=getInteger(parseInt(this.width),120);}};ButtonComp.prototype.setFamily=function(family){this.family=family;this.butt.style.fontFamily=this.family;};ButtonComp.prototype.setSize=function(size){this.size=size;this.butt.style.fontSize=this.size+"px";};ButtonComp.prototype.setColor=function(color){this.color=color;this.butt.style.color=this.color;};ButtonComp.prototype.setWeight=function(weight){this.weight=weight;this.butt.style.fontWeight=this.weight;};ButtonComp.prototype.setStyle=function(style){this.style=style;this.butt.style.fontStyle=this.style;};ButtonComp.prototype.setChangedContext=function(context){if(context.enable !=null) this.setActive(context.enable);if(context.visible !=null&&this.visible !=context.visible) this.setVisible(context.visible);if(context.text !=null&&this.text !=context.text) this.changeText(context.text);if(context.width !=null&&this.width !=context.width) this.changeWidth(context.width);};

ModalDialogComp.prototype=new BaseComponent;ModalDialogComp.prototype.componentType="MODALDIALOG";ModalDialogComp.HEIGHT=200;ModalDialogComp.WIDTH=300;ModalDialogComp.ZINDEX=0;function ModalDialogComp(name,title,left,top,width,height,className,attr){if (arguments.length==0) return;this.base=BaseComponent;this.base(name,left,top,width,height);this.parentOwner=document.body;this.title=getString(title,trans("ml_dialog"));this.className=getString(className,"dialog_div");this.isShowLine=true;if(attr){this.isShowLine=getBoolean(attr.isShowLine,this.isShowLine);}this.create();};ModalDialogComp.prototype.create=function(){this.Div_gen=$ce("DIV");this.Div_gen.style.position="absolute";this.Div_gen.style.left="0px";this.Div_gen.style.top="0px";this.Div_gen.style.width="100%";this.Div_gen.style.minHeight="100%";this.Div_gen.style.zIndex=getZIndex();this.Div_gen.style.visibility="hidden";this.Div_gen.style.background="url("+window.globalPath+"/frame/themes/images/transparent.gif)";this.Div_gen.ontouchmove=function(e){return false;};if (this.parentOwner) this.placeIn(this.parentOwner);};ModalDialogComp.prototype.manageSelf=function (){var oThis=this;this.divdialog=$ce("DIV");this.divdialog.className=this.className;this.divdialog.style.width=this.width;if(this.height.indexOf("%") !=-1){this.height=(document.body.clientHeight*translatePercentToFloat(this.height))+"px";}this.divdialog.style.height=this.height;addResizeEvent(this.Div_gen,function(e){if(IS_IE){var topHeight=window.document.body.scrollHeight;oThis.Div_gen.style.height=topHeight+"px";}clearEventSimply(e);});this.divdialog.ontouchmove=function(e){return false;};var frmstr='<iframe src="" style="position:absolute; visibility:inherit; top:0px; left:0px; width:100%;height:100%; z-index:-1; border:none;" frameborder="0"></<iframe>';this.divdialog.innerHTML=frmstr;this.Div_gen.appendChild(this.divdialog);this.layout=$ce("table");this.layout.border="0";this.layout.style.height="100%";this.layout.style.width="100%";this.layout.cellPadding="0";this.layout.cellSpacing="0";this.firstRow=this.layout.insertRow(-1);this.titleL=this.firstRow.insertCell(-1);this.titleC=this.firstRow.insertCell(-1);this.titleR=this.firstRow.insertCell(-1);this.secondRow=this.layout.insertRow(-1);this.cL=this.secondRow.insertCell(-1);this.cC=this.secondRow.insertCell(-1);this.cC.style.display="block";this.cC.height=this.divdialog.offsetHeight-66+"px";this.cR=this.secondRow.insertCell(-1);this.thirdRow=this.layout.insertRow(-1);this.bL=this.thirdRow.insertCell(-1);this.bC=this.thirdRow.insertCell(-1);this.bR=this.thirdRow.insertCell(-1);this.divdialog.appendChild(this.layout);this.firstRow.className="dialog_titlebar";this.thirdRow.className="bottomdiv";this.titleL.className="leftheadborderdiv";this.titleC.className="centerheaddiv";this.titleR.className="rightheadborderdiv";this.titleDiv=$ce("DIV");this.titleDiv.className="dialog_title";this.titleDiv.innerHTML=this.title.replace("\<","&lt;").replace("\>","&gt");this.titleDiv.style.width=this.divdialog.offsetWidth-120+"px";this.titleC.appendChild(this.titleDiv);this.closeBt=$ce('DIV');this.closeBt.className="closebt_off";this.titleC.appendChild(this.closeBt);this.closeBt.onmouseover=function (e){this.className="closebt_on";};this.closeBt.onmouseout=function (e){this.className="closebt_off";};this.closeBt.onmousedown=function (e){this.className="closebt_click";};this.closeBt.onclick=function (){try{if (oThis.getContentPane() !=null){var frame=oThis.getContentPane().firstChild;if (frame&&frame.contentWindow&&frame.contentWindow.document) frame.contentWindow.document.onclick();}}catch(e){}oThis.close();};this.cL.className="leftbodyborderdiv";this.cR.className="rightbodyborderdiv";if(this.isShowLine){this.cC.className="centerbodydiv";}else{this.cC.className="centerbodynolinediv";}this.cC.style.backgroundColor="#FFFFFF";this.cC.vAlign="top";this.contentDiv=$ce("DIV");this.contentDiv.className="dialog_content";var screenWidth=document.body.clientWidth;var topWin=getLfwTop() || window;var topScreenWidth=topWin.document.body.clientWidth;if(screenWidth>topScreenWidth){screenWidth=topScreenWidth;}if(this.divdialog.parentNode){screenWidth=this.divdialog.parentNode.offsetWidth<screenWidth ? this.divdialog.parentNode.offsetWidth:screenWidth;}this.contentDiv.style.maxWidth=screenWidth+"px";this.cC.appendChild(this.contentDiv);this.bL.className="leftbottomborderdiv";this.bR.className="rightbottomborderdiv";this.bC.className="centerbottomdiv";var drag=false;var oldX=0;var oldY=0;this.firstRow.onmousedown=function (e){e=EventUtil.getEvent();drag=true;if(e.target==oThis.closeBt){drag=false;return;}if (IS_IE){oldX=e.clientX;oldY=e.clientY;}else{oldX=e.pageX;oldY=e.pageY;}if (IS_IE) this.setCapture();else window.captureEvents(Event.MOUSEMOVE | Event.MOUSEUP);clearEventSimply(e);};this.firstRow.onmouseup=function (e){drag=false;oThis.topDiv.style.display="none";oThis.topDiv.style.zIndex="-1";if (IS_IE) this.releaseCapture();else window.captureEvents(Event.MOUSEMOVE | Event.MOUSEUP);};if (!IS_IE){window.onmouseup=function (){drag=false;oThis.topDiv.style.display="none";oThis.topDiv.style.zIndex="-1";window.captureEvents(Event.MOUSEMOVE | Event.MOUSEUP);};}window.onmousemove=function (e){e=EventUtil.getEvent();if (drag){oThis.topDiv.style.display="block";oThis.topDiv.style.zIndex=getZIndex();if (IS_IE){if (e.clientX<=0 || e.clientX>=document.body.clientWidth) return false;if (e.clientY<=0 || e.clientY>=document.body.clientHeight) return false;var offsetX=e.clientX-oldX;var offsetY=e.clientY-oldY;oldX=e.clientX;oldY=e.clientY;oThis.divdialog.style.left=oThis.divdialog.style.pixelLeft+offsetX+"px";oThis.divdialog.style.top=oThis.divdialog.style.pixelTop+offsetY+"px";}else{var offsetX=e.pageX-oldX;var offsetY=e.pageY-oldY;oldX=e.pageX;oldY=e.pageY;oThis.divdialog.style.left=oThis.divdialog.offsetLeft+offsetX+"px";oThis.divdialog.style.top=oThis.divdialog.offsetTop+offsetY+"px";}}clearEventSimply(e);};if(IS_IE8){this.firstRow.onmousemove=function (e){e=EventUtil.getEvent();if (drag){oThis.topDiv.style.display="block";oThis.topDiv.style.zIndex=getZIndex();if (IS_IE){if (e.clientX<=0 || e.clientX>=document.body.clientWidth) return false;if (e.clientY<=0 || e.clientY>=document.body.clientHeight) return false;var offsetX=e.clientX-oldX;var offsetY=e.clientY-oldY;oldX=e.clientX;oldY=e.clientY;oThis.divdialog.style.left=oThis.divdialog.style.pixelLeft+offsetX+"px";oThis.divdialog.style.top=oThis.divdialog.style.pixelTop+offsetY+"px";}else{var offsetX=e.pageX-oldX;var offsetY=e.pageY-oldY;oldX=e.pageX;oldY=e.pageY;oThis.divdialog.style.left=oThis.divdialog.offsetLeft+offsetX+"px";oThis.divdialog.style.top=oThis.divdialog.offsetTop+offsetY+"px";}}clearEventSimply(e);};}this.initTopDiv();};ModalDialogComp.prototype.showLine=function(isShowLine){if (isShowLine==this.isShowLine) return;this.isShowLine=isShowLine;if(isShowLine){this.cC.className="centerbodydiv";}else{this.cC.className="centerbodynolinediv";}};ModalDialogComp.prototype.show=function(refDiv){this.Div_gen.style.visibility="visible";this.Div_gen.style.display="block";this.Div_gen.style.zIndex=getZIndex();this.visible=true;var sctop=0;var clinetHeight=0;sctop=compFirstScrollTop(this.Div_gen);clinetHeight=compFirstScrollClientHeight(this.Div_gen);this.Div_gen.top=sctop;if(this.divdialog.offsetWidth>0&&this.divdialog.offsetHeight>0){var iframe=this.divdialog.children[0];if(iframe&&iframe.tagName=='IFRAME'){iframe.style.width=this.divdialog.offsetWidth-18*2+"px";iframe.style.height=this.divdialog.offsetHeight-12-18+"px";iframe.style.left="18px";iframe.style.top="12px";}}if(this.divdialog.offsetHeight>document.body.clientHeight) document.body.style.height=(this.divdialog.offsetHeight+10)+"px";positionElementToScreenCenter(this.divdialog,sctop,clinetHeight);setTimeout("document.body.style.height = '100%'",1000);window.onresize();if(window.pageUI) pageUI.hasChanged=false;};ModalDialogComp.prototype.setBounds=function(left,top,width,height){BaseComponent.prototype.setBounds.call(this,left,top,width,height);};ModalDialogComp.prototype.hide=function(){if(this.Div_gen){this.Div_gen.style.display="none";}this.visible=false;var html=this.Div_gen.innerHTML;if (IS_IE8&&html.indexOf("cke_contents_htmlcontent_content") !=-1){var td=$ge("cke_contents_htmlcontent_content");try{td.childNodes[0].contentWindow.document.body.innerHTML="";}catch(e){}}};ModalDialogComp.prototype.setSize=function(width,height){this.width=parseInt(width,10)+"px";this.height=parseInt(height,10)+"px";this.divdialog.style.width=this.width;this.divdialog.style.height=this.height;this.cC.height=this.divdialog.offsetHeight-66+"px";if(this.divdialog.offsetWidth>0&&this.divdialog.offsetHeight>0){var iframe=this.divdialog.children[0];if(iframe&&iframe.tagName=='IFRAME'){iframe.style.width=this.divdialog.offsetWidth-18*2+"px";iframe.style.height=this.divdialog.offsetHeight-12-18+"px";iframe.style.left="18px";iframe.style.top="12px";}}this.titleDiv.style.width=this.divdialog.offsetWidth-120+"px";};ModalDialogComp.prototype.getContentPane=function(){return this.contentDiv;};ModalDialogComp.prototype.add=function(objHtml){this.getContentPane().appendChild(objHtml);};ModalDialogComp.prototype.setTitle=function(title){this.title=title;this.titleDiv.innerHTML=this.title;};ModalDialogComp.prototype.close=function(){if (this.onBeforeClose()==false) return;var iframe=$(this.divdialog).find('iframe')[1];if (iframe){try{var _pageUI=iframe.contentWindow.pageUI;if (_pageUI){if (iframe.contentWindow.isPopView&&iframe.contentWindow.isPopView==true){}else{var result=_pageUI.beforeDialogClose();if (result===false) return;}}}catch(e){}}this.onClosing();this.hide();this.onAfterClose();return true;};ModalDialogComp.prototype.onBeforeShow=function(){var simpleEvent={"obj":this};this.doEventFunc("beforeShow",simpleEvent);};ModalDialogComp.prototype.onBeforeClose=function(){var simpleEvent={"obj":this};return this.doEventFunc("beforeClose",simpleEvent);};ModalDialogComp.prototype.onAfterClose=function(){var simpleEvent={"obj":this};this.doEventFunc("afterClose",simpleEvent);};ModalDialogComp.prototype.onClosing=function(){var simpleEvent={"obj":this};this.doEventFunc("onclose",simpleEvent);};ModalDialogComp.prototype.initTopDiv=function(){this.topDiv=$ce("DIV");this.topDiv.id=this.id+"topDiv";this.topDiv.style.left="0px";this.topDiv.style.top="0px";this.topDiv.style.width="100%";this.topDiv.style.height="100%";this.topDiv.style.position="absolute";this.topDiv.style.overflow="hidden";this.topDiv.style.background="#666";_setOpacity(this.topDiv,0);this.topDiv.style.display="none";this.topDiv.style.zIndex="-1";this.topDiv.refGrid=this;document.body.appendChild(this.topDiv);};

ContextMenuComp.prototype=new BaseComponent;ContextMenuComp.prototype.componentType="CONTEXTMENU";ContextMenuComp.SEP_HEIGHT=10;ContextMenuComp.ITEM_WIDTH=120;function ContextMenuComp(name,left,top,posFix){this.base=BaseComponent;this.base(name,left,top,"","");this.width=ContextMenuComp.ITEM_WIDTH;this.posFix=getBoolean(posFix,false);this.visible=false;this.isChildMenu=false;this.childItems=new Array();this.childMenus=new Array();this.seps=new Array();this.sepIndex=0;this.create();};ContextMenuComp.prototype.create=function(){var oThis=this;this.Div_gen=$ce("DIV");this.Div_gen.className="contextmenu_div";this.Div_gen.style.width=this.width+2*11;this.Div_gen.style.position="absolute";this.Div_gen.style.display="none";this.Div_gen.style.zIndex=getZIndex();document.body.appendChild(this.Div_gen);var frmstr='<iframe src="" style="position:absolute; visibility:inherit; top:4px; left:4px; width:100%;height:100%; z-index:-1; border:none;" frameborder="0"></<iframe>';this.Div_gen.innerHTML=frmstr;this.left_top=$ce("DIV");this.left_top.className='left_top_div';this.center_top=$ce("DIV");this.center_top.className='center_top_div';this.right_top=$ce("DIV");this.right_top.className='right_top_div';this.left_center=$ce("DIV");this.left_center.className='left_center_div';this.centerContent=$ce("DIV");this.centerContent.className='center_div';this.right_center=$ce("DIV");this.right_center.className='right_center_div';this.left_bottom=$ce("DIV");this.left_bottom.className='left_bottom_div';this.center_bottom=$ce("DIV");this.center_bottom.className='center_bottom_div';this.right_bottom=$ce("DIV");this.right_bottom.className='right_bottom_div';this.bottom_button=$ce("DIV");this.bottom_button.className='bottom_button';this.top_button=$ce("DIV");this.top_button.className='top_button';this.bottom_button.style.display="none";this.top_button.style.display="none";this.Div_gen.appendChild(this.centerContent);this.Div_gen.appendChild(this.left_top);this.Div_gen.appendChild(this.center_top);this.Div_gen.appendChild(this.right_top);this.Div_gen.appendChild(this.left_center);this.Div_gen.appendChild(this.right_center);this.Div_gen.appendChild(this.bottom_button);this.Div_gen.appendChild(this.top_button);this.Div_gen.appendChild(this.left_bottom);this.Div_gen.appendChild(this.center_bottom);this.Div_gen.appendChild(this.right_bottom);this.centerContent.style.top="0px";window.clickHolders.push(this);this.bottom_button.onclick=function (e){e=EventUtil.getEvent(e);stopEvent(e);var top=parseInt(oThis.centerContent.style.top.replace("px","")),heightOuter=oThis.Div_gen.style.height,heightInner=oThis.centerContent.style.height?oThis.centerContent.style.height:oThis.centerContent.offsetHeight,heightOuter=parseInt(heightOuter.replace("px","")),offset=heightInner-heightOuter,top=-top+20>offset?-offset:top;oThis.centerContent.style.top=top-20+'px';};this.top_button.onclick=function (e){e=EventUtil.getEvent(e);stopEvent(e);var top=parseInt(oThis.centerContent.style.top.replace("px","")),top=top+20>0?0:top+20;oThis.centerContent.style.top=top+'px';};};ContextMenuComp.prototype.destroySelf=function(){for (var i=0,n=this.childItems.length;i<n;i++){var item=this.childItems[i];if(typeof(item.destroySelf)=='function'){item.destroySelf();}}for (var i=0,n=this.childMenus.length;i<n;i++){var menu=this.childMenus[i];menu.destroySelf();}this.destroy();};ContextMenuComp.prototype.outsideClick=function(e){if (e !=null&&2==e.button) return;if (this.visible) this.hide();};ContextMenuComp.prototype.addZIndex=function(e){this.Div_gen.style.zIndex=getInteger(this.Div_gen.style.zIndex)+1;};ContextMenuComp.prototype.setPosLeft=function(left){this.left=getInteger(left,0)-3;this.Div_gen.style.left=this.left+"px";};ContextMenuComp.prototype.setPosTop=function(top){this.top=getInteger(top,0)-5;this.Div_gen.style.top=this.top+"px";};ContextMenuComp.prototype.setWidth=function(width){this.width=getString(width,"100%");if (this.width.toString().indexOf("%")==-1) this.Div_gen.style.width=this.width+2*11+"px";else this.Div_gen.style.width=this.width;};ContextMenuComp.prototype.setHeight=function(height){this.height=height;this.Div_gen.style.height=height+"px";};ContextMenuComp.prototype.childItemWidthUpdated=function(width){if (this.width<width){this.width=width;this.Div_gen.style.width=this.width+2*11+"px";for (var i=0;i<this.childItems.length;i++) this.childItems[i].setItemWidth(width);for (var i=0;i<this.seps.length;i++) this.seps[i].setItemWidth(width);}};ContextMenuComp.prototype.addMenu=function(name,caption,tip,refImg,isCheckBoxItem,isCheckBoxSelected,attrObj){var oThis=this;var item=new MenuItemComp(this.Div_gen,name,caption,tip,refImg,"menuitem_div",false,null,isCheckBoxItem,isCheckBoxSelected,attrObj);var index=this.childItems.push(item);item.parentOwner=this;item.index=index-1;this.addItemHtml(item);item.preMenuItem=this.lastAddItem;this.lastAddItem=item;return item;};ContextMenuComp.prototype.addSep=function(attrObj){var id=this.id+"_sep_"+this.sepIndex;var sep=new MenuSepComp(this.Div_gen,name,"menuitem_div",attrObj);this.sepIndex=this.seps.push(sep);sep.parentOwner=this;sep.index=this.sepIndex-1;this.addItemHtml(sep);return sep;};ContextMenuComp.prototype.getMenu=function(id){for(var i=0;i<this.childItems.length;i++){if(id==this.childItems[i].name) return this.childItems[i];}return null;};ContextMenuComp.prototype.addItemHtml=function(item){var itemWidth=item.getItemWidth();if (itemWidth>this.width) this.childItemWidthUpdated(itemWidth);else item.setItemWidth(this.width);this.centerContent.appendChild(item.Div_gen);};ContextMenuComp.prototype.addItemChildMenu=function(childMenu,item){childMenu.isChildMenu=true;childMenu.menuParent=this;this.childMenus.push(childMenu);this.childMenus=this.childMenus.concat(childMenu.childMenus);childMenu.posFix=true;document.body.appendChild(childMenu.Div_gen);if (childMenu.childMenus !=null){for (var i=0;i<childMenu.childMenus.length;i++) document.body.appendChild(childMenu.childMenus[i].Div_gen);}if (item !=null) item.setChildMenu(childMenu);};ContextMenuComp.prototype.addSeparator=function(){var oThis=this;var sep=$ce("DIV");sep.style.position="relative";sep.style.width="100%";sep.style.height=ContextMenuComp.SEP_HEIGHT+"px";sep.innerHTML="<hr/>";sep.style.background="#fff";sep.onmouseover=function(e){e=EventUtil.getEvent();if (oThis.nowActiveMenu){oThis.nowActiveMenu.fermezoneMenu();oThis.nowActiveMenu="";}stopEvent(e);clearEventSimply(e);};this.add(sep);};ContextMenuComp.prototype.hide=function(){if (!this.visible) return;if (this.onBeforeClose()==false) return;for (var i=0,count=this.childMenus.length;i<count;i++){if (this.childMenus[i].visible==true) this.childMenus[i].hide();}if (this.childItems !=null){for (var i=0,count=this.childItems.length;i<count;i++){if (this.childItems[i].childMenu !=null&&this.childItems[i].childMenu.visible==true) this.childItems[i].childMenu.hide();}}this.triggerObjHtml=null;if (this.isChildMenu) this.menuParent.nowActiveMenu=null;this.Div_gen.style.display="none";this.visible=false;this.onclose();};ContextMenuComp.prototype.show=function(e){e=EventUtil.getEvent();if (arguments !=null&&arguments.length==2){this.triggerObjHtml=arguments[1];}if (this.onBeforeShow()==false){clearEventSimply(e);return;}this.visible=true;this.Div_gen.style.left="0px";this.Div_gen.style.top="0px";this.Div_gen.style.display="block";this.Div_gen.style.zIndex=getZIndex();if (this.isChildMenu) this.menuParent.nowActiveMenu=this;if (!this.posFix) positionneSelonEvent(this.Div_gen,e);else{positionneSelonPosFournie(this.Div_gen,this.top,this.left,this);}stopDefault(e);this.onshow();var selfHeight=this.Div_gen.offsetHeight;var scrollTop=document.body.scrollTop;var selfTop=this.Div_gen.offsetTop-scrollTop;var pointY=e.clientY;if(this.posFix) pointY=this.top;if(selfTop==pointY){var bodyHeight=document.body.clientHeight-selfTop;}else{if(selfTop<0){selfTop=0;this.Div_gen.style.top="0px";}var bodyHeight=pointY-selfTop;}if(selfHeight>bodyHeight){this.Div_gen.style.height=bodyHeight-2+"px";this.bottom_button.style.display="block";this.top_button.style.display="block";}clearEventSimply(e);};ContextMenuComp.prototype.mouseover=function(e){this.onmouseover(e);};ContextMenuComp.prototype.mouseout=function(item){this.onmouseout(item);};ContextMenuComp.prototype.click=function(e){var menu=e.triggerItem.parentOwner;while (menu.isChildMenu) menu=menu.menuParent;if (menu.menubar) menu.menubar.click(e);else menu.onclick(e);menu.hide();};ContextMenuComp.prototype.getSelectedItems=function(){var items=this.childItems;var selItems=new Array();if (items !=null&&items.length>0){for (var i=0,count=items.length;i<count;i++){if (items[i].checkbox&&items[i].checkbox.checked) selItems.push(items[i]);}}return selItems;};ContextMenuComp.prototype.getVisibleItems=function(){var items=this.childItems;var visibleItems=new Array();if (items !=null&&items.length>0){for (var i=0,count=items.length;i<count;i++){if (items[i].visible==true) visibleItems.push(items[i]);}}return visibleItems;};ContextMenuComp.prototype.hideItems=function(indice){if (indice==null) return;for (var i=0,count=indice.length;i<count;i++){var index=indice[i];var item=this.childItems[index];item.Div_gen.style.display="none";item.visible=false;}};ContextMenuComp.prototype.showItems=function(indice){if (indice==null) return;for (var i=0,count=indice.length;i<count;i++){var index=indice[i];var item=this.childItems[index];item.Div_gen.style.display="block";item.visible=true;}};ContextMenuComp.prototype.handleHotKey=function(key){if (this.Div_gen.style.display=="none"|| this.Div_gen.style.visibility=="hidden") return null;var childItems=this.childItems;if (childItems.length>0){for (var i=0,n=childItems.length;i<n;i++){var obj=childItems[i].handleHotKey(key);if (obj !=null) return childItems[i];}}return null;};ContextMenuComp.prototype.getItemByIndex=function(index){return this.childItems[index];};ContextMenuComp.prototype.onBeforeClose=function(){var simpleEvent={"obj":this};this.doEventFunc("beforeClose",simpleEvent);};ContextMenuComp.prototype.onclose=function(){var simpleEvent={"obj":this};this.doEventFunc("onclose",simpleEvent);};ContextMenuComp.prototype.onBeforeShow=function(){var simpleEvent={"obj":this};this.doEventFunc("beforeShow",simpleEvent);};ContextMenuComp.prototype.onshow=function(){var simpleEvent={"obj":this};this.doEventFunc("onshow",simpleEvent);};ContextMenuComp.prototype.onmouseout=function(item){var menuItemEvent={"obj":this,"item":item};this.doEventFunc("onmouseout",menuItemEvent);};ContextMenuComp.prototype.onmouseover=function(e){var mouseEvent={"obj":this,"event":e};this.doEventFunc("onmouseover",mouseEvent);};ContextMenuComp.prototype.onclick=function(e){var mouseEvent={"obj":this,"event":e};this.doEventFunc("onclick",mouseEvent);};MenuItemComp.prototype=new BaseComponent;MenuItemComp.prototype.componentType="MENUITEM";MenuItemComp.DEFAULT_CAPTION="EMPTY_CAPTION";MenuItemComp.DEFAULT_ITEM="";MenuItemComp.ITEM_HEIGHT=27;MenuItemComp.IMAGE_WIDTH=16;MenuItemComp.rightImgDownPath=window.themePath+"/ui/ctrl/menu/images/dropdown.png";MenuItemComp.rightImgDownOverPath=window.themePath+"/ui/ctrl/menu/images/dropdown_over.png";MenuItemComp.rightImgDownSelectedPath=window.themePath+"/ui/ctrl/menu/images/dropdown_selected.png";MenuItemComp.refImgRightPath=window.themePath+"/ui/ctrl/menu/images/dropright.png";MenuItemComp.refImgRightOverPath=window.themePath+"/ui/ctrl/menu/images/dropright_over.png";MenuItemComp.refImgRightSelectedPath=window.themePath+"/ui/ctrl/menu/images/dropright_selected.png";MenuItemComp.SHOW_ALL=0;MenuItemComp.SHOW_TEXT=1;MenuItemComp.SHOW_IMG=2;function MenuItemComp(parent,id,caption,tip,refImg,className,isMenuBarItem,isCheckBoxGroup,isCheckBoxItem,isCheckBoxSelected,attrObj){this.base=BaseComponent;this.base(id);var oThis=this;this.caption=getString(caption,MenuItemComp.DEFAULT_ITEM);this.refImg=refImg;this.refImgOn=null;this.refImgDisable=null;this.showModel=MenuItemComp.SHOW_TEXT;if (attrObj){if (attrObj.imgIconOn) this.refImgOn=attrObj.imgIconOn;if (attrObj.imgIconDisable) this.refImgDisable=attrObj.imgIconDisable;this.showModel=getInteger(attrObj.showModel,MenuItemComp.SHOW_TEXT);}this.name=id;this.id=id;this.height=MenuItemComp.ITEM_HEIGHT;this.childMenu=null;this.disabled=false;this.isMenuBarItem=getBoolean(isMenuBarItem,false);if (this.isMenuBarItem) this.isCheckBoxGroup=getBoolean(isCheckBoxGroup,false);else{this.isCheckBoxItem=getBoolean(isCheckBoxItem,false);if (this.isCheckBoxItem) this.isCheckBoxSelected=getBoolean(isCheckBoxSelected,false);}this.visible=true;if (this.isMenuBarItem&&this.isCheckBoxGroup) this.selectedItem=null;this.className=getString(className,"contextmenu_item_div");this.divCenterOffClassName="divCenter_off";this.divCenterOnClassName="divCenter_on";this.parentHTML=parent;this.tip=getString(tip,this.caption);if(MenuItemComp.SUSPEND_CREATE==null || MenuItemComp.SUSPEND_CREATE==false) this.create();};MenuItemComp.prototype.create=function(){var oThis=this;this.Div_gen=$ce("DIV");this.Div_gen.id="menu_div_"+this.id;this.parentHTML.appendChild(this.Div_gen);this.Div_gen.className=this.className;this.Div_gen.style.overflow="hidden";this.Div_gen.style.position="relative";this.Div_gen.style.width="auto";this.Div_gen.style.height=this.height+"px";this.Div_gen.owner=this;var content=this.createContent();if (null !=content) this.Div_gen.appendChild(content);this.Div_gen.onclick=function (e){if (oThis.isDblEvent("onclick")) return;document.onclick();e=EventUtil.getEvent();e.triggerItem=oThis;if (oThis.isMenuBarItem==true&&oThis.parentOwner.componentType=="MENUBAR"&&oThis.childMenu !=null){if (oThis.parentOwner.nowActiveMenu !=null){MenuItemComp.hideChildMenus(oThis.parentOwner.nowActiveMenu);oThis.parentOwner.nowActiveMenu.hide();}oThis.showChildMenu(e);}if (oThis.childMenu !=null&&oThis.childMenu !=""){stopAll(e);e.triggerItem=null;clearEventSimply(e);return;}e.triggerObj=oThis.parentOwner.triggerObj;if (oThis.onclick(e) !=false) oThis.parentOwner.click(e);stopAll(e);e.triggerItem=null;e.triggerObj=null;clearEventSimply(e);};this.Div_gen.oncontextmenu=function(e){e=EventUtil.getEvent();oThis.onBeforeShowMenu(e);oThis.oncontextmenu(e);clearEventSimply(e);};this.ctxChanged=false;};MenuItemComp.prototype.createContent=function(){var oThis=this;if (this.isMenuBarItem==false){this.leftDiv=$ce("DIV");this.Div_gen.appendChild(this.leftDiv);this.leftDiv.className="contextmenu_item_left_div_off";if (this.isCheckBoxItem){this.checkbox=$ce("INPUT");this.checkbox.type="checkbox";this.checkbox.className="checkbox_box";this.leftDiv.appendChild(this.checkbox);if (this.isCheckBoxSelected){this.checkbox.defaultChecked=true;this.checkbox.checked=true;}else{this.checkbox.defaultChecked=false;this.checkbox.checked=false;}this.checkbox.onclick=function(e){e=EventUtil.getEvent();stopEvent(e);clearEventSimply(e);}}}if (this.refImg){if (isNull(this.caption) || this.showModel !=MenuItemComp.SHOW_TEXT){if (this.isMenuBarItem==false){this.changeImg(this.refImg);}}}this.divCaption=$ce("DIV");this.Div_gen.appendChild(this.divCaption);this.divCaption.className="contextmenu_item_caption_off";this.divCaption.style.lineHeight=MenuItemComp.ITEM_HEIGHT+"px";this.divLeft=$ce("DIV");this.divCenter=$ce("DIV");this.divRight=$ce("DIV");this.divLeft.className="divLeft_off";this.divCenter.className=this.divCenterOffClassName;this.divRight.className="divRight_off";this.divCaption.appendChild(this.divLeft);if(this.className=='white_menu_div'){this.divCenter.style.paddingLeft=(20-3)+"px";}this.divCaption.appendChild(this.divCenter);this.divCaption.appendChild(this.divRight);this.captionImgDiv=$ce("DIV");this.captionImgDiv.className="captionTextDiv";if(this.divCenter&&this.divCenter !='undefined'){this.divCenter.appendChild(this.captionImgDiv);}else{this.divCaption.appendChild(this.captionImgDiv);}if (this.refImg&&this.isMenuBarItem !=false&&(isNull(this.caption) || this.showModel !=MenuItemComp.SHOW_TEXT)){if (this.refImg){this.divCaption.style.paddingTop="0px";this.changeImg(this.refImg);}this.captionTextDiv=$ce("DIV");this.captionTextDiv.className="captionTextDiv";this.changeCaption(this.caption);if(this.divCenter&&this.divCenter !='undefined'){this.divCenter.appendChild(this.captionTextDiv);}else{this.divCaption.appendChild(this.captionTextDiv);}}else if (this.isMenuBarItem !=false){if(this.divCenter&&this.divCenter !='undefined'){if(this.divCenter.children&&this.divCenter.children.length>0){this.divCenter.children[0].innerHTML=this.caption;}else{var captionDiv=$ce("DIV");captionDiv.className="captionTextDiv";captionDiv.innerHTML=this.caption;this.divCenter.appendChild(captionDiv);}}else{this.divCaption.innerHTML=this.caption;}}else if (!IS_IE){if(this.divCenter&&this.divCenter !='undefined'){if(this.divCenter.children&&this.divCenter.children.length>0){this.divCenter.children[0].innerHTML="&nbsp;"+this.caption;}else{var captionDiv=$ce("DIV");captionDiv.className="captionTextDiv";captionDiv.innerHTML="&nbsp;"+this.caption;this.divCenter.appendChild(captionDiv);}}else{this.divCaption.innerHTML="&nbsp;"+this.caption;}}else{if(this.divCenter&&this.divCenter !='undefined'){if(this.divCenter.children&&this.divCenter.children.length>0){this.divCenter.children[0].innerHTML="&nbsp;&nbsp;&nbsp;"+this.caption;}else{var captionDiv=$ce("DIV");captionDiv.className="captionTextDiv";captionDiv.innerHTML="&nbsp;&nbsp;&nbsp;"+this.caption;this.divCenter.appendChild(captionDiv);}}else{this.divCaption.innerHTML="&nbsp;&nbsp;&nbsp;"+this.caption;}}this.divCaption.title=this.tip;if (this.childMenu !=null&&this.childMenu !=""){this.createRightDiv();}this.Div_gen.onmouseover=function(e){if(!IS_IPAD){if(oThis.divCenter&&oThis.divCenter !='undefined'){oThis.divCenter.className=oThis.divCenterOnClassName;}oThis.divCaption.className="contextmenu_item_caption_on";var hasLeft=false;var hasRight=false;if(oThis.divLeft&&oThis.divLeft !='undefined'){oThis.divLeft.className='divLeft_on';hasLeft=true;}if(oThis.divRight&&oThis.divRight !='undefined'){oThis.divRight.className='divRight_on';hasRight=true;}if(oThis.rightImg){if(oThis.isMenuBarItem==true){oThis.rightImg.src=MenuItemComp.rightImgDownSelectedPath;}else{oThis.rightImg.src=MenuItemComp.refImgRightSelectedPath;}}if(hasLeft&&hasRight){}else if(hasLeft){oThis.sep.className='menuitem_seperator_right_on';}else if(hasRight){if(oThis.preMenuItem !=null&&oThis.preMenuItem.sep !=null) oThis.preMenuItem.sep.className='menuitem_seperator_left_on';}else{if(oThis.preMenuItem !=null&&oThis.preMenuItem.sep !=null){oThis.preMenuItem.sep.className='menuitem_seperator_left_on';}oThis.sep.className='menuitem_seperator_right_on';}if (oThis.isMenuBarItem==false) oThis.leftDiv.className="contextmenu_item_left_div_on";}e=EventUtil.getEvent();e.triggerItem=oThis;var parentOwner=oThis.parentOwner;e.triggerObj=parentOwner.triggerObj;oThis.onmouseover(e);if (oThis.isMenuBarItem==true&&oThis.parentOwner.componentType=="MENUBAR"){e.triggerItem=null;e.triggerObj=null;clearEventSimply(e);return;}if (parentOwner.nowActiveMenu !=null){MenuItemComp.hideChildMenus(parentOwner.nowActiveMenu);}if (oThis.childMenu !=null&&oThis.childMenu !=""){oThis.showChildMenu(e);}if (parentOwner.mouseover !=null) parentOwner.mouseover(e);stopEvent(e);e.triggerItem=null;e.triggerObj=null;clearEventSimply(e);};this.Div_gen.onmouseout=function (e){e=EventUtil.getEvent();e.triggerItem=oThis;if (oThis.parentOwner) e.triggerObj=oThis.parentOwner.triggerObj;oThis.onmouseoutChangeClass();if (oThis.parentOwner&&oThis.parentOwner.mouseout !=null) oThis.parentOwner.mouseout(e);stopEvent(e);e.triggerItem=null;e.triggerObj=null;clearEventSimply(e);};};MenuItemComp.prototype.onmouseoutChangeClass=function(){oThis=this;oThis.divCaption.className="contextmenu_item_caption_off";var hasLeft=false;var hasRight=false;if(oThis.divLeft&&oThis.divLeft !='undefined'){oThis.divLeft.className='divLeft_off';hasLeft=true;}if(oThis.divCenter&&oThis.divCenter !='undefined'){oThis.divCenter.className=oThis.divCenterOffClassName;}if(oThis.divRight&&oThis.divRight !='undefined'){oThis.divRight.className='divRight_off';hasRight=true;}if(oThis.rightImg){if(oThis.isMenuBarItem==true){oThis.rightImg.src=MenuItemComp.rightImgDownPath;}else{oThis.rightImg.src=MenuItemComp.refImgRightPath;}}if(hasLeft&&hasRight){}else if(hasLeft){oThis.sep.className='menuitem_seperator';}else if(hasRight){if(oThis.preMenuItem !=null&&oThis.preMenuItem.sep !=null){oThis.preMenuItem.sep.className='menuitem_seperator';}}else{if(oThis.preMenuItem !=null&&oThis.preMenuItem.sep !=null){oThis.preMenuItem.sep.className='menuitem_seperator';}oThis.sep.className='menuitem_seperator';}if (oThis.isMenuBarItem==false) oThis.leftDiv.className="contextmenu_item_left_div_off";if (oThis.childMenu !=null&&oThis.childMenu !=""){oThis.rightDiv.className="right_div";if (!oThis.isMenuBarItem){this.Div_gen.style.backgroundColor="#fff";}}if (oThis.isMenuBarItem) this.Div_gen.style.backgroundColor="transparent";};MenuItemComp.prototype.destroySelf=function(){if (this.childMenu){try{this.childMenu.destroySelf();}catch(e){}}this.destroy();};MenuItemComp.prototype.showChildMenu=function(e){this.rightDiv.className="right_div_on";if (!this.isMenuBarItem){this.Div_gen.style.backgroundColor="#e5ebcc";}this.parentOwner.nowActiveMenu=this.childMenu;if (this.isMenuBarItem==true&&this.parentOwner.componentType=="MENUBAR"){this.childMenu.setPosLeft(compOffsetLeft(this.Div_gen,document.body));this.childMenu.setPosTop(compOffsetTop(this.Div_gen,document.body)+this.Div_gen.offsetHeight+1);}else{this.childMenu.setPosLeft(compOffsetLeft(this.parentOwner.Div_gen,document.body)+this.parentOwner.Div_gen.offsetWidth-1);this.childMenu.setPosTop(compOffsetTop(this.Div_gen,document.body));}this.childMenu.show(e);};MenuItemComp.hideChildMenus=function(menu){if (menu.nowActiveMenu !=null){MenuItemComp.hideChildMenus(menu.nowActiveMenu);menu.nowActiveMenu=null;}menu.hide();};MenuItemComp.prototype.setSelectedItem=function(menuItem){if (menuItem==null) return;if (this.isMenuBarItem&&this.isCheckBoxGroup){var items=this.parentOwner.childMenu.childItems;if (items !=null&&items.length>0){for (var i=0,count=items.length;i<count;i++){if (items[i].name==menuItem.name) items[i].checkbox.checked=true;else items[i].checkbox.checked=false;}}this.selectedItem=menuItem;}};MenuItemComp.prototype.getItemWidth=function(){var textWidth=getTextWidth(this.caption,"contextmenu_item_caption_on")+10;var padding=getStyleAttribute(this.divCaption,"paddingRight");if (padding==null || padding=="") padding=0;else padding=parseInt(padding,10);if(this.isMenuBarItem==true){if (this.childMenu) return textWidth+2*padding+MenuItemComp.IMAGE_WIDTH;else return textWidth+2*padding+MenuItemComp.IMAGE_WIDTH;}else if (this.isMenuBarItem==false){if (this.childMenu) return textWidth+2*padding+2*MenuItemComp.IMAGE_WIDTH;else return textWidth+2*padding+MenuItemComp.IMAGE_WIDTH;}};MenuItemComp.prototype.setItemWidth=function(eleWidth){var width=""+eleWidth;if (width.indexOf("%") !=-1){width=this.Div_gen.offsetWidth;}else if (width==0){width=this.Div_gen.offsetWidth;}this.width=width;if (this.isMenuBarItem==true){if (width==0&&!this.leftDiv) this.Div_gen.style.width="auto";else this.Div_gen.style.width=(width)+"px";}else this.Div_gen.style.width=(width-2)+"px";if (this.isMenuBarItem==true){if (this.leftDiv) this.divCaption.style.width=width-MenuItemComp.IMAGE_WIDTH-2+"px";}else{if (this.childMenu){this.divCaption.style.width=width-MenuItemComp.IMAGE_WIDTH-10+"px";}else this.divCaption.style.width=width-MenuItemComp.IMAGE_WIDTH-2+"px";}};MenuItemComp.prototype.setChildMenu=function(childMenu){if(isNull(childMenu,false)){throw Error("can't add an empty menu to item "+this.name);return;}if (isNotNull(this.childMenu,false)){this.childMenu=childMenu;childMenu.parentMenu=this.parentOwner;}else{this.createRightDiv();this.childMenu=childMenu;childMenu.parentMenu=this.parentOwner;if (this.width !=null&&this.width !="100%") this.setItemWidth(this.width);}};MenuItemComp.prototype.getMenu=function(id){if(this.childMenu !=null) return this.childMenu.getMenu(id);};MenuItemComp.prototype.addMenu=function(itemName,itemCapiton,itemTip,itemRefImg,isCheckBoxItem,isCheckBoxSelected,attrObj){if (this.childMenu==null || this.childMenu==""){var div=this.doCreateContainer();var cMenu;if (div==null){cMenu=new ContextMenuComp("","","",true);}else{cMenu=div;div.style.position="absolute";div.style.display="none";div.style.border="1px solid blue";div.menus=[];div.addMenu=function(itemName,itemCapiton,itemTip,itemRefImg,isCheckBoxItem,isCheckBoxSelected,attrObj){if(this.getItemContainer==null){alert("must implement getItemContainer");return;}var itemContainer=this.getItemContainer();var item=null;if(this.createItem !=null){MenuItemComp.SUSPEND_CREATE=true;item=new MenuItemComp(itemContainer,itemName,itemCapiton,itemTip,itemRefImg,"menuitem_div",false,null,isCheckBoxItem,isCheckBoxSelected,attrObj);MenuItemComp.SUSPEND_CREATE=false;this.createItem(item);item.create();}else item=new MenuItemComp(itemContainer,itemName,itemCapiton,itemTip,itemRefImg,"menuitem_div",false,null,isCheckBoxItem,isCheckBoxSelected,attrObj);div.menus.push(item);item.parentOwner=this;return item;};div.getMenu=function(id){for (var i=0,n=this.menus.length;i<n;i++){if (this.menus[i].id==id){return this.menus[i];}}};div.setPosLeft=function(left){this.style.left=(left-3)+"px";};div.setPosTop=function(top){this.style.top=(top-5)+"px";};div.show=function(){this.style.display="";};div.hide=function(){this.style.display="none";};div.click=function(e){this.hide();};window.clickHolders.push(div);div.outsideClick=function(e){if (e !=null&&2==e.button) return;this.hide();};document.body.appendChild(div);}cMenu.menubar=this.menubar;cMenu.triggerObj=this;this.setChildMenu(cMenu);}var item=this.childMenu.addMenu(itemName,itemCapiton,itemTip,itemRefImg,isCheckBoxItem,isCheckBoxSelected,attrObj);return item;};MenuItemComp.prototype.addSep=function(attrObj){var sep=this.childMenu.addSep(attrObj);return sep;};MenuItemComp.prototype.doCreateContainer=function(){return this.onContainerCreate();};MenuItemComp.prototype.onContainerCreate=function(){var simpleEvent={"obj":this};var result=this.doEventFunc("onContainerCreate",simpleEvent);return result;};MenuItemComp.prototype.createRightDiv=function(){if (this.rightDiv) return;this.rightDiv=$ce("DIV");this.rightDiv.className="right_div";if(this.divCenter&&this.divCenter !='undefined'){this.divCenter.appendChild(this.rightDiv);}else{this.Div_gen.appendChild(this.rightDiv);}this.rightImg=$ce("IMG");if(this.isMenuBarItem==true){this.rightImg.style.width="11px";this.rightImg.style.height="8px";this.rightImg.style.verticalAlign="middle";this.rightImg.src=MenuItemComp.rightImgDownPath;if (IS_IE7){this.rightDiv.style.marginTop=(MenuItemComp.ITEM_HEIGHT-8)/2+"px";}}else{this.rightImg.style.width="11px";this.rightImg.style.height="8px";this.rightImg.style.verticalAlign="middle";this.rightImg.style.position="relative";this.rightImg.src=MenuItemComp.refImgRightPath;}this.rightDiv.appendChild(this.rightImg);var removeWidth=this.oriWidth;this.oriWidth=this.Div_gen.offsetWidth;if(this.menuParent){this.menuParent.resetMenuItemsWidth(this,removeWidth);}};MenuItemComp.prototype.removeChildMenu=function(){if (isNull(this.childMenu,false)){log("the item"+this.name+"'s child menu is already null");return;}this.childMenu=null;this.imgWidth-=MenuItemComp.IMAGE_WIDTH;try{this.Div_gen.removeChild(this.rightImg);}catch(e){}this.Div_gen.style.width=this.getItemWidth()+"px";};MenuItemComp.prototype.setActive=function(isActive){var isActive=getBoolean(isActive,false);if (this.disabled==false&&isActive==false){this.mouseoutFunc=this.Div_gen.onmouseout;this.mouseoverFunc=this.Div_gen.onmouseover;this.clickFunc=this.Div_gen.onclick;this.divCaption.className="contextmenu_item_caption_banned";this.onmouseoutChangeClass();if(document.all){if(this.divCenter&&this.divCenter.children.length>0){for(var i=0;i<this.divCenter.children.length;i++){this.divCenter.children[i].style.color="#CCCCCC";}}else{this.divCaption.style.color="#CCCCCC";if(this.sep){this.sep.style.color="#CCCCCC";}}}else{if(this.divCenter&&this.divCenter.children.length>0){for(var i=0;i<this.divCenter.children.length;i++){this.divCenter.children[i].style.opacity=0.4;}}else{this.Div_gen.style.opacity=0.4;}}this.Div_gen.onmouseout=function(){};this.Div_gen.onmouseover=function(){};this.Div_gen.onclick=function(){};this.disabled=true;if (this.refImg&&this.isMenuBarItem !=false&&(isNull(this.caption) || this.showModel !=MenuItemComp.SHOW_TEXT)){if (this.refImgDisable !=null&&this.refImgDisable !=""){if(this.divCenter&&this.divCenter !='undefined'){if(this.divCenter.firstChild&&this.divCenter.firstChild.firstChild&&this.divCenter.firstChild.firstChild.src) this.divCenter.firstChild.firstChild.src=this.refImgDisable;}else{if(this.divCenter.firstChild&&this.divCenter.firstChild.firstChild&&this.divCenter.firstChild.firstChild.src) this.divCaption.firstChild.firstChild.src=this.refImgDisable;}}}}else if (this.disabled==true&&isActive==true){this.Div_gen.onmouseout=this.mouseoutFunc;this.Div_gen.onmouseover=this.mouseoverFunc;this.Div_gen.onclick=this.clickFunc;this.divCaption.className="contextmenu_item_caption_off";this.onmouseoutChangeClass();if(document.all){if(this.divCenter&&this.divCenter.children.length>0){for(var i=0;i<this.divCenter.children.length;i++){this.divCenter.children[i].style.color="";}}else{this.divCaption.style.color="";if(this.sep){this.sep.style.color="";}}}else{if(this.divCenter&&this.divCenter.children.length>0){for(var i=0;i<this.divCenter.children.length;i++){this.divCenter.children[i].style.opacity=1;}}else{this.Div_gen.style.opacity=1;}}this.disabled=false;if (this.refImg&&this.isMenuBarItem !=false){if(this.divCenter&&this.divCenter !='undefined'){if(this.divCenter.firstChild&&this.divCenter.firstChild.firstChild&&this.divCenter.firstChild.firstChild.src) this.divCenter.firstChild.firstChild.src=this.refImg;}else{if(this.divCenter.firstChild&&this.divCenter.firstChild.firstChild&&this.divCenter.firstChild.firstChild.src) this.divCaption.firstChild.firstChild.src=this.refImg;}}}this.ctxChanged=true;this.notifyChange(NotifyType.ENABLE,!this.disabled);};MenuItemComp.prototype.hide=function(){this.Div_gen.style.display="none";if (this.sep) this.sep.style.display="none";this.visible=false;if (this.divLeft.style.display=="block"|| this.divLeft.style.display==""){this.showNextItemLeftDiv();}if (this.divRight.style.display=="block"|| this.divRight.style.display==""){this.showPreItemRigetDiv();}var allHide=true;var preMenuItem=this.preMenuItem;while (preMenuItem !=null){if (preMenuItem.visible==true){allHide=false;break;}preMenuItem=preMenuItem.preMenuItem;}if(this.menuParent&&preMenuItem&&preMenuItem.Div_gen.style.display !="none"){this.menuParent.lastShowItem=preMenuItem;}if (allHide==true){var nextMenuItem=this.nextMenuItem;while (nextMenuItem !=null){if (nextMenuItem.visible==true){allHide=false;break;}nextMenuItem=nextMenuItem.nextMenuItem;}}if (allHide==true){var lastMenuItem=this.getLastMenuItem();if (lastMenuItem.sepDiv) lastMenuItem.sepDiv.style.display="none";}this.ctxChanged=true;if (this.parentOwner&&this.parentOwner.resetMenuItemsWidth) this.parentOwner.resetMenuItemsWidth();};MenuItemComp.prototype.show=function(){if (this.visible==true) return;this.Div_gen.style.display="block";if (this.sep) this.sep.style.display="block";this.visible=true;if (this.hidePreItemRigetDiv()) this.divLeft.style.display="none";if (this.hideNextItemLeftDiv()){if (this.sep) this.sep.style.display="block";this.divRight.style.display="none";this.divCenter.style.paddingRight="20px";}else{if (this.sep) this.sep.style.display="none";}var lastMenuItem=this.getLastMenuItem();if (lastMenuItem.sepDiv) lastMenuItem.sepDiv.style.display="block";this.ctxChanged=true;this.parentOwner.resetMenuItemsWidth();};MenuItemComp.prototype.getLastMenuItem=function(){var menuItem=this;while (menuItem.nextMenuItem !=null){menuItem=menuItem.nextMenuItem;}return menuItem;};MenuItemComp.prototype.showNextItemLeftDiv=function(){if (this.nextMenuItem==null) return;if (this.nextMenuItem.visible==false) this.nextMenuItem.showNextItemLeftDiv();this.nextMenuItem.divLeft.style.display="block";this.nextMenuItem.divCenter.style.paddingLeft="14px";if(this.className=='white_menu_div'){this.nextMenuItem.divCenter.style.paddingLeft="17px";}};MenuItemComp.prototype.hideNextItemLeftDiv=function(){if (this.nextMenuItem==null) return false;if (this.nextMenuItem.visible==false) return this.nextMenuItem.hideNextItemLeftDiv();this.nextMenuItem.divLeft.style.display="none";this.nextMenuItem.divCenter.style.paddingLeft="20px";return true;};MenuItemComp.prototype.showPreItemRigetDiv=function(){if (this.preMenuItem==null) return;if (this.preMenuItem.visible==false) this.preMenuItem.showPreItemRigetDiv();if (this.preMenuItem.sep) this.preMenuItem.sep.style.display="none";this.preMenuItem.divRight.style.display="block";this.preMenuItem.divCenter.style.paddingRight="14px";if(this.className=='white_menu_div'){this.preMenuItem.divCenter.style.paddingLeft="17px";}};MenuItemComp.prototype.hidePreItemRigetDiv=function(){if (this.preMenuItem==null) return false;if (this.preMenuItem.visible==false) return this.preMenuItem.hidePreItemRigetDiv();if (this.preMenuItem.sep) this.preMenuItem.sep.style.display="block";this.preMenuItem.divRight.style.display="none";this.preMenuItem.divCenter.style.paddingRight="20px";return true;};MenuItemComp.prototype.hidePreMenuItemRight=function(){};MenuItemComp.prototype.isActive=function(){return !this.disabled;};MenuItemComp.prototype.changeCaption=function(caption){if (this.showModel==MenuItemComp.SHOW_IMG&&this.refImg) return;caption=getString(caption,"");if (this.caption !=caption){this.caption=caption;}if (this.isMenuBarItem==false){if(this.divCenter&&this.divCenter !='undefined'){if(this.divCenter.children&&this.divCenter.children.length>0){this.divCenter.children[0].innerHTML=this.caption;}else{var captionDiv=$ce("DIV");captionDiv.className="captionTextDiv";captionDiv.innerHTML=this.caption;this.divCenter.appendChild(captionDiv);}}else{this.divCaption.innerHTML=this.caption;}}else{if (MenuItemComp.SHOW_ALL==this.showModel&&this.refImg){if (this.caption==null || this.caption==""){this.captionImgDiv.innerHTML="";}else if (!IS_IE) this.captionImgDiv.innerHTML="&nbsp;"+this.caption;else this.captionImgDiv.innerHTML="&nbsp;&nbsp;&nbsp;"+this.caption;}else{if(this.divCenter&&this.divCenter !='undefined'){if(this.divCenter.children&&this.divCenter.children.length>0){this.divCenter.children[0].innerHTML=this.caption;}else{var captionDiv=$ce("DIV");captionDiv.className="captionTextDiv";captionDiv.innerHTML=this.caption;this.divCenter.appendChild(captionDiv);}}else{this.divCaption.innerHTML=this.caption;}}}this.ctxChanged=true;this.notifyChange(NotifyType.TEXT,this.caption);};MenuItemComp.prototype.changeImg=function(refImg){if (this.refImg !=refImg){this.refImg=refImg;}if (this.leftImg !=null){this.leftImg.src=this.refImg;}else{this.leftImg=$ce("IMG");this.leftImg.src=this.refImg;if (this.isMenuBarItem==false){this.leftImg.width=MenuItemComp.IMAGE_WIDTH-4;this.leftImg.height=MenuItemComp.IMAGE_WIDTH-4;this.leftImg.style.left="2px";this.leftImg.style.verticalAlign="middle";this.leftDiv.appendChild(this.leftImg);}else{this.leftImg.style.height="16px";this.leftImg.style.width="16px";this.leftImg.height="16px";this.leftImg.width="16px";this.leftImg.style.verticalAlign="middle";if(IS_IE7){this.leftImg.style.marginTop=(MenuItemComp.ITEM_HEIGHT-16)/2+"px";}this.captionImgDiv.appendChild(this.leftImg);}}this.ctxChanged=true;this.notifyChange(NotifyType.CHANGEIMG,this.refImg);};MenuItemComp.prototype.getObjHtml=function(){return this.Div_gen;};MenuItemComp.prototype.onclick=function(e){var mouseEvent={"obj":this,"event":e};return this.doEventFunc("onclick",mouseEvent);};MenuItemComp.prototype.onmouseover=function(e){var mouseEvent={"obj":this,"event":e};this.doEventFunc("onmouseover",mouseEvent);};MenuItemComp.prototype.handleHotKey=function(key){if (this.isActive()==false) return null;if (this.hotKey !=null){if (key==this.hotKey&&this.onclick){this.onclick(null);return this;}}if (this.childMenu){var childItems=this.childMenu.childItems;if (childItems !=null&&childItems.length>0){for (var i=0,n=childItems.length;i<n;i++){var obj=childItems[i].handleHotKey(key);if (obj !=null) return obj;}}}return null;};ContextMenuComp.prototype.getChangedContext=function(){if (this.changedObj==null){this.changedObj=new Object;this.changedObj.id=this.id;}if (this.triggerObj !=null) this.changedObj.triggerId=this.triggerObj.id;for (var i=0,n=this.childItems.length;i<n;i++){var ctx=this.childItems[i].getChangedContext();if (ctx==null) continue;hasChanged=true;if (this.changedObj["items"]==null) this.changedObj["items"]=new Array();this.changedObj["items"].push(ctx);}return this.changedObj;};ContextMenuComp.prototype.clearChange=function(){for (var i=0,n=this.childItems.length;i<n;i++){this.childItems[i].clearChange();}};MenuItemComp.prototype.getChangedContext=function(){if (this.childMenu){var childItems=this.childMenu.childItems;if (childItems !=null&&childItems.length>0){for (var i=0,n=childItems.length;i<n;i++){var ctx=childItems[i].getChangedContext();if (ctx==null) continue;if (this.changedObj==null){this.changedObj=new Object;this.changedObj.id=this.id;}if (this.changedObj["childs"]==null) this.changedObj["childs"]=new Array();this.changedObj["childs"].push(ctx);}}}return this.changedObj;};MenuItemComp.prototype.setChangedContext=function(context){if (context.imgIcon !=null&&""!=context.imgIcon&&context.imgIcon !=this.refImg) this.changeImg(context.imgIcon);if (context.text !=null&&context.text !=this.caption) this.changeCaption(context.text);if (context.enable !=null&&context.enable==this.disabled) this.setActive(context.enable);if(context.tip !=null) this.divCaption.title=context.tip;if (context.visible !=null&&context.visible !=this.visible){if (context.visible==false) this.hide();else this.show();}if (context.childItemContexts){for (var i=0,n=context.childItemContexts.length;i<n;i++){for (var j=0,m=this.childMenu.childItems.length;j<m;j++){if (this.childMenu.childItems[j].id==context.childItemContexts[i].id){this.childMenu.childItems[j].setChangedContext(context.childItemContexts[i]);break;}}}}};function MenuSepComp(parent,id,className,attrObj){this.base=BaseComponent;this.base(id);var oThis=this;if (attrObj){}this.name=id;this.id=id;this.disabled=false;this.visible=true;this.className=getString(className,"contextmenu_item_div");this.height=getCssHeight(this.className+"_SEP_HEIGHT");this.parentHTML=parent;this.create();};MenuSepComp.prototype.create=function(){var oThis=this;this.Div_gen=$ce("DIV");this.parentHTML.appendChild(this.Div_gen);this.Div_gen.className=this.className;this.Div_gen.style.overflow="hidden";this.Div_gen.style.position="relative";this.Div_gen.style.width="auto";this.Div_gen.style.height=this.height+"px";this.Div_gen.owner=this;var content=this.createContent();if (null !=content) this.Div_gen.appendChild(content);};MenuSepComp.prototype.createContent=function(){var oThis=this;this.leftDiv=$ce("DIV");this.Div_gen.appendChild(this.leftDiv);this.leftDiv.className="contextmenu_item_left_div_off";this.divCaption=$ce("DIV");this.Div_gen.appendChild(this.divCaption);this.divCaption.className="contextmenu_sep_caption";};MenuSepComp.prototype.setItemWidth=function(eleWidth){var width=new String(eleWidth);if (width.indexOf("%") !=-1) width=this.Div_gen.offsetWidth;this.width=width-1;this.Div_gen.style.width=(width-2)+"px";this.divCaption.style.width=width-MenuItemComp.IMAGE_WIDTH-2+"px";};MenuSepComp.prototype.getItemWidth=function(){var textWidth=0;var padding=getStyleAttribute(this.divCaption,"paddingRight");if (padding==null || padding=="") padding=0;else padding=parseInt(padding,10);return textWidth+2*padding+MenuItemComp.IMAGE_WIDTH;};

